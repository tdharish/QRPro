<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultimate QR Designer - Enhanced</title>
<!-- Google AdSense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXX"
     crossorigin="anonymous"></script>

<meta name="viewport" content="width=device-width, initial-scale=0.7">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
--bg-1: #f8f9fc; --bg-2: white; --txt-1: #111; --txt-2: #333; --txt-3: #666;
--border: #ddd; --accent: #0068ff; --accent-h: #0055dd; --shadow: 0 8px 30px rgba(0,0,0,0.09);
}
[data-theme="dark"] {
--bg-1: #1a1a1a; --bg-2: #2d2d2d; --txt-1: #e0e0e0; --txt-2: #d0d0d0; --txt-3: #999;
--border: #444; --accent: #4a9eff; --accent-h: #6db0ff; --shadow: 0 8px 30px rgba(0,0,0,0.5);


}
body { font-family: system-ui, sans-serif; background: var(--bg-1); color: var(--txt-1); margin:0; padding:20px 10px; transition: all 0.3s; }
.container { max-width: 1100px; margin: 0 auto; display: grid; grid-template-columns: 1fr 420px; gap: 25px; padding-top: 10px; }
/* Ad containers */
.ad-sidebar {
  position: fixed;
  width: 160px;
  height: 600px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 50;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: var(--shadow);
}

.ad-sidebar.left {
  left: 10px;
}

.ad-sidebar.right {
  right: 10px;
}

/* Hide ads on smaller screens */
@media (max-width: 1440px) {
  .ad-sidebar {
    display: none;
  }
}

/* Page overlay ad */
.page-overlay-ad {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
}

.overlay-ad-content {
  position: relative;
  background: var(--bg-2);
  padding: 20px;
  border-radius: 12px;
  max-width: 90%;
  max-height: 90%;
}

.overlay-close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  background: #ff4444;
  color: white;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: not-allowed;
  font-size: 20px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.overlay-close-btn.enabled {
  cursor: pointer;
  background: #4CAF50;
}

.overlay-close-btn.enabled:hover {
  background: #45a049;
  transform: scale(1.1);
}

.overlay-timer {
  position: absolute;
  top: 15px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent);
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: bold;
}

@media (max-width: 1000px) { 
  .container { grid-template-columns: 1fr; }
  .right-panel { 
    order: -1; 
    position: sticky; 
    top: 0; 
    z-index: 100; 
    background: var(--bg-2); 
    padding-bottom: 15px; 
    border-bottom: 1px solid var(--border);
  }
 }
.panel { background: var(--bg-2); border-radius: 18px; padding: 26px; box-shadow: var(--shadow); height: fit-content; transition: all 0.3s; }
.right-panel { position: sticky; top: 20px; align-self: start; }
.header { text-align:center; grid-column: 1/-1; margin:0 0 20px; display: flex; justify-content: space-between; align-items: center; }
h1 { color: var(--txt-1); font-size:2em; margin: 0; flex: 1; }
.theme-toggle { background: var(--bg-2); border: 2px solid var(--border); border-radius: 25px; padding: 8px 16px; cursor: pointer; font-size: 20px; transition: all 0.3s; }
.theme-toggle:hover { transform: scale(1.1); }
label { display:block; margin:16px 0 7px; font-weight:600; color: var(--txt-2); }
input, select, textarea, button { width:100%; padding:12px; margin-bottom:14px; border:1px solid var(--border); border-radius:12px; font-size:16px; box-sizing:border-box; background: var(--bg-2); color: var(--txt-1); transition: all 0.3s; }
textarea { height:100px; resize:vertical; }
.color-row { display:flex; gap:12px; align-items:center; }
.color-row input[type="color"] { width:70px; height:48px; padding:4px; cursor:pointer; border-radius:10px; }
.color-row input[type="text"] { flex:1; }
button { background: var(--accent); color:white; font-weight:bold; border:none; cursor:pointer; padding:14px; border-radius:12px; font-size:17px; }
button:hover { background: var(--accent-h); }
.btn-small { padding: 8px 16px; font-size: 14px; margin: 4px; }
.preset-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 14px; }
.template-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 6px;
    margin-bottom: 14px;
}
.preset-btn, .template-btn { padding: 8px 4px; font-size: 11px; border: 2px solid var(--border); background: var(--bg-2); color: var(--txt-1); cursor: pointer; border-radius: 8px; transition: all 0.2s; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
@media (max-width: 600px) {
    .template-grid {
        grid-template-columns: repeat(5, 1fr); gap: 3px; }
  .template-btn { font-size: 12px; padding: 5px 2px; width: auto; min-width: 0; }
  .tab-btn { font-size: 16px; padding: 12px 8px; }
  #preview-container { width: 100px; height: 100px; margin: 0 auto 10px; padding: 5px; }
  #qr-output { width: 90px; height: 90px; }
 }
.preset-btn:hover, .template-btn:hover { border-color: var(--accent); background: var(--accent); color: white; }
.preset-btn.active, .template-btn.active { border-color: var(--accent); background: var(--accent); color: white; }
#preview-container { width:350px; height:350px; margin:0 auto 20px; background: var(--bg-2); border-radius:16px; padding:15px; box-shadow:0 4px 20px rgba(0,0,0,0.1); overflow:hidden; display:flex; align-items:center; justify-content:center; }
#qr-output { width:320px; height:320px; }
.actions { display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; }
@media (max-width: 500px) { }
.live-value { text-align:center; margin:-10px 0 14px; font-weight:bold; color: var(--accent); font-size:15px; }
.saved-schemes { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 14px; }
.scheme-chip { padding: 6px 12px; background: var(--bg-1); border: 1px solid var(--border); border-radius: 20px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 6px; }
.scheme-chip:hover { background: var(--accent); color: white; }
.scheme-chip .delete { margin-left: 4px; cursor: pointer; font-weight: bold; }
.collapsible { cursor: pointer; user-select: none; display: flex; justify-content: space-between; align-items: center; }
.collapsible::after { content: '‚ñº'; font-size: 12px; }
.collapsible.collapsed::after { content: '‚ñ∂'; }
.collapsible-content { max-height: 2000px; overflow: hidden; transition: max-height 0.3s ease; }
.collapsible-content.hidden { max-height: 0; }
small { color: var(--txt-3); font-size: 13px; }
.vcard-field { margin-bottom: 10px; }
.vcard-group { border: 1px solid var(--border); padding: 35px 10px 10px 10px; border-radius: 8px; margin-bottom: 10px; position: relative; }
.watermark-box {
    border: 1px solid var(--border);
    padding: 40px 10px 10px 10px;
    border-radius: 8px;
    margin-bottom: 10px;
    position: relative;
    background: var(--bg-1);
}

.watermark-box-header {
    position: sticky;
    top: 0;
    right: 0;
    display: flex;
    gap: 5px;
    justify-content: flex-end;
    padding: 5px;
    background: var(--bg-1);
    z-index: 10;
    margin: -35px -5px 10px -5px;
}

.watermark-box-header button {
    width: 32px;
    height: 32px;
    padding: 0;
    margin: 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.watermark-box-header .btn-remove {
    background: #ff4444;
    color: white;
}

.watermark-box-header .btn-hide {
    background: #ff9800;
    color: white;
}

.watermark-box-header .btn-collapse {
    background: #2196F3;
    color: white;
}

.watermark-box-content {
    max-height: 2000px;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.watermark-box-content.collapsed {
    max-height: 0;
}

.remove-btn { position: absolute; top: 5px; right: 5px; background: #ff4444; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; width: auto; }
.custom-label { margin-top: 5px; display: none; }
.add-btn { background: #4CAF50; margin-top: 5px; }
#vcardInputs input, #vcardInputs select { margin-bottom: 8px; }
.inline-group { display: flex; gap: 8px; }
.inline-group input { flex: 2; }
.inline-group select { flex: 1; }
.warning-box { text-align: center; margin: 10px 0; padding: 8px; border-radius: 8px; font-size: 14px; }
.warning-contrast { background: #fff3cd; color: #856404; border: 1px solid #ffc107; }
.warning-logo { background: #ffe5e5; color: #d32f2f; border: 1px solid #ff5252; }
.icon-browser { margin-bottom: 14px; }
.icon-controls { display: flex; gap: 8px; margin-bottom: 10px; }
.icon-controls input { flex: 1; margin: 0; }
.icon-controls select { flex: 0 0 140px; margin: 0; }
.icon-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 6px; max-height: 180px; overflow-y: auto; padding: 8px; background: var(--bg-1); border-radius: 8px; border: 1px solid var(--border); }
.icon-item { padding: 8px; font-size: 28px; text-align: center; cursor: pointer; border-radius: 6px; transition: all 0.2s; border: 2px solid transparent; }
.icon-item:hover { background: var(--accent); transform: scale(1.15); }
.icon-item.selected { border-color: var(--accent); background: var(--accent); }
.icon-count { text-align: center; font-size: 12px; color: var(--txt-3); margin-top: 5px; }
/* Removed old watermark list styles - replaced with watermark-box */

.watermark-preview-box {
  position: relative;
  width: 200px;
  height: 200px;
  border: 2px dashed var(--border);
  border-radius: 8px;
  margin: 10px auto;
  background: white;
  overflow: hidden;
  cursor: move;
}
.watermark-draggable {
  position: absolute;
  cursor: move;
  user-select: none;
  touch-action: none;
}
.watermark-type-select { margin-bottom: 15px; }

.tab-container {
  margin-bottom: 20px;
  position: relative;
}
.password-wrapper { position: relative; }
.password-wrapper input { width: 100%; padding-right: 40px; }
.toggle-password { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; color: var(--txt-2); font-size: 18px; z-index: 5; pointer-events: all; }
.toggle-password:hover { color: var(--txt-1); }

.tab-buttons {
  display: flex;
  gap: 5px;
  margin-bottom: 15px;
  flex-wrap: nowrap;
  position: sticky;
  top: 70px;
  z-index: 98;
}

@media max-width: 1000px and (orientation: portrait) {
  .tab-buttons {
    top: 520px;
  }
}
.tab-btn { flex: 1; min-width: 80px; padding: 10px 6px; font-size: 12px; background: var(--bg-1); color: var(--txt-2); border: 2px solid var(--border); border-radius: 8px 8px 0 0; cursor: pointer; font-weight: 600; transition: all 0.2s; }

.tab-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
.tab-btn:hover:not(.active) { background: var(--border); }
.tab-content { display: none; }
.tab-content.active { display: block; }
.fixed-bottom { position: sticky; bottom: 0; background: var(--bg-2); padding: 15px 0; margin: 20px -26px -26px; padding-left: 26px; padding-right: 26px; border-top: 2px solid var(--border); z-index: 10; }
.download-dropdown { width: 100%; }
.dropdown-menu a { display: block; padding: 12px 16px; color: var(--txt-1); text-decoration: none; font-size: 14px; white-space: nowrap; transition: background 0.2s; border-radius: 4px; margin: 2px 4px; }
.dropdown-menu a:hover { background-color: var(--accent); color: white; }
</style>

<script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.6.0-rc.1/lib/qr-code-styling.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Arial&family=Roboto&family=Open+Sans&family=Montserrat&family=Lato&family=Poppins&family=Raleway&family=Playfair+Display&family=Great+Vibes&family=Dancing+Script&family=Pacifico&family=Lobster&family=Bebas+Neue&family=Impact&family=Comic+Sans+MS&family=Verdana&family=Georgia&family=Courier+New&family=Times+New+Roman&family=Webdings&family=Wingdings&family=Wingdings+2&family=Wingdings+3&family=Zapf+Dingbats&display=swap" rel="stylesheet">
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme" style="position:fixed; top:20px; right:20px; z-index:1000; width:auto;">üåì</button>

<h1 style="text-align:center; margin:0 0 20px; position:sticky; top:0; background:var(--bg-1); padding:20px 0; z-index:100; box-shadow:0 2px 10px rgba(0,0,0,0.1);">üé® Ultimate QR Designer</h1>

<div class="container">
<div class="panel">
<div class="tab-container">
<div class="tab-buttons">
<button class="tab-btn active" onclick="switchTab('templates')" title="Alt+T"><u>T</u>emplates</button>
<button class="tab-btn" onclick="switchTab('foreground')" title="Alt+F"><u>F</u>oreground</button>
<button class="tab-btn" onclick="switchTab('background')" title="Alt+B"><u>B</u>ackground</button>
<button class="tab-btn" onclick="switchTab('frame')" title="Alt+R">F<u>r</u>ame</button>
<button class="tab-btn" onclick="switchTab('corners')" title="Alt+C"><u>C</u>orners</button>
<button class="tab-btn" onclick="switchTab('image')" title="Alt+I"><u>I</u>mage</button>
<button class="tab-btn" onclick="switchTab('watermark')" title="Alt+W"><u>W</u>atermark</button>
</div>

<!-- Templates Tab -->
<div id="tab-templates" class="tab-content active">
<label class="collapsible" onclick="toggleSection(this)">üìã QR Code Templates</label>

<div class="collapsible-content">
<div class="template-grid">
<button class="template-btn active" onclick="selectTemplate('url');return false;">üîó URL</button>
<button class="template-btn" onclick="selectTemplate('wifi');return false;">üì∂ WiFi</button>
<button class="template-btn" onclick="selectTemplate('vcard');return false;">üë§ vCard</button>
<button class="template-btn" onclick="selectTemplate('email');return false;">‚úâÔ∏è Email</button>
<button class="template-btn" onclick="selectTemplate('sms');return false;">üí¨ SMS</button>
<button class="template-btn" onclick="selectTemplate('phone');return false;">üìû Phone</button>
<button class="template-btn" onclick="selectTemplate('location');return false;">üìç Location</button>
<button class="template-btn" onclick="selectTemplate('event');return false;">üìÖ Event</button>
<button class="template-btn" onclick="selectTemplate('text');return false">üìù Text</button>
<button class="template-btn" onclick="selectTemplate('password');return false">üîê Password</button>
</div>

<!-- URL Template -->
<div id="urlInputs" style="display:block; margin-top:15px;">
<label style="margin:5px 0;">Enter URL</label>
<input type="url" id="urlInput" placeholder="https://example.com" value="https://example.com">
</div>


<!-- Text Template -->
<div id="textInputs" style="display:none; margin-top:15px;">
    <label style="margin:5px 0">Enter Text</label>
    <textarea id="textContent" placeholder="Enter your text here..." maxlength="500" rows="6" style="width:100%; padding:10px; border:1px solid var(--border); border-radius:8px; background:var(--bg-2); color:var(--txt-1); font-size:14px; resize:vertical;"></textarea>
    <div style="text-align:right; font-size:12px; color:var(--txt-3); margin-top:5px;">
        <span id="textCharCount">0/500</span> characters
    </div>
</div>

<!-- Password Template -->
<div id="passwordInputs" style="display:none; margin-top:15px;">
    <label style="margin:5px 0">Enter Password</label>
    <div class="password-wrapper">
        <input type="password" id="passwordField" placeholder="Enter password" style="width:100%; padding:10px; padding-right:40px; border:1px solid var(--border); border-radius:8px; background:var(--bg-2); color:var(--txt-1); font-size:14px;">
        <i class="fa-solid fa-eye toggle-password" id="passwordToggleIcon" onclick="togglePasswordField()" style="cursor:pointer;"></i>
    </div>
</div>

<!-- WiFi Template -->
<div id="wifiInputs" style="display:none; margin-top:15px;">
<label style="margin:5px 0;">Network Name (SSID) *</label>
<input type="text" id="wifiSSID" placeholder="My WiFi Network">
<label style="margin:5px 0;">Password</label>
<div class="password-wrapper">
<input type="password" id="wifiPassword" placeholder="Password (leave empty for open network)">
<i class="fa-solid fa-eye toggle-password" id="wifiToggleIcon" onclick="toggleWifiPassword()"></i>
</div>
<label style="margin:5px 0;">Security Type</label>
<select id="wifiSecurity">
<option value="WPA">WPA/WPA2</option>
<option value="WEP">WEP</option>
<option value="nopass">None (Open)</option>
</select>
</div>

<!-- vCard Template -->
<div id="vcardInputs" style="display:none; margin-top:15px;">
<div class="vcard-field">
<label style="margin:5px 0;">First Name *</label>
<input type="text" id="vcardFirstName" placeholder="John">
</div>
<div class="vcard-field">
<label style="margin:5px 0;">Middle Name</label>
<input type="text" id="vcardMiddleName" placeholder="Michael">
</div>
<div class="vcard-field">
<label style="margin:5px 0;">Last Name</label>
<input type="text" id="vcardLastName" placeholder="Doe">
</div>
<div class="vcard-field">
<label style="margin:5px 0;">Company</label>
<input type="text" id="vcardCompany" placeholder="Company Name">
</div>
<div class="vcard-field">
<label style="margin:5px 0;">Designation/Title</label>
<input type="text" id="vcardTitle" placeholder="Job Title">
</div>

<div class="vcard-field">
<label style="margin:5px 0;">Address</label>
<input type="text" id="vcardAddress" placeholder="Street, City, State, Country">
</div>

<label style="margin:10px 0 5px;">Phone Numbers</label>
<div id="vcardPhones"></div>
<button class="btn-small add-btn" onclick="addVcardPhone()">+ Add Phone</button>

<label style="margin:10px 0 5px;">Email Addresses</label>
<div id="vcardEmails"></div>
<button class="btn-small add-btn" onclick="addVcardEmail()">+ Add Email</button>

<label style="margin:10px 0 5px;">Website</label>
<input type="url" id="vcardWebsite" placeholder="https://www.example.com">

</div>

<!-- Email Template -->
<div id="emailInputs" style="display:none; margin-top:15px;">
<label style="margin:5px 0;">Email Address(es) *</label>
<input type="text" id="emailTo" placeholder="email@example.com, other@example.com">
<small style="display:block; margin:-10px 0 10px;">Separate multiple emails with commas</small>
<label style="margin:5px 0;">Subject</label>
<input type="text" id="emailSubject" placeholder="Email subject">
<label style="margin:5px 0;">Message</label>
<textarea id="emailBody" placeholder="Email message" style="height:80px;"></textarea>
</div>

<!-- SMS Template -->
<div id="smsInputs" style="display:none; margin-top:15px;">
<label style="margin:5px 0;">Phone Number(s) *</label>
<input type="text" id="smsNumbers" placeholder="+1234567890, +0987654321">
<small style="display:block; margin:-10px 0 10px;">Separate multiple numbers with commas</small>
<label style="margin:5px 0;">Message</label>
<textarea id="smsBody" placeholder="SMS message" style="height:80px;"></textarea>
</div>

<!-- Phone Template -->
<div id="phoneInputs" style="display:none; margin-top:15px;">
<label style="margin:5px 0;">Phone Number *</label>
<input type="tel" id="phoneNumber" placeholder="+1234567890">
</div>

<!-- Location Template -->
<div id="locationInputs" style="display:none; margin-top:15px;">
<label style="margin:5px 0;">Latitude *</label>
<input type="text" id="locationLat" placeholder="37.7749">
<label style="margin:5px 0;">Longitude *</label>
<input type="text" id="locationLng" placeholder="-122.4194">
<small style="display:block; margin:-10px 0 10px;">Or use address:</small>
<label style="margin:5px 0;">Address (Alternative)</label>
<input type="text" id="locationAddress" placeholder="123 Main St, City">
</div>

<!-- Event Template -->
<div id="eventInputs" style="display:none; margin-top:15px;">
<label style="margin:5px 0;">Event Title *</label>
<input type="text" id="eventTitle" placeholder="Team Meeting">
<label style="margin:5px 0;">Location</label>
<input type="text" id="eventLocation" placeholder="Conference Room A">
<label style="margin:5px 0;">Start Date & Time *</label>
<input type="datetime-local" id="eventStart">
<label style="margin:5px 0;">End Date & Time *</label>
<input type="datetime-local" id="eventEnd">
<label style="margin:5px 0;">Description</label>
<textarea id="eventDescription" placeholder="Event details" style="height:60px;"></textarea>
</div>

</div>

<textarea id="data" style="display:none;"></textarea>

<label>Error Correction Level</label>
<select id="errorCorrection">
<option value="L">Low (7%)</option>
<option value="M" selected>Medium (15%)</option>
<option value="Q">Quartile (25%)</option>
<option value="H">High (30%)</option>
</select>

</div>

<!-- Foreground Tab -->
<div id="tab-foreground" class="tab-content">
<label class="collapsible" onclick="toggleSection(this)">üé® Style & Patterns</label>

<div class="collapsible-content">
<label>Module Style</label>
<select id="dotsStyle">
<option value="square" selected>Square</option>
<option value="rounded">Rounded</option>
<option value="extra-rounded">Extra Rounded</option>
<option value="dots">Dots</option>
<option value="classy">Classy</option>
<option value="classy-rounded">Classy Rounded</option>
</select>
<small style="display:block; margin-top:-10px; margin-bottom:10px; color: var(--txt-3);">Note: Heart shape not available in library</small>
</div>

<label class="collapsible" onclick="toggleSection(this)">üåà Color Schemes</label>
<div class="collapsible-content">
<div class="preset-grid">
<button class="preset-btn" onclick="applyPreset('corporate')">üè¢ Corporate</button>
<button class="preset-btn" onclick="applyPreset('vibrant')">üåà Vibrant</button>
<button class="preset-btn" onclick="applyPreset('pastel')">üé® Pastel</button>
<button class="preset-btn" onclick="applyPreset('mono')">‚ö´ Mono</button>
</div>

<button onclick="saveScheme()" class="btn-small" style="width:100%;">üíæ Save Current Colors</button>
<div id="savedSchemes" class="saved-schemes"></div>

<label>Foreground Color</label>
<div class="color-row">
<input type="color" id="fgColor" value="#000000">
<input type="text" id="fgHex" value="#000000">
</div>

</div>
</div>

<!-- Background Tab -->
<div id="tab-background" class="tab-content">


<label>Background Color</label>
<div class="color-row">
<input type="color" id="bgColor" value="#ffffff">
<input type="text" id="bgHex" value="#ffffff">
</div>

<label>Background Opacity (%)</label>
<input type="range" id="bgOpacity" min="0" max="100" value="100">
<div class="live-value"><span id="opacityValue">100%</span></div>

<label>Border Thickness</label>

<input type="range" id="borderSize" min="0" max="20" value="6">
<div class="live-value"><span id="borderValue">6</span> modules</div>

</div>

<!-- Frame Tab -->
<div id="tab-frame" class="tab-content">
<label>Frame Around QR</label>
<div style="display:flex; align-items:center; gap:8px; margin:10px 0;">
<input type="checkbox" id="enableFrame" style="width:auto; margin:0;">
<label for="enableFrame" style="margin:0; font-weight:normal; font-size:14px; cursor:pointer;">Enable Frame</label>
</div>

<div id="frameControls" style="display:none; margin-top:15px; padding-top:15px; border-top:1px solid var(--border);">
  <label>Frame Thickness (px)</label>
  <input type="range" id="frameThickness" min="1" max="50" value="10">
  <div class="live-value"><span id="frameThicknessValue">10</span> px</div>
  
  <label>Frame Color</label>
  <div class="color-row">
    <input type="color" id="frameColor" value="#000000">
    <input type="text" id="frameColorHex" value="#000000">
  </div>
  
  <label>Frame Pattern</label>
  <select id="framePattern" style="width:100%; padding:12px; margin-bottom:14px; border:1px solid var(--border); border-radius:12px; background:var(--bg-2); color:var(--txt-1);">
    <option value="solid">Solid</option>
    <option value="dashed">Dashed</option>
    <option value="dotted">Dotted</option>
    <option value="double">Double Line</option>
  </select>
</div>

</div>

<!-- Corners Tab -->
<div id="tab-corners" class="tab-content">


<div style="display:flex; align-items:center; justify-content:space-between; margin:16px 0 7px;">
<label style="margin:0;">Eye Outer Color</label>
<div style="display:flex; align-items:center; gap:8px;">
<input type="checkbox" id="useFgForOuter" checked style="width:auto; margin:0;">
<label for="useFgForOuter" style="margin:0; font-weight:normal; font-size:14px; cursor:pointer;">Use foreground colour</label>
</div>
</div>
<div class="color-row">
<input type="color" id="eyeOuter" value="#000000">
<input type="text" id="eyeOuterHex" value="#000000">
</div>

<div style="display:flex; align-items:center; justify-content:space-between; margin:16px 0 7px;">
<label style="margin:0;">Eye Inner Color</label>
<div style="display:flex; align-items:center; gap:12px;">
<div style="display:flex; align-items:center; gap:6px;">
<input type="checkbox" id="useFgForInner" style="width:auto; margin:0;">
<label for="useFgForInner" style="margin:0; font-weight:normal; font-size:13px; cursor:pointer;">Use foreground colour</label>
</div>
<div style="display:flex; align-items:center; gap:6px;">
<input type="checkbox" id="useOuterForInner" checked style="width:auto; margin:0;">
<label for="useOuterForInner" style="margin:0; font-weight:normal; font-size:13px; cursor:pointer;">Use outer eye colour</label>
</div>
</div>
</div>
<div class="color-row">
<input type="color" id="eyeInner" value="#000000">
<input type="text" id="eyeInnerHex" value="#000000">
</div>

</div>

<!-- Image Tab -->
<div id="tab-image" class="tab-content">

<label class="collapsible" onclick="toggleSection(this)">üñºÔ∏è Image Settings</label>
<div class="collapsible-content">
<label>Image Upload</label>
<div style="display:flex; gap:8px; align-items:center;">
<input type="file" id="logo" accept="image/*" style="flex:1;">
<button onclick="removeLogo()" class="btn-small" style="width:auto; padding:8px 12px; margin:0; background:#ff4444;">Remove Image</button>
</div>

<label>Icon Library</label>
<div class="icon-browser">

<div style="display:flex; gap:8px; margin-bottom:8px;">
  <button type="button" id="emojiModeBtn" class="btn-small" onclick="setIconMode('emoji')" style="flex:1; width:auto;">üì± Emoji</button>
  <button type="button" id="faModeBtn" class="btn-small" onclick="setIconMode('fa')" style="flex:1; width:auto;">üé® Font Awesome</button>
</div>

<div class="icon-controls">
<input type="text" id="iconSearch" placeholder="Search icons..." oninput="filterIcons()">
<select id="iconCategory" onchange="filterIcons()">
<option value="all">All Icons</option>
<option value="communication">Communication</option>
<option value="technology">Technology</option>
<option value="business">Business</option>
<option value="social">Social Media</option>
<option value="transport">Transport</option>
<option value="food">Food & Drink</option>
<option value="all">All Icons</option>
<option value="weather">Weather</option>
<option value="symbols">Symbols</option>
<option value="activities">Activities</option>
<option value="objects">Objects</option>
</select>
</div>
<div class="icon-grid" id="iconGrid"></div>
<div class="icon-count" id="iconCount"></div>
</div>

<div id="faColorControls" style="display:none; margin-top:10px; padding-top:10px; border-top:1px solid var(--border);">
  <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:6px;">
    <label style="margin:0;">Icon Color</label>
    <div style="display:flex; align-items:center; gap:6px;">
      <input type="checkbox" id="faUseFgColor" style="width:auto; margin:0;" checked>
      <label for="faUseFgColor" style="margin:0; font-weight:normal; font-size:13px; cursor:pointer;">Use foreground colour</label>
    </div>
  </div>
  <div class="color-row">
    <input type="color" id="faIconColor" value="#000000">
    <input type="text" id="faIconColorHex" value="#000000">
  </div>
</div>

<label>Image Size (%)</label>

<small style="display: block; margin: -10px 0 10px;">üí° Higher error correction = larger images</small>
<input type="range" id="logoSize" min="10" max="200" value="25">
<div class="live-value"><span id="logoValue">25%</span></div>
</div>

</div>
<!-- Watermark Tab -->
<div id="tab-watermark" class="tab-content">
    <div id="watermarkContainer"></div>
    <button class="btn-small add-btn" onclick="addNewWatermarkBox()" style="width: 100%; margin-top: 10px;">+ Add Watermark</button>
</div>
</div>

<!-- Fixed Bottom Section -->
<div class="fixed-bottom">

<label>Download Size (px)</label>
<input type="range" id="downloadSize" min="200" max="2000" step="50" value="400">
<div class="live-value"><span id="downloadValue">400</span> px</div>

<button onclick="generate()">‚ú® Generate Preview (Ctrl/Cmd + Enter)</button>
</div>
</div>

<div class="panel right-panel">
<div id="preview-container">
<div id="qr-output"></div>
</div>
<div id="frameWarning" class="warning-box" style="display:none; background: #fff3cd; color: #856404; border: 1px solid #ffc107;">
‚ö†Ô∏è If QR fails to scan, try reducing frame thickness
</div>
<div id="contrastWarning" class="warning-box warning-contrast" style="display:none;">
‚ö†Ô∏è Low contrast detected - QR may be hard to scan!
</div>
<div id="logoWarning" class="warning-box warning-logo" style="display:none;">
‚ö†Ô∏è If QR fails to scan, try a smaller logo
</div>
<div class="actions" style="display: flex; gap: 10px; justify-content: center;">
<div style="display: flex; gap: 10px; width: 80%;">
<div class="download-dropdown" style="position: relative; display: inline-block; flex: 1;">
<button type="button" id="download-btn" onclick="toggleDownloadMenu()" style="white-space: nowrap; padding: 10px; font-size: 13px;">üì• Download QR ‚ñº</button>
<div id="download-menu" class="dropdown-menu" style="display: none; position: absolute; background-color: var(--bg-2); box-shadow: 0 8px 16px rgba(0,0,0,0.2); z-index: 1001; border-radius: 8px; padding: 5px 0; left: 0; top: 100%; width: 100%; border: 1px solid var(--border); max-height: 150px; overflow-y: auto;">
<a href="#" onclick="downloadPNG(); return false;">üì• PNG</a>
<a href="#" onclick="downloadJPG(); return false;">üñºÔ∏è JPG</a>
<a href="#" onclick="downloadWEBP(); return false;">üé® WEBP</a>
<a href="#" onclick="downloadPDF(); return false;">üìÑ PDF</a>
<a href="#" onclick="downloadSVG(); return false;">üìã SVG</a>
<a href="#" onclick="copyToClipboard(); return false;">üìé Copy to Clipboard</a>
</div>
</div>
<button type="button" id="share-btn" onclick="shareQR()" style="white-space: nowrap; flex: 1; padding: 10px; font-size: 13px;">üì§ Share</button>
</div>
</div>
</div>
</div>

<script>
let qrCode=null,logoDataUrl=null,currentTemplate='url',vcardPhoneCount=0,vcardEmailCount=0,watermarks=[],watermarkCounter=0
function createWatermarkBox(wmData) {
    const boxId = `watermark-box-${wmData.id}`;
    const isHidden = wmData.hidden || false;
    const isCollapsed = wmData.collapsed || false;
    
    return `
        <div class="watermark-box" id="${boxId}" data-wm-id="${wmData.id}">
            <div class="watermark-box-header">
                <button class="btn-collapse" onclick="toggleCollapseWatermark(${wmData.id})" title="${isCollapsed ? 'Expand' : 'Collapse'}">
                    <i class="fa-solid fa-${isCollapsed ? 'chevron-down' : 'chevron-up'}"></i>
                </button>
                <button class="btn-hide" onclick="toggleHideWatermark(${wmData.id})" title="${isHidden ? 'Show' : 'Hide'}">
                    <i class="fa-solid fa-eye${isHidden ? '' : '-slash'}"></i>
                </button>
                <button class="btn-remove" onclick="removeWatermarkBox(${wmData.id})" title="Remove">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="watermark-box-content ${isCollapsed ? 'collapsed' : ''}">
                ${generateWatermarkControls(wmData)}
            </div>
        </div>
    `;
}

function applyWatermarksToCanvas() {
    const canvas = document.querySelector('#qr-output canvas');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    const w = canvas.width;
    const h = canvas.height;
    
    // Draw all watermarks that are not hidden
    watermarks.forEach(wm => {
        if (!wm.hidden) {
            drawWatermarkOnCanvas(ctx, wm, w, h);
        }
    });
}

function drawWatermarkOnCanvas(ctx, wm, w, h) {
    console.log('drawWatermarkOnCanvas called with:', {wm, w, h});
    ctx.save();
    ctx.globalAlpha = wm.opacity / 100;
    
    const x = (wm.x / 100) * w;
    const y = (wm.y / 100) * h;
    const size = (wm.size / 100) * Math.min(w, h);
    
    console.log('Calculated position and size:', {x, y, size});
    
    if (wm.type === 'text') {
        const color = wm.autoColor ? getAutoWatermarkColor() : wm.color;
        const wmFont = wm.fontFamily || 'Arial, sans-serif';
        const fontSize = wm.fontSize * (size / 40);
        ctx.font = `${fontSize}px ${wmFont}`;
        ctx.fillStyle = color;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        console.log('Drawing text watermark:', {text: wm.text, fontSize, color, x, y});
        ctx.fillText(wm.text, x, y);
    } else if (wm.type === 'emoji') {
        ctx.font = `${size}px Arial`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(wm.emoji, x, y);
    } else if (wm.type === 'image' && wm.src) {
        const img = new Image();
        img.onload = function() {
            // Maintain aspect ratio
            const aspectRatio = img.width / img.height;
            let drawWidth = size;
            let drawHeight = size;
            
            if (aspectRatio > 1) {
                // Landscape image
                drawHeight = size / aspectRatio;
            } else {
                // Portrait or square image
                drawWidth = size * aspectRatio;
            }
            
            ctx.save();
            ctx.globalAlpha = wm.opacity / 100;
            ctx.drawImage(img, x - drawWidth/2, y - drawHeight/2, drawWidth, drawHeight);
            ctx.restore();
        };
        img.src = wm.src;

    } else if (wm.type === 'fontawesome' && wm.iconClass) {
        const color = wm.autoColor ? getAutoWatermarkColor() : wm.color;
        ctx.font = `900 ${size}px "Font Awesome 6 Free"`;
        ctx.fillStyle = color;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        // Get the FA icon's unicode character
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = `<i class="${wm.iconClass}"></i>`;
        tempDiv.style.position = 'absolute';
        tempDiv.style.left = '-9999px';
        document.body.appendChild(tempDiv);
        const iconElement = tempDiv.querySelector('i');
        const beforeStyle = window.getComputedStyle(iconElement, ':before');
        const iconContent = beforeStyle.content.replace(/['"]/g, '');
        ctx.fillText(iconContent, x, y);
        document.body.removeChild(tempDiv);
    }
    
    ctx.restore();
}

function getAutoWatermarkColor() {
  const fgColor = $('fgColor').value;
  const bgColor = $('bgColor').value;
  
  // Calculate luminance
  const getLuminance = (hex) => {
    const rgb = parseInt(hex.slice(1), 16);
    const r = (rgb >> 16) & 0xff;
    const g = (rgb >> 8) & 0xff;
    const b = (rgb >> 0) & 0xff;
    return 0.299 * r + 0.587 * g + 0.114 * b;
  };
  
  const fgLum = getLuminance(fgColor);
  const bgLum = getLuminance(bgColor);
  
  // Return color with better contrast
  return fgLum > bgLum ? fgColor : bgColor;
}
function getCurrentWatermarkData() {
  const type = $('watermarkType').value;
  if (!type) return null;

  let data = {
    type: type,
    size: $('watermarkSize').value,
    opacity: $('watermarkOpacity').value,
    x: watermarkDragData.x,
    y: watermarkDragData.y
  };

  if (type === 'text') {
    const text = $('watermarkText').value.trim();
    if (!text) return null;
    data.text = text;
    data.fontSize = $('watermarkTextSize').value;
    data.fontFamily = $('watermarkFontFamily').value || 'Arial';
    data.color = $('watermarkTextColor').value;
    data.autoColor = $('watermarkAutoColor').checked;
  } else if (type === 'image') {
    if (!currentWatermarkData || currentWatermarkData.type !== 'image') return null;
    data.src = currentWatermarkData.value;
  } else if (type === 'emoji') {
    if (!currentWatermarkData || currentWatermarkData.type !== 'emoji') return null;
    data.emoji = currentWatermarkData.value;
  } else if (type === 'fontawesome') {
    if (!currentWatermarkData || currentWatermarkData.type !== 'fontawesome') return null;
    data.iconClass = currentWatermarkData.value;
    data.color = $('watermarkFaColor').value;
    data.autoColor = $('watermarkFaAutoColor').checked;
  }

  return data;
}


function generateWatermarkControls(wmData) {
    const wmId = wmData.id;
    
    return `
        <label>Watermark Type</label>
        <div class="template-grid">
            <button class="template-btn ${wmData.type === 'text' ? 'active' : ''}" onclick="changeWatermarkType(${wmId}, 'text'); return false;">Text</button>
            <button class="template-btn ${wmData.type === 'image' ? 'active' : ''}" onclick="changeWatermarkType(${wmId}, 'image'); return false;">Image</button>
            <button class="template-btn ${wmData.type === 'emoji' ? 'active' : ''}" onclick="changeWatermarkType(${wmId}, 'emoji'); return false;">Emoji</button>
            <button class="template-btn ${wmData.type === 'fontawesome' ? 'active' : ''}" onclick="changeWatermarkType(${wmId}, 'fontawesome'); return false;">Font Awesome</button>
        </div>
        
        <div id="wm-${wmId}-controls">
            ${generateTypeSpecificControls(wmData)}
        </div>
        
        <label>Size</label>
        <input type="range" id="wm-${wmId}-size" min="5" max="150" value="${wmData.size || 15}" oninput="updateWatermarkProp(${wmId}, 'size', this.value)">
        <div class="live-value"><span id="wm-${wmId}-size-value">${wmData.size || 15}</span>%</div>
        
        <label>Opacity</label>
        <input type="range" id="wm-${wmId}-opacity" min="10" max="100" value="${wmData.opacity || 50}" oninput="updateWatermarkProp(${wmId}, 'opacity', this.value)">
        <div class="live-value"><span id="wm-${wmId}-opacity-value">${wmData.opacity || 50}</span>%</div>
        
        <label>Position</label>
        <div class="watermark-preview-box" id="wm-${wmId}-position-box">
            <div class="watermark-draggable" id="wm-${wmId}-draggable" style="left: ${wmData.x || 50}%; top: ${wmData.y || 50}%; transform: translate(-50%, -50%);">
                <span style="font-size: 24px;">${getWatermarkPreview(wmData)}</span>
            </div>
        </div>
        <small style="display:block; text-align:center; margin-top:5px;">Drag to position watermark</small>
    `;
}

function generateTypeSpecificControls(wmData) {
    const wmId = wmData.id;
    let html = '';
    
    if (wmData.type === 'text') {
        html = `
            <label>Text</label>
            <input type="text" id="wm-${wmId}-text" placeholder="Enter watermark text" value="${wmData.text || ''}" oninput="updateWatermarkProp(${wmId}, 'text', this.value)">
            
            <label>Font Size (px)</label>
            <input type="range" id="wm-${wmId}-fontSize" min="8" max="100" value="${wmData.fontSize || 20}" oninput="updateWatermarkProp(${wmId}, 'fontSize', this.value)">
            <div class="live-value"><span id="wm-${wmId}-fontSize-value">${wmData.fontSize || 20}</span> px</div>
            
            <div style="display:flex; align-items:center; justify-content:space-between; margin:16px 0 7px;">
                <label style="margin:0;">Text Color</label>
                <div style="display:flex; align-items:center; gap:6px;">
                    <input type="checkbox" id="wm-${wmId}-autoColor" style="width:auto; margin:0;" ${wmData.autoColor ? 'checked' : ''} onchange="updateWatermarkProp(${wmId}, 'autoColor', this.checked)">
                    <label for="wm-${wmId}-autoColor" style="margin:0; font-weight:normal; font-size:13px; cursor:pointer;">Auto color based on QR</label>
                </div>
            </div>
            <div class="color-row">
                <input type="color" id="wm-${wmId}-color" value="${wmData.color || '#000000'}" oninput="updateWatermarkProp(${wmId}, 'color', this.value)">
                <input type="text" id="wm-${wmId}-color-hex" value="${wmData.color || '#000000'}" oninput="updateWatermarkProp(${wmId}, 'color', this.value)">
            </div>
            
            <label>Font Family</label>
            <select id="wm-${wmId}-fontFamily" onchange="updateWatermarkProp(${wmId}, 'fontFamily', this.value)" style="width:100%; padding:12px; border:1px solid var(--border); border-radius:12px; background:var(--bg-2); color:var(--txt-1); font-size:16px;">
                <option value="Arial, sans-serif" ${wmData.fontFamily === 'Arial, sans-serif' ? 'selected' : ''}>Arial</option>
                <option value="Roboto, sans-serif" ${wmData.fontFamily === 'Roboto, sans-serif' ? 'selected' : ''}>Roboto</option>
                <option value="Open Sans, sans-serif" ${wmData.fontFamily === 'Open Sans, sans-serif' ? 'selected' : ''}>Open Sans</option>
                <option value="Montserrat, sans-serif" ${wmData.fontFamily === 'Montserrat, sans-serif' ? 'selected' : ''}>Montserrat</option>
                <option value="Impact, sans-serif" ${wmData.fontFamily === 'Impact, sans-serif' ? 'selected' : ''}>Impact</option>
            </select>
        `;
    } else if (wmData.type === 'image') {
        html = `
            <label>Upload Image</label>
            <input type="file" id="wm-${wmId}-image" accept="image/*" onchange="handleWatermarkImageUploadBox(${wmId}, event)">
            ${wmData.src ? `<div style="text-align:center; margin:10px 0;"><img src="${wmData.src}" style="max-width:100px; max-height:100px;"></div>` : ''}
        `;
    } else if (wmData.type === 'emoji') {
        html = `
            <label>Select Emoji</label>
            <div class="icon-controls">
                <input type="text" id="wm-${wmId}-emoji-search" placeholder="Search emoji..." oninput="filterWatermarkEmojis(${wmId})">
                <select id="wm-${wmId}-emoji-category" onchange="filterWatermarkEmojis(${wmId})">
                    <option value="all">All Icons</option>
                    <option value="communication">Communication</option>
                    <option value="social">Social</option>
                    <option value="symbols">Symbols</option>
                </select>
            </div>
            <div class="icon-grid" id="wm-${wmId}-emoji-grid" style="max-height: 150px;"></div>
        `;
    } else if (wmData.type === 'fontawesome') {
        html = `
            <label>Select Font Awesome Icon</label>
            <div class="icon-controls">
                <input type="text" id="wm-${wmId}-fa-search" placeholder="Search icons..." oninput="filterWatermarkFA(${wmId})">
                <select id="wm-${wmId}-fa-category" onchange="filterWatermarkFA(${wmId})">
                    <option value="all">All Icons</option>
                    <option value="communication">Communication</option>
                    <option value="technology">Technology</option>
                    <option value="business">Business</option>
                </select>
            </div>
            <div class="icon-grid" id="wm-${wmId}-fa-grid" style="max-height: 150px;"></div>
            
            <div style="display:flex; align-items:center; justify-content:space-between; margin:16px 0 7px;">
                <label style="margin:0;">Icon Color</label>
                <div style="display:flex; align-items:center; gap:6px;">
                    <input type="checkbox" id="wm-${wmId}-fa-autoColor" style="width:auto; margin:0;" ${wmData.autoColor ? 'checked' : ''} onchange="updateWatermarkProp(${wmId}, 'autoColor', this.checked)">
                    <label for="wm-${wmId}-fa-autoColor" style="margin:0; font-weight:normal; font-size:13px; cursor:pointer;">Auto color based on QR</label>
                </div>
            </div>
            <div class="color-row">
                <input type="color" id="wm-${wmId}-fa-color" value="${wmData.color || '#000000'}" oninput="updateWatermarkProp(${wmId}, 'color', this.value)">
                <input type="text" id="wm-${wmId}-fa-color-hex" value="${wmData.color || '#000000'}" oninput="updateWatermarkProp(${wmId}, 'color', this.value)">
            </div>
        `;
    }
    
    return html;
}

function getWatermarkPreview(wmData) {
  if (wmData.type === 'text') {
    const color = wmData.autoColor ? '#000' : wmData.color;
    return `<span style="font-size:${wmData.fontSize}px; color:${color}; font-family:${wmData.fontFamily || 'Arial'}">${wmData.text || 'üíß'}</span>`;
  }
  if (wmData.type === 'emoji') {
    return `<span style="font-size:${wmData.size * 2}px">${wmData.emoji || 'üòÄ'}</span>`;
  }
  if (wmData.type === 'fontawesome') {
    const color = wmData.autoColor ? '#000' : wmData.color;
    return `<i class="${wmData.iconClass}" style="font-size:${wmData.size}px; color:${color}"></i>`;
  }
  if (wmData.type === 'image') {
    return `<img src="${wmData.src}" style="max-width:${wmData.size}px; max-height:${wmData.size}px">`;
  }
  return '<span style="font-size:24px">üíß</span>';
}

function renderWatermarkBoxes() {
    const container = document.getElementById('watermarkContainer');
    if (!container) return;
    
    container.innerHTML = watermarks.map(wm => createWatermarkBox(wm)).join('');
    
    // Initialize draggable for each watermark
    watermarks.forEach(wm => {
        initWatermarkBoxDraggable(wm.id);
        if (wm.type === 'emoji') renderWatermarkBoxEmojis(wm.id);
        if (wm.type === 'fontawesome') renderWatermarkBoxFA(wm.id);
    });
}

function addNewWatermarkBox() {
    const newWm = {
        id: watermarkCounter++,
        type: 'text',
        text: 'üíß',
        fontSize: 20,
        fontFamily: 'Arial, sans-serif',
        color: '#D4AF37',
        autoColor: false,
        size: 15,
        opacity: 50,
        x: 50,
        y: 50,
        hidden: false,
        collapsed: false
    };
    
    watermarks.push(newWm);
    renderWatermarkBoxes();
    generate();
}

function removeWatermarkBox(wmId) {
    watermarks = watermarks.filter(wm => wm.id !== wmId);
    renderWatermarkBoxes();
    generate();
}

function toggleHideWatermark(wmId) {
    const wm = watermarks.find(w => w.id === wmId);
    if (!wm) return;
    
    wm.hidden = !wm.hidden;
    renderWatermarkBoxes();
    generate();
}

function toggleCollapseWatermark(wmId) {
    const wm = watermarks.find(w => w.id === wmId);
    if (!wm) return;
    
    wm.collapsed = !wm.collapsed;
    const box = document.getElementById(`watermark-box-${wmId}`);
    if (!box) return;
    
    const content = box.querySelector('.watermark-box-content');
    const btn = box.querySelector('.btn-collapse i');
    
    if (wm.collapsed) {
        content.classList.add('collapsed');
        btn.className = 'fa-solid fa-chevron-down';
    } else {
        content.classList.remove('collapsed');
        btn.className = 'fa-solid fa-chevron-up';
    }
}

function changeWatermarkType(wmId, newType) {
  const wm = watermarks.find(w => w.id === wmId);
  if (!wm) return;
  
  wm.type = newType;
  renderWatermarkBoxes();
  generate();
}

function updateWatermarkProp(wmId, prop, value) {
  const wm = watermarks.find(w => w.id === wmId);
  if (!wm) return;
  
  wm[prop] = value;
  
  // Update display value if exists
  const valueSpan = document.getElementById(`wm-${wmId}-${prop}-value`);
  if (valueSpan) valueSpan.textContent = value;
  
  // Sync color inputs
  if (prop === 'color') {
    const colorInput = document.getElementById(`wm-${wmId}-color`);
    const hexInput = document.getElementById(`wm-${wmId}-color-hex`);
    const faColorInput = document.getElementById(`wm-${wmId}-fa-color`);
    const faHexInput = document.getElementById(`wm-${wmId}-fa-color-hex`);
    
    if (colorInput) colorInput.value = value;
    if (hexInput) hexInput.value = value;
    if (faColorInput) faColorInput.value = value;
    if (faHexInput) faHexInput.value = value;
  }
  
  // Update draggable preview
  updateDraggablePreview(wmId);
  
  generate();
}
function updateDraggablePreview(wmId) {
  const wm = watermarks.find(w => w.id === wmId);
  if (!wm) return;
  
  const draggable = document.getElementById(`wm-${wmId}-draggable`);
  if (!draggable) return;
  
  const span = draggable.querySelector('span');
  if (!span) return;
  
  if (wm.type === 'text') {
    const color = wm.autoColor ? getAutoWatermarkColor() : wm.color;
    span.style.fontSize = `${wm.fontSize}px`;
    span.style.color = color;
    span.style.fontFamily = wm.fontFamily || 'Arial, sans-serif';
    span.textContent = wm.text || 'üíß';
  } else if (wm.type === 'emoji') {
    span.style.fontSize = `${wm.size * 2}px`;
    span.style.color = '';
    span.style.fontFamily = 'Arial';
    span.textContent = wm.emoji || 'üòÄ';
  } else if (wm.type === 'fontawesome') {
    const color = wm.autoColor ? getAutoWatermarkColor() : wm.color;
    span.innerHTML = `<i class="${wm.iconClass}" style="font-size:${wm.size}px; color:${color}"></i>`;
  } else if (wm.type === 'image') {
    span.innerHTML = `<img src="${wm.src}" style="max-width:${wm.size}px; max-height:${wm.size}px">`;
  }
}

function initWatermarkBoxDraggable(wmId) {
    const box = document.getElementById(`wm-${wmId}-position-box`);
    const draggable = document.getElementById(`wm-${wmId}-draggable`);
    if (!box || !draggable) return;
    
    let isDragging = false;
    let startX, startY, initialLeft, initialTop;
    
    draggable.addEventListener('mousedown', startDrag);
    draggable.addEventListener('touchstart', startDrag);
    
    function startDrag(e) {
        isDragging = true;
        const touch = e.type.includes('touch') ? e.touches[0] : e;
        startX = touch.clientX;
        startY = touch.clientY;
        
        const rect = draggable.getBoundingClientRect();
        const boxRect = box.getBoundingClientRect();
        initialLeft = rect.left - boxRect.left;
        initialTop = rect.top - boxRect.top;
        
        document.addEventListener('mousemove', drag);
        document.addEventListener('touchmove', drag);
        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('touchend', stopDrag);
        e.preventDefault();
    }
    
    function drag(e) {
        if (!isDragging) return;
        
        const touch = e.type.includes('touch') ? e.touches[0] : e;
        const dx = touch.clientX - startX;
        const dy = touch.clientY - startY;
        
        const boxRect = box.getBoundingClientRect();
        let newLeft = initialLeft + dx;
        let newTop = initialTop + dy;
        
        newLeft = Math.max(0, Math.min(newLeft, boxRect.width - draggable.offsetWidth));
        newTop = Math.max(0, Math.min(newTop, boxRect.height - draggable.offsetHeight));
        
        draggable.style.left = newLeft + 'px';
        draggable.style.top = newTop + 'px';
        draggable.style.transform = 'none';
        
        const centerX = (newLeft + draggable.offsetWidth / 2) / boxRect.width;
        const centerY = (newTop + draggable.offsetHeight / 2) / boxRect.height;
        
        const wm = watermarks.find(w => w.id === wmId);
        if (wm) {
            wm.x = centerX * 100;
            wm.y = centerY * 100;
        }
    }
    
    function stopDrag() {
        if (isDragging) {
            isDragging = false;
            generate();
        }
        document.removeEventListener('mousemove', drag);
        document.removeEventListener('touchmove', drag);
        document.removeEventListener('mouseup', stopDrag);
        document.removeEventListener('touchend', stopDrag);
    }
}

function handleWatermarkImageUploadBox(wmId, e) {
    const file = e.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = function(event) {
        const wm = watermarks.find(w => w.id === wmId);
        if (wm) {
            wm.src = event.target.result;
            renderWatermarkBoxes();
            generate();
        }
    };
    reader.readAsDataURL(file);
}

function filterWatermarkEmojis(wmId) {
    renderWatermarkBoxEmojis(wmId);
}

function renderWatermarkBoxEmojis(wmId) {
    const grid = document.getElementById(`wm-${wmId}-emoji-grid`);
    if (!grid) return;
    
    const searchInput = document.getElementById(`wm-${wmId}-emoji-search`);
    const catSelect = document.getElementById(`wm-${wmId}-emoji-category`);
    
    const search = searchInput ? searchInput.value.toLowerCase() : '';
    const cat = catSelect ? catSelect.value : 'all';
    
    let filtered = iconLibrary.filter(item => {
        const matchCat = cat === 'all' || item.cat === cat;
        const matchSearch = !search || item.kw.includes(search) || item.icon.includes(search);
        return matchCat && matchSearch;
    });
    
    grid.innerHTML = filtered.slice(0, 50).map(item => 
        `<div class="icon-item" onclick="selectWatermarkBoxEmoji(${wmId}, '${item.icon}')">${item.icon}</div>`
    ).join('');
}

function selectWatermarkBoxEmoji(wmId, emoji) {
  const wm = watermarks.find(w => w.id === wmId);
  if (wm) {
    wm.emoji = emoji;
    updateDraggablePreview(wmId);
    generate();
  }
}


function filterWatermarkFA(wmId) {
    renderWatermarkBoxFA(wmId);
}

function renderWatermarkBoxFA(wmId) {
    const grid = document.getElementById(`wm-${wmId}-fa-grid`);
    if (!grid) return;
    
    const searchInput = document.getElementById(`wm-${wmId}-fa-search`);
    const catSelect = document.getElementById(`wm-${wmId}-fa-category`);
    
    const search = searchInput ? searchInput.value.toLowerCase() : '';
    const cat = catSelect ? catSelect.value : 'all';
    
    let filtered = faIconLibrary.filter(item => {
        const matchCat = cat === 'all' || item.cat === cat;
        const matchSearch = !search || item.kw.includes(search);
        return matchCat && matchSearch;
    }).slice(0, 50);
    
    grid.innerHTML = filtered.map(item => 
        `<div class="icon-item" onclick="selectWatermarkBoxFA(${wmId}, '${item.icon}')"><i class="${item.icon}"></i></div>`
    ).join('');
}

function selectWatermarkBoxFA(wmId, iconClass) {
  const wm = watermarks.find(w => w.id === wmId);
  if (wm) {
    wm.iconClass = iconClass;
    updateDraggablePreview(wmId);
    generate();
  }
}


function selectWatermarkType(type) {
  // button active state
  document.querySelectorAll('#watermarkTypeButtons .template-btn')
    .forEach(b => b.classList.remove('active'));
  const btn = document.querySelector(
  `#watermarkTypeButtons .template-btn[onclick*="${type}"]`
);
if (btn) btn.classList.add('active');


  // mimic old dropdown behavior
  $('watermarkControls').style.display = 'block';

  $('textWatermarkControls').style.display = type === 'text' ? 'block' : 'none';
  $('imageWatermarkControls').style.display = type === 'image' ? 'block' : 'none';
  $('emojiWatermarkControls').style.display = type === 'emoji' ? 'block' : 'none';
  $('faWatermarkControls').style.display = type === 'fontawesome' ? 'block' : 'none';

  // keep existing logic dependent on watermarkType
  $('watermarkType').value = type;
}


function $(id){return document.getElementById(id)}
// Removed selectWatermarkType('text') - not needed with new box system

// Comprehensive icon library with categories and keywords
const iconLibrary = [
  // Communication
  {icon:'üìß',cat:'communication',kw:'email mail message letter envelope'},
  {icon:'‚úâÔ∏è',cat:'communication',kw:'email mail envelope letter'},
  {icon:'üì®',cat:'communication',kw:'incoming mail envelope letter'},
  {icon:'üì©',cat:'communication',kw:'outgoing mail envelope letter'},
  {icon:'üì¨',cat:'communication',kw:'mailbox open mail'},
  {icon:'üì≠',cat:'communication',kw:'mailbox closed empty'},
  {icon:'üìÆ',cat:'communication',kw:'postbox mail'},
  {icon:'üìû',cat:'communication',kw:'phone call telephone receiver'},
  {icon:'‚òéÔ∏è',cat:'communication',kw:'telephone phone call landline'},
  {icon:'üì±',cat:'communication',kw:'mobile phone smartphone cell'},
  {icon:'üì≤',cat:'communication',kw:'mobile phone arrow call'},
  {icon:'üí¨',cat:'communication',kw:'speech bubble message chat talk'},
  {icon:'üí≠',cat:'communication',kw:'thought bubble thinking'},
  {icon:'üó®Ô∏è',cat:'communication',kw:'speech balloon message'},
  {icon:'üóØÔ∏è',cat:'communication',kw:'anger bubble mad angry'},
  {icon:'üì£',cat:'communication',kw:'megaphone announcement loud'},
  {icon:'üì¢',cat:'communication',kw:'loudspeaker announcement'},
  {icon:'üîî',cat:'communication',kw:'bell notification alert'},
  {icon:'üîï',cat:'communication',kw:'bell silent mute'},
  
  // Technology
  {icon:'üíª',cat:'technology',kw:'laptop computer pc notebook'},
  {icon:'üñ•Ô∏è',cat:'technology',kw:'desktop computer monitor pc'},
  {icon:'‚å®Ô∏è',cat:'technology',kw:'keyboard typing input'},
  {icon:'üñ±Ô∏è',cat:'technology',kw:'mouse computer click'},
  {icon:'üñ®Ô∏è',cat:'technology',kw:'printer print document'},
  {icon:'üì±',cat:'technology',kw:'mobile phone smartphone'},
  {icon:'‚åö',cat:'technology',kw:'watch smartwatch time'},
  {icon:'üì∑',cat:'technology',kw:'camera photo picture'},
  {icon:'üì∏',cat:'technology',kw:'camera flash photo'},
  {icon:'üìπ',cat:'technology',kw:'video camera recording'},
  {icon:'üé•',cat:'technology',kw:'movie camera film video'},
  {icon:'üì∫',cat:'technology',kw:'television tv screen'},
  {icon:'üìª',cat:'technology',kw:'radio music audio'},
  {icon:'üéôÔ∏è',cat:'technology',kw:'microphone mic audio'},
  {icon:'üéöÔ∏è',cat:'technology',kw:'slider control level'},
  {icon:'üéõÔ∏è',cat:'technology',kw:'knobs control settings'},
  {icon:'üîã',cat:'technology',kw:'battery power charge'},
  {icon:'üîå',cat:'technology',kw:'plug electric power'},
  {icon:'üí°',cat:'technology',kw:'bulb light idea'},
  {icon:'üî¶',cat:'technology',kw:'flashlight torch light'},
  {icon:'üïØÔ∏è',cat:'technology',kw:'candle light flame'},
  {icon:'üì°',cat:'technology',kw:'satellite antenna signal'},
  {icon:'üì∂',cat:'technology',kw:'wifi signal bars network'},
  {icon:'üîó',cat:'technology',kw:'link chain url connection'},
  {icon:'üíæ',cat:'technology',kw:'floppy disk save storage'},
  {icon:'üíø',cat:'technology',kw:'cd optical disc'},
  {icon:'üìÄ',cat:'technology',kw:'dvd disc media'},
  {icon:'üñ≤Ô∏è',cat:'technology',kw:'trackball mouse input'},
  
  // Business
  {icon:'üíº',cat:'business',kw:'briefcase work business bag'},
  {icon:'üëî',cat:'business',kw:'necktie tie formal business'},
  {icon:'üìä',cat:'business',kw:'bar chart graph data analytics'},
  {icon:'üìà',cat:'business',kw:'chart increasing growth profit'},
  {icon:'üìâ',cat:'business',kw:'chart decreasing loss decline'},
  {icon:'üí∞',cat:'business',kw:'money bag dollar cash'},
  {icon:'üíµ',cat:'business',kw:'dollar banknote money cash'},
  {icon:'üí¥',cat:'business',kw:'yen banknote money'},
  {icon:'üí∂',cat:'business',kw:'euro banknote money'},
  {icon:'üí∑',cat:'business',kw:'pound banknote money sterling'},
  {icon:'üí≥',cat:'business',kw:'credit card payment bank'},
  {icon:'üí∏',cat:'business',kw:'money wings payment flying'},
  {icon:'üè¶',cat:'business',kw:'bank building money financial'},
  {icon:'üè¢',cat:'business',kw:'office building business work'},
  {icon:'üèõÔ∏è',cat:'business',kw:'classical building government bank'},
  {icon:'üìù',cat:'business',kw:'memo note document writing'},
  {icon:'üìã',cat:'business',kw:'clipboard document list'},
  {icon:'üìå',cat:'business',kw:'pushpin pin note'},
  {icon:'üìç',cat:'business',kw:'pin location map marker'},
  {icon:'üìé',cat:'business',kw:'paperclip attach document'},
  {icon:'üñáÔ∏è',cat:'business',kw:'linked paperclips attach'},
  {icon:'üìè',cat:'business',kw:'ruler measure straight'},
  {icon:'üìê',cat:'business',kw:'triangular ruler measure angle'},
  {icon:'‚úÇÔ∏è',cat:'business',kw:'scissors cut tool'},
  {icon:'üóÇÔ∏è',cat:'business',kw:'card index dividers organize'},
  {icon:'üóÉÔ∏è',cat:'business',kw:'card file box organize'},
  {icon:'üóÑÔ∏è',cat:'business',kw:'file cabinet storage organize'},
  {icon:'üìÅ',cat:'business',kw:'folder file directory'},
  {icon:'üìÇ',cat:'business',kw:'open folder file directory'},
  
  // Social Media
  {icon:'üë§',cat:'social',kw:'user profile person account'},
  {icon:'üë•',cat:'social',kw:'users people group friends'},
  {icon:'üë®',cat:'social',kw:'man person male user'},
  {icon:'üë©',cat:'social',kw:'woman person female user'},
  {icon:'üë∂',cat:'social',kw:'baby child infant'},
  {icon:'üë¶',cat:'social',kw:'boy child male'},
  {icon:'üëß',cat:'social',kw:'girl child female'},
  {icon:'‚ù§Ô∏è',cat:'social',kw:'heart love like favorite'},
  {icon:'üíô',cat:'social',kw:'blue heart love like'},
  {icon:'üíö',cat:'social',kw:'green heart love like'},
  {icon:'üíõ',cat:'social',kw:'yellow heart love like'},
  {icon:'üíú',cat:'social',kw:'purple heart love like'},
  {icon:'üß°',cat:'social',kw:'orange heart love like'},
  {icon:'üíï',cat:'social',kw:'two hearts love'},
  {icon:'üíñ',cat:'social',kw:'sparkling heart love'},
  {icon:'‚≠ê',cat:'social',kw:'star favorite rating'},
  {icon:'üåü',cat:'social',kw:'glowing star favorite shiny'},
  {icon:'‚ú®',cat:'social',kw:'sparkles stars shine'},
  {icon:'üëç',cat:'social',kw:'thumbs up like approve good'},
  {icon:'üëé',cat:'social',kw:'thumbs down dislike disapprove'},
  {icon:'üëè',cat:'social',kw:'clapping hands applause praise'},
  {icon:'üôå',cat:'social',kw:'raising hands celebration praise'},
  {icon:'ü§ù',cat:'social',kw:'handshake agreement deal'},
  {icon:'üéâ',cat:'social',kw:'party popper celebration confetti'},
  {icon:'üéä',cat:'social',kw:'confetti ball celebration party'},
  
  // Transport
  {icon:'üöó',cat:'transport',kw:'car automobile vehicle auto'},
  {icon:'üöï',cat:'transport',kw:'taxi cab car'},
  {icon:'üöô',cat:'transport',kw:'suv car vehicle'},
  {icon:'üöå',cat:'transport',kw:'bus vehicle public transport'},
  {icon:'üöé',cat:'transport',kw:'trolleybus bus vehicle'},
  {icon:'üöê',cat:'transport',kw:'minibus van vehicle'},
  {icon:'üöë',cat:'transport',kw:'ambulance emergency medical'},
  {icon:'üöí',cat:'transport',kw:'fire engine truck emergency'},
  {icon:'üöì',cat:'transport',kw:'police car emergency'},
  {icon:'üöö',cat:'transport',kw:'delivery truck cargo vehicle'},
  {icon:'üöõ',cat:'transport',kw:'articulated lorry truck cargo'},
  {icon:'üöú',cat:'transport',kw:'tractor farm vehicle'},
  {icon:'üèçÔ∏è',cat:'transport',kw:'motorcycle bike vehicle'},
  {icon:'üö≤',cat:'transport',kw:'bicycle bike cycle'},
  {icon:'üõ¥',cat:'transport',kw:'scooter kick vehicle'},
  {icon:'‚úàÔ∏è',cat:'transport',kw:'airplane plane flight travel'},
  {icon:'üõ´',cat:'transport',kw:'airplane departure takeoff flight'},
  {icon:'üõ¨',cat:'transport',kw:'airplane arrival landing flight'},
  {icon:'üöÅ',cat:'transport',kw:'helicopter aircraft'},
  {icon:'üöÇ',cat:'transport',kw:'train locomotive railway'},
  {icon:'üöÜ',cat:'transport',kw:'train railway vehicle'},
  {icon:'üöá',cat:'transport',kw:'metro subway underground'},
  {icon:'üöä',cat:'transport',kw:'tram streetcar trolley'},
  {icon:'üö¢',cat:'transport',kw:'ship boat vessel sea'},
  {icon:'‚õµ',cat:'transport',kw:'sailboat boat yacht'},
  {icon:'üö§',cat:'transport',kw:'speedboat boat fast'},
  {icon:'‚õ¥Ô∏è',cat:'transport',kw:'ferry boat transport'},
  {icon:'üöÄ',cat:'transport',kw:'rocket space launch'},
  {icon:'üõ∏',cat:'transport',kw:'flying saucer ufo alien'},
  
  // Food & Drink
  {icon:'üçï',cat:'food',kw:'pizza food italian slice'},
  {icon:'üçî',cat:'food',kw:'hamburger burger food fast'},
  {icon:'üçü',cat:'food',kw:'fries french potato food'},
  {icon:'üå≠',cat:'food',kw:'hotdog hot dog food'},
  {icon:'üçø',cat:'food',kw:'popcorn snack movie'},
  {icon:'ü•ó',cat:'food',kw:'salad healthy food green'},
  {icon:'üçù',cat:'food',kw:'spaghetti pasta italian food'},
  {icon:'üçú',cat:'food',kw:'noodles ramen food bowl'},
  {icon:'üç≤',cat:'food',kw:'pot food stew cooking'},
  {icon:'üç±',cat:'food',kw:'bento box lunch food japanese'},
  {icon:'üç£',cat:'food',kw:'sushi food japanese fish'},
  {icon:'üç§',cat:'food',kw:'shrimp fried food seafood'},
  {icon:'üç∞',cat:'food',kw:'cake dessert sweet birthday'},
  {icon:'üéÇ',cat:'food',kw:'birthday cake celebration dessert'},
  {icon:'üç™',cat:'food',kw:'cookie biscuit snack sweet'},
  {icon:'üç©',cat:'food',kw:'donut doughnut sweet dessert'},
  {icon:'üç´',cat:'food',kw:'chocolate candy sweet bar'},
  {icon:'üç¨',cat:'food',kw:'candy sweet wrapper'},
  {icon:'üç≠',cat:'food',kw:'lollipop candy sweet'},
  {icon:'üç¶',cat:'food',kw:'ice cream soft serve dessert'},
  {icon:'üç®',cat:'food',kw:'ice cream dessert sweet'},
  {icon:'üßÉ',cat:'food',kw:'juice box drink beverage'},
  {icon:'ü•§',cat:'food',kw:'cup straw drink beverage'},
  {icon:'‚òï',cat:'food',kw:'coffee hot drink beverage'},
  {icon:'üçµ',cat:'food',kw:'tea cup hot drink'},
  {icon:'ü•É',cat:'food',kw:'tumbler glass whiskey drink'},
  {icon:'üç∫',cat:'food',kw:'beer mug drink alcohol'},
  {icon:'üçª',cat:'food',kw:'beers clinking mugs cheers'},
  {icon:'üç∑',cat:'food',kw:'wine glass drink alcohol'},
  {icon:'üçπ',cat:'food',kw:'tropical drink cocktail'},

// Country Flags - Add this to the iconLibrary array
{icon:'üá¶üá©',cat:'flags',kw:'andorra flag country'},
{icon:'üá¶üá™',cat:'flags',kw:'united arab emirates uae flag country'},
{icon:'üá¶üá´',cat:'flags',kw:'afghanistan flag country'},
{icon:'üá¶üá¨',cat:'flags',kw:'antigua barbuda flag country'},
{icon:'üá¶üáÆ',cat:'flags',kw:'anguilla flag country'},
{icon:'üá¶üá±',cat:'flags',kw:'albania flag country'},
{icon:'üá¶üá≤',cat:'flags',kw:'armenia flag country'},
{icon:'üá¶üá¥',cat:'flags',kw:'angola flag country'},
{icon:'üá¶üá∂',cat:'flags',kw:'antarctica flag'},
{icon:'üá¶üá∑',cat:'flags',kw:'argentina flag country'},
{icon:'üá¶üá∏',cat:'flags',kw:'american samoa flag country'},
{icon:'üá¶üáπ',cat:'flags',kw:'austria flag country'},
{icon:'üá¶üá∫',cat:'flags',kw:'australia flag country'},
{icon:'üá¶üáº',cat:'flags',kw:'aruba flag country'},
{icon:'üá¶üáΩ',cat:'flags',kw:'aland islands flag country'},
{icon:'üá¶üáø',cat:'flags',kw:'azerbaijan flag country'},
{icon:'üáßüá¶',cat:'flags',kw:'bosnia herzegovina flag country'},
{icon:'üáßüáß',cat:'flags',kw:'barbados flag country'},
{icon:'üáßüá©',cat:'flags',kw:'bangladesh flag country'},
{icon:'üáßüá™',cat:'flags',kw:'belgium flag country'},
{icon:'üáßüá´',cat:'flags',kw:'burkina faso flag country'},
{icon:'üáßüá¨',cat:'flags',kw:'bulgaria flag country'},
{icon:'üáßüá≠',cat:'flags',kw:'bahrain flag country'},
{icon:'üáßüáÆ',cat:'flags',kw:'burundi flag country'},
{icon:'üáßüáØ',cat:'flags',kw:'benin flag country'},
{icon:'üáßüá±',cat:'flags',kw:'saint barthelemy flag country'},
{icon:'üáßüá≤',cat:'flags',kw:'bermuda flag country'},
{icon:'üáßüá≥',cat:'flags',kw:'brunei flag country'},
{icon:'üáßüá¥',cat:'flags',kw:'bolivia flag country'},
{icon:'üáßüá∂',cat:'flags',kw:'caribbean netherlands flag country'},
{icon:'üáßüá∑',cat:'flags',kw:'brazil flag country'},
{icon:'üáßüá∏',cat:'flags',kw:'bahamas flag country'},
{icon:'üáßüáπ',cat:'flags',kw:'bhutan flag country'},
{icon:'üáßüáª',cat:'flags',kw:'bouvet island flag'},
{icon:'üáßüáº',cat:'flags',kw:'botswana flag country'},
{icon:'üáßüáæ',cat:'flags',kw:'belarus flag country'},
{icon:'üáßüáø',cat:'flags',kw:'belize flag country'},
{icon:'üá®üá¶',cat:'flags',kw:'canada flag country'},
{icon:'üá®üá®',cat:'flags',kw:'cocos islands flag country'},
{icon:'üá®üá©',cat:'flags',kw:'congo kinshasa flag country'},
{icon:'üá®üá´',cat:'flags',kw:'central african republic flag country'},
{icon:'üá®üá¨',cat:'flags',kw:'congo brazzaville flag country'},
{icon:'üá®üá≠',cat:'flags',kw:'switzerland flag country'},
{icon:'üá®üáÆ',cat:'flags',kw:'cote ivoire ivory coast flag country'},
{icon:'üá®üá∞',cat:'flags',kw:'cook islands flag country'},
{icon:'üá®üá±',cat:'flags',kw:'chile flag country'},
{icon:'üá®üá≤',cat:'flags',kw:'cameroon flag country'},
{icon:'üá®üá≥',cat:'flags',kw:'china flag country'},
{icon:'üá®üá¥',cat:'flags',kw:'colombia flag country'},
{icon:'üá®üáµ',cat:'flags',kw:'clipperton island flag'},
{icon:'üá®üá∑',cat:'flags',kw:'costa rica flag country'},
{icon:'üá®üá∫',cat:'flags',kw:'cuba flag country'},
{icon:'üá®üáª',cat:'flags',kw:'cape verde flag country'},
{icon:'üá®üáº',cat:'flags',kw:'curacao flag country'},
{icon:'üá®üáΩ',cat:'flags',kw:'christmas island flag'},
{icon:'üá®üáæ',cat:'flags',kw:'cyprus flag country'},
{icon:'üá®üáø',cat:'flags',kw:'czechia czech republic flag country'},
{icon:'üá©üá™',cat:'flags',kw:'germany flag country'},
{icon:'üá©üá¨',cat:'flags',kw:'diego garcia flag'},
{icon:'üá©üáØ',cat:'flags',kw:'djibouti flag country'},
{icon:'üá©üá∞',cat:'flags',kw:'denmark flag country'},
{icon:'üá©üá≤',cat:'flags',kw:'dominica flag country'},
{icon:'üá©üá¥',cat:'flags',kw:'dominican republic flag country'},
{icon:'üá©üáø',cat:'flags',kw:'algeria flag country'},
{icon:'üá™üá¶',cat:'flags',kw:'ceuta melilla flag'},
{icon:'üá™üá®',cat:'flags',kw:'ecuador flag country'},
{icon:'üá™üá™',cat:'flags',kw:'estonia flag country'},
{icon:'üá™üá¨',cat:'flags',kw:'egypt flag country'},
{icon:'üá™üá≠',cat:'flags',kw:'western sahara flag'},
{icon:'üá™üá∑',cat:'flags',kw:'eritrea flag country'},
{icon:'üá™üá∏',cat:'flags',kw:'spain flag country'},
{icon:'üá™üáπ',cat:'flags',kw:'ethiopia flag country'},
{icon:'üá™üá∫',cat:'flags',kw:'european union eu flag'},
{icon:'üá´üáÆ',cat:'flags',kw:'finland flag country'},
{icon:'üá´üáØ',cat:'flags',kw:'fiji flag country'},
{icon:'üá´üá∞',cat:'flags',kw:'falkland islands flag'},
{icon:'üá´üá≤',cat:'flags',kw:'micronesia flag country'},
{icon:'üá´üá¥',cat:'flags',kw:'faroe islands flag'},
{icon:'üá´üá∑',cat:'flags',kw:'france flag country'},
{icon:'üá¨üá¶',cat:'flags',kw:'gabon flag country'},
{icon:'üá¨üáß',cat:'flags',kw:'united kingdom uk britain flag country'},
{icon:'üá¨üá©',cat:'flags',kw:'grenada flag country'},
{icon:'üá¨üá™',cat:'flags',kw:'georgia flag country'},
{icon:'üá¨üá´',cat:'flags',kw:'french guiana flag'},
{icon:'üá¨üá¨',cat:'flags',kw:'guernsey flag'},
{icon:'üá¨üá≠',cat:'flags',kw:'ghana flag country'},
{icon:'üá¨üáÆ',cat:'flags',kw:'gibraltar flag'},
{icon:'üá¨üá±',cat:'flags',kw:'greenland flag country'},
{icon:'üá¨üá≤',cat:'flags',kw:'gambia flag country'},
{icon:'üá¨üá≥',cat:'flags',kw:'guinea flag country'},
{icon:'üá¨üáµ',cat:'flags',kw:'guadeloupe flag'},
{icon:'üá¨üá∂',cat:'flags',kw:'equatorial guinea flag country'},
{icon:'üá¨üá∑',cat:'flags',kw:'greece flag country'},
{icon:'üá¨üá∏',cat:'flags',kw:'south georgia sandwich islands flag'},
{icon:'üá¨üáπ',cat:'flags',kw:'guatemala flag country'},
{icon:'üá¨üá∫',cat:'flags',kw:'guam flag'},
{icon:'üá¨üáº',cat:'flags',kw:'guinea bissau flag country'},
{icon:'üá¨üáæ',cat:'flags',kw:'guyana flag country'},
{icon:'üá≠üá∞',cat:'flags',kw:'hong kong flag'},
{icon:'üá≠üá≤',cat:'flags',kw:'heard mcdonald islands flag'},
{icon:'üá≠üá≥',cat:'flags',kw:'honduras flag country'},
{icon:'üá≠üá∑',cat:'flags',kw:'croatia flag country'},
{icon:'üá≠üáπ',cat:'flags',kw:'haiti flag country'},
{icon:'üá≠üá∫',cat:'flags',kw:'hungary flag country'},
{icon:'üáÆüá®',cat:'flags',kw:'canary islands flag'},
{icon:'üáÆüá©',cat:'flags',kw:'indonesia flag country'},
{icon:'üáÆüá™',cat:'flags',kw:'ireland flag country'},
{icon:'üáÆüá±',cat:'flags',kw:'israel flag country'},
{icon:'üáÆüá≤',cat:'flags',kw:'isle man flag'},
{icon:'üáÆüá≥',cat:'flags',kw:'india flag country'},
{icon:'üáÆüá¥',cat:'flags',kw:'british indian ocean territory flag'},
{icon:'üáÆüá∂',cat:'flags',kw:'iraq flag country'},
{icon:'üáÆüá∑',cat:'flags',kw:'iran flag country'},
{icon:'üáÆüá∏',cat:'flags',kw:'iceland flag country'},
{icon:'üáÆüáπ',cat:'flags',kw:'italy flag country'},
{icon:'üáØüá™',cat:'flags',kw:'jersey flag'},
{icon:'üáØüá≤',cat:'flags',kw:'jamaica flag country'},
{icon:'üáØüá¥',cat:'flags',kw:'jordan flag country'},
{icon:'üáØüáµ',cat:'flags',kw:'japan flag country'},
{icon:'üá∞üá™',cat:'flags',kw:'kenya flag country'},
{icon:'üá∞üá¨',cat:'flags',kw:'kyrgyzstan flag country'},
{icon:'üá∞üá≠',cat:'flags',kw:'cambodia flag country'},
{icon:'üá∞üáÆ',cat:'flags',kw:'kiribati flag country'},
{icon:'üá∞üá≤',cat:'flags',kw:'comoros flag country'},
{icon:'üá∞üá≥',cat:'flags',kw:'saint kitts nevis flag country'},
{icon:'üá∞üáµ',cat:'flags',kw:'north korea flag country'},
{icon:'üá∞üá∑',cat:'flags',kw:'south korea flag country'},
{icon:'üá∞üáº',cat:'flags',kw:'kuwait flag country'},
{icon:'üá∞üáæ',cat:'flags',kw:'cayman islands flag'},
{icon:'üá∞üáø',cat:'flags',kw:'kazakhstan flag country'},
{icon:'üá±üá¶',cat:'flags',kw:'laos flag country'},
{icon:'üá±üáß',cat:'flags',kw:'lebanon flag country'},
{icon:'üá±üá®',cat:'flags',kw:'saint lucia flag country'},
{icon:'üá±üáÆ',cat:'flags',kw:'liechtenstein flag country'},
{icon:'üá±üá∞',cat:'flags',kw:'sri lanka flag country'},
{icon:'üá±üá∑',cat:'flags',kw:'liberia flag country'},
{icon:'üá±üá∏',cat:'flags',kw:'lesotho flag country'},
{icon:'üá±üáπ',cat:'flags',kw:'lithuania flag country'},
{icon:'üá±üá∫',cat:'flags',kw:'luxembourg flag country'},
{icon:'üá±üáª',cat:'flags',kw:'latvia flag country'},
{icon:'üá±üáæ',cat:'flags',kw:'libya flag country'},
{icon:'üá≤üá¶',cat:'flags',kw:'morocco flag country'},
{icon:'üá≤üá®',cat:'flags',kw:'monaco flag country'},
{icon:'üá≤üá©',cat:'flags',kw:'moldova flag country'},
{icon:'üá≤üá™',cat:'flags',kw:'montenegro flag country'},
{icon:'üá≤üá´',cat:'flags',kw:'saint martin flag'},
{icon:'üá≤üá¨',cat:'flags',kw:'madagascar flag country'},
{icon:'üá≤üá≠',cat:'flags',kw:'marshall islands flag country'},
{icon:'üá≤üá∞',cat:'flags',kw:'north macedonia flag country'},
{icon:'üá≤üá±',cat:'flags',kw:'mali flag country'},
{icon:'üá≤üá≤',cat:'flags',kw:'myanmar burma flag country'},
{icon:'üá≤üá≥',cat:'flags',kw:'mongolia flag country'},
{icon:'üá≤üá¥',cat:'flags',kw:'macao macau flag'},
{icon:'üá≤üáµ',cat:'flags',kw:'northern mariana islands flag'},
{icon:'üá≤üá∂',cat:'flags',kw:'martinique flag'},
{icon:'üá≤üá∑',cat:'flags',kw:'mauritania flag country'},
{icon:'üá≤üá∏',cat:'flags',kw:'montserrat flag'},
{icon:'üá≤üáπ',cat:'flags',kw:'malta flag country'},
{icon:'üá≤üá∫',cat:'flags',kw:'mauritius flag country'},
{icon:'üá≤üáª',cat:'flags',kw:'maldives flag country'},
{icon:'üá≤üáº',cat:'flags',kw:'malawi flag country'},
{icon:'üá≤üáΩ',cat:'flags',kw:'mexico flag country'},
{icon:'üá≤üáæ',cat:'flags',kw:'malaysia flag country'},
{icon:'üá≤üáø',cat:'flags',kw:'mozambique flag country'},
{icon:'üá≥üá¶',cat:'flags',kw:'namibia flag country'},
{icon:'üá≥üá®',cat:'flags',kw:'new caledonia flag'},
{icon:'üá≥üá™',cat:'flags',kw:'niger flag country'},
{icon:'üá≥üá´',cat:'flags',kw:'norfolk island flag'},
{icon:'üá≥üá¨',cat:'flags',kw:'nigeria flag country'},
{icon:'üá≥üáÆ',cat:'flags',kw:'nicaragua flag country'},
{icon:'üá≥üá±',cat:'flags',kw:'netherlands holland flag country'},
{icon:'üá≥üá¥',cat:'flags',kw:'norway flag country'},
{icon:'üá≥üáµ',cat:'flags',kw:'nepal flag country'},
{icon:'üá≥üá∑',cat:'flags',kw:'nauru flag country'},
{icon:'üá≥üá∫',cat:'flags',kw:'niue flag'},
{icon:'üá≥üáø',cat:'flags',kw:'new zealand flag country'},
{icon:'üá¥üá≤',cat:'flags',kw:'oman flag country'},
{icon:'üáµüá¶',cat:'flags',kw:'panama flag country'},
{icon:'üáµüá™',cat:'flags',kw:'peru flag country'},
{icon:'üáµüá´',cat:'flags',kw:'french polynesia flag'},
{icon:'üáµüá¨',cat:'flags',kw:'papua new guinea flag country'},
{icon:'üáµüá≠',cat:'flags',kw:'philippines flag country'},
{icon:'üáµüá∞',cat:'flags',kw:'pakistan flag country'},
{icon:'üáµüá±',cat:'flags',kw:'poland flag country'},
{icon:'üáµüá≤',cat:'flags',kw:'saint pierre miquelon flag'},
{icon:'üáµüá≥',cat:'flags',kw:'pitcairn islands flag'},
{icon:'üáµüá∑',cat:'flags',kw:'puerto rico flag'},
{icon:'üáµüá∏',cat:'flags',kw:'palestinian territories flag'},
{icon:'üáµüáπ',cat:'flags',kw:'portugal flag country'},
{icon:'üáµüáº',cat:'flags',kw:'palau flag country'},
{icon:'üáµüáæ',cat:'flags',kw:'paraguay flag country'},
{icon:'üá∂üá¶',cat:'flags',kw:'qatar flag country'},
{icon:'üá∑üá™',cat:'flags',kw:'reunion flag'},
{icon:'üá∑üá¥',cat:'flags',kw:'romania flag country'},
{icon:'üá∑üá∏',cat:'flags',kw:'serbia flag country'},
{icon:'üá∑üá∫',cat:'flags',kw:'russia flag country'},
{icon:'üá∑üáº',cat:'flags',kw:'rwanda flag country'},
{icon:'üá∏üá¶',cat:'flags',kw:'saudi arabia flag country'},
{icon:'üá∏üáß',cat:'flags',kw:'solomon islands flag country'},
{icon:'üá∏üá®',cat:'flags',kw:'seychelles flag country'},
{icon:'üá∏üá©',cat:'flags',kw:'sudan flag country'},
{icon:'üá∏üá™',cat:'flags',kw:'sweden flag country'},
{icon:'üá∏üá¨',cat:'flags',kw:'singapore flag country'},
{icon:'üá∏üá≠',cat:'flags',kw:'saint helena flag'},
{icon:'üá∏üáÆ',cat:'flags',kw:'slovenia flag country'},
{icon:'üá∏üáØ',cat:'flags',kw:'svalbard jan mayen flag'},
{icon:'üá∏üá∞',cat:'flags',kw:'slovakia flag country'},
{icon:'üá∏üá±',cat:'flags',kw:'sierra leone flag country'},
{icon:'üá∏üá≤',cat:'flags',kw:'san marino flag country'},
{icon:'üá∏üá≥',cat:'flags',kw:'senegal flag country'},
{icon:'üá∏üá¥',cat:'flags',kw:'somalia flag country'},
{icon:'üá∏üá∑',cat:'flags',kw:'suriname flag country'},
{icon:'üá∏üá∏',cat:'flags',kw:'south sudan flag country'},
{icon:'üá∏üáπ',cat:'flags',kw:'sao tome principe flag country'},
{icon:'üá∏üáª',cat:'flags',kw:'el salvador flag country'},
{icon:'üá∏üáΩ',cat:'flags',kw:'sint maarten flag'},
{icon:'üá∏üáæ',cat:'flags',kw:'syria flag country'},
{icon:'üá∏üáø',cat:'flags',kw:'eswatini swaziland flag country'},
{icon:'üáπüá¶',cat:'flags',kw:'tristan da cunha flag'},
{icon:'üáπüá®',cat:'flags',kw:'turks caicos islands flag'},
{icon:'üáπüá©',cat:'flags',kw:'chad flag country'},
{icon:'üáπüá´',cat:'flags',kw:'french southern territories flag'},
{icon:'üáπüá¨',cat:'flags',kw:'togo flag country'},
{icon:'üáπüá≠',cat:'flags',kw:'thailand flag country'},
{icon:'üáπüáØ',cat:'flags',kw:'tajikistan flag country'},
{icon:'üáπüá∞',cat:'flags',kw:'tokelau flag'},
{icon:'üáπüá±',cat:'flags',kw:'timor leste flag country'},
{icon:'üáπüá≤',cat:'flags',kw:'turkmenistan flag country'},
{icon:'üáπüá≥',cat:'flags',kw:'tunisia flag country'},
{icon:'üáπüá¥',cat:'flags',kw:'tonga flag country'},
{icon:'üáπüá∑',cat:'flags',kw:'turkey flag country'},
{icon:'üáπüáπ',cat:'flags',kw:'trinidad tobago flag country'},
{icon:'üáπüáª',cat:'flags',kw:'tuvalu flag country'},
{icon:'üáπüáº',cat:'flags',kw:'taiwan flag'},
{icon:'üáπüáø',cat:'flags',kw:'tanzania flag country'},
{icon:'üá∫üá¶',cat:'flags',kw:'ukraine flag country'},
{icon:'üá∫üá¨',cat:'flags',kw:'uganda flag country'},
{icon:'üá∫üá≤',cat:'flags',kw:'us outlying islands flag'},
{icon:'üá∫üá≥',cat:'flags',kw:'united nations un flag'},
{icon:'üá∫üá∏',cat:'flags',kw:'united states usa america flag country'},
{icon:'üá∫üáæ',cat:'flags',kw:'uruguay flag country'},
{icon:'üá∫üáø',cat:'flags',kw:'uzbekistan flag country'},
{icon:'üáªüá¶',cat:'flags',kw:'vatican city flag'},
{icon:'üáªüá®',cat:'flags',kw:'saint vincent grenadines flag country'},
{icon:'üáªüá™',cat:'flags',kw:'venezuela flag country'},
{icon:'üáªüá¨',cat:'flags',kw:'british virgin islands flag'},
{icon:'üáªüáÆ',cat:'flags',kw:'us virgin islands flag'},
{icon:'üáªüá≥',cat:'flags',kw:'vietnam flag country'},
{icon:'üáªüá∫',cat:'flags',kw:'vanuatu flag country'},
{icon:'üáºüá´',cat:'flags',kw:'wallis futuna flag'},
{icon:'üáºüá∏',cat:'flags',kw:'samoa flag country'},
{icon:'üáΩüá∞',cat:'flags',kw:'kosovo flag'},
{icon:'üáæüá™',cat:'flags',kw:'yemen flag country'},
{icon:'üáæüáπ',cat:'flags',kw:'mayotte flag'},
{icon:'üáøüá¶',cat:'flags',kw:'south africa flag country'},
{icon:'üáøüá≤',cat:'flags',kw:'zambia flag country'},
{icon:'üáøüáº',cat:'flags',kw:'zimbabwe flag country'},
{icon:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',cat:'flags',kw:'england flag'},
{icon:'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø',cat:'flags',kw:'scotland flag'},
{icon:'üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø',cat:'flags',kw:'wales flag'},
{icon:'üè≥Ô∏è',cat:'flags',kw:'white flag surrender'},
{icon:'üè¥',cat:'flags',kw:'black flag pirate'},
{icon:'üè≥Ô∏è‚Äçüåà',cat:'flags',kw:'rainbow flag pride lgbtq'},
{icon:'üè¥‚Äç‚ò†Ô∏è',cat:'flags',kw:'pirate flag skull crossbones'},

  
  // Weather
  {icon:'‚òÄÔ∏è',cat:'weather',kw:'sun sunny hot weather'},
  {icon:'üå§Ô∏è',cat:'weather',kw:'sun cloud partly cloudy'},
  {icon:'‚õÖ',cat:'weather',kw:'sun behind cloud weather'},
  {icon:'üå•Ô∏è',cat:'weather',kw:'sun behind large cloud'},
  {icon:'‚òÅÔ∏è',cat:'weather',kw:'cloud cloudy weather'},
  {icon:'üå¶Ô∏è',cat:'weather',kw:'sun behind rain cloud weather'},
  {icon:'üåßÔ∏è',cat:'weather',kw:'cloud rain rainy weather'},
  {icon:'‚õàÔ∏è',cat:'weather',kw:'cloud lightning thunder storm'},
  {icon:'üå©Ô∏è',cat:'weather',kw:'cloud lightning weather'},
  {icon:'üå®Ô∏è',cat:'weather',kw:'cloud snow snowy weather'},
  {icon:'‚ùÑÔ∏è',cat:'weather',kw:'snowflake snow cold winter'},
  {icon:'‚õÑ',cat:'weather',kw:'snowman snow winter cold'},
  {icon:'‚òÉÔ∏è',cat:'weather',kw:'snowman snow winter'},
  {icon:'üå¨Ô∏è',cat:'weather',kw:'wind blowing face weather'},
  {icon:'üí®',cat:'weather',kw:'dashing wind fast air'},
  {icon:'üå™Ô∏è',cat:'weather',kw:'tornado cyclone weather'},
  {icon:'üå´Ô∏è',cat:'weather',kw:'fog weather misty'},
  {icon:'üåà',cat:'weather',kw:'rainbow colorful weather'},
  {icon:'üåô',cat:'weather',kw:'moon crescent night'},
  {icon:'‚≠ê',cat:'weather',kw:'star night sky'},
  {icon:'‚ö°',cat:'weather',kw:'lightning bolt thunder electric'},
  {icon:'üî•',cat:'weather',kw:'fire flame hot burn'},
  {icon:'üíß',cat:'weather',kw:'droplet water rain'},
  {icon:'üåä',cat:'weather',kw:'wave ocean sea water'},
  
  // Symbols
  {icon:'‚úÖ',cat:'symbols',kw:'check mark green tick correct done'},
  {icon:'‚ùå',cat:'symbols',kw:'cross mark red x wrong cancel'},
  {icon:'‚ùé',cat:'symbols',kw:'cross mark button cancel no'},
  {icon:'‚≠ï',cat:'symbols',kw:'hollow red circle o'},
  {icon:'‚úîÔ∏è',cat:'symbols',kw:'check mark tick correct'},
  {icon:'‚úñÔ∏è',cat:'symbols',kw:'multiply x cross times'},
  {icon:'‚ûï',cat:'symbols',kw:'plus add addition positive'},
  {icon:'‚ûñ',cat:'symbols',kw:'minus subtract negative'},
  {icon:'‚ûó',cat:'symbols',kw:'divide division math'},
  {icon:'‚ú¥Ô∏è',cat:'symbols',kw:'eight pointed star symbol'},
  {icon:'‚ö†Ô∏è',cat:'symbols',kw:'warning caution alert danger'},
  {icon:'üö´',cat:'symbols',kw:'prohibited ban no forbidden'},
  {icon:'üîû',cat:'symbols',kw:'no one under eighteen adult'},
  {icon:'üìµ',cat:'symbols',kw:'no mobile phones silent'},
  {icon:'üö≠',cat:'symbols',kw:'no smoking cigarette'},
  {icon:'üöØ',cat:'symbols',kw:'no littering trash'},
  {icon:'üö±',cat:'symbols',kw:'non potable water no drink'},
  {icon:'üö∑',cat:'symbols',kw:'no pedestrians walking'},
  {icon:'‚ôªÔ∏è',cat:'symbols',kw:'recycling symbol eco green'},
  {icon:'‚ö°',cat:'symbols',kw:'lightning bolt fast electric'},
  {icon:'üî∞',cat:'symbols',kw:'beginner japanese symbol'},
  {icon:'‚öúÔ∏è',cat:'symbols',kw:'fleur de lis symbol'},
  {icon:'üî±',cat:'symbols',kw:'trident emblem symbol'},
  {icon:'‚≠ê',cat:'symbols',kw:'star white medium'},
  {icon:'üåü',cat:'symbols',kw:'glowing star shining'},
  {icon:'üí´',cat:'symbols',kw:'dizzy star symbol'},
  {icon:'‚ú®',cat:'symbols',kw:'sparkles stars shine'},
  {icon:'üî∂',cat:'symbols',kw:'large orange diamond'},
  {icon:'üî∑',cat:'symbols',kw:'large blue diamond'},
  {icon:'üî∏',cat:'symbols',kw:'small orange diamond'},
  {icon:'üîπ',cat:'symbols',kw:'small blue diamond'},
  
  // Activities
  {icon:'‚öΩ',cat:'activities',kw:'soccer ball football sport'},
  {icon:'üèÄ',cat:'activities',kw:'basketball ball sport'},
  {icon:'üèà',cat:'activities',kw:'american football sport ball'},
  {icon:'‚öæ',cat:'activities',kw:'baseball ball sport'},
  {icon:'üéæ',cat:'activities',kw:'tennis ball racquet sport'},
  {icon:'üèê',cat:'activities',kw:'volleyball ball sport'},
  {icon:'üèâ',cat:'activities',kw:'rugby football ball sport'},
  {icon:'üé±',cat:'activities',kw:'pool 8 ball billiards'},
  {icon:'üèì',cat:'activities',kw:'ping pong table tennis'},
  {icon:'üè∏',cat:'activities',kw:'badminton racquet shuttlecock'},
  {icon:'ü•ä',cat:'activities',kw:'boxing glove sport fight'},
  {icon:'ü•ã',cat:'activities',kw:'martial arts uniform karate'},
  {icon:'‚õ≥',cat:'activities',kw:'golf flag hole sport'},
  {icon:'üéØ',cat:'activities',kw:'target direct hit dart'},
  {icon:'üéÆ',cat:'activities',kw:'game controller video gaming'},
  {icon:'üïπÔ∏è',cat:'activities',kw:'joystick gaming arcade'},
  {icon:'üé≤',cat:'activities',kw:'dice game random gambling'},
  {icon:'üé∞',cat:'activities',kw:'slot machine gambling casino'},
  {icon:'üé≥',cat:'activities',kw:'bowling ball pin sport'},
  {icon:'üé™',cat:'activities',kw:'circus tent carnival entertainment'},
  {icon:'üé≠',cat:'activities',kw:'performing arts theater masks'},
  {icon:'üé®',cat:'activities',kw:'artist palette paint art'},
  {icon:'üé¨',cat:'activities',kw:'clapper board movie film'},
  {icon:'üé§',cat:'activities',kw:'microphone sing karaoke'},
  {icon:'üéß',cat:'activities',kw:'headphone music audio'},
  {icon:'üéµ',cat:'activities',kw:'musical note music'},
  {icon:'üé∂',cat:'activities',kw:'musical notes music'},
  {icon:'üé∏',cat:'activities',kw:'guitar music instrument'},
  {icon:'üéπ',cat:'activities',kw:'piano keyboard music'},
  {icon:'üé∫',cat:'activities',kw:'trumpet music instrument'},
  
  // Objects
  {icon:'‚åö',cat:'objects',kw:'watch time clock wrist'},
  {icon:'‚è∞',cat:'objects',kw:'alarm clock time wake'},
  {icon:'‚è±Ô∏è',cat:'objects',kw:'stopwatch timer time'},
  {icon:'‚è≤Ô∏è',cat:'objects',kw:'timer clock countdown'},
  {icon:'üï∞Ô∏è',cat:'objects',kw:'mantelpiece clock time'},
  {icon:'‚åõ',cat:'objects',kw:'hourglass done time sand'},
  {icon:'‚è≥',cat:'objects',kw:'hourglass not done time sand'},
  {icon:'üîë',cat:'objects',kw:'key lock password security'},
  {icon:'üóùÔ∏è',cat:'objects',kw:'old key antique lock'},
  {icon:'üîì',cat:'objects',kw:'unlocked open lock'},
  {icon:'üîí',cat:'objects',kw:'locked closed lock security'},
  {icon:'üîê',cat:'objects',kw:'locked with key security'},
  {icon:'üîè',cat:'objects',kw:'locked with pen security'},
  {icon:'üéÅ',cat:'objects',kw:'gift present wrapped box'},
  {icon:'üéÄ',cat:'objects',kw:'ribbon bow decoration'},
  {icon:'üéà',cat:'objects',kw:'balloon party celebration'},
  {icon:'üéè',cat:'objects',kw:'carp streamer japanese flag'},
  {icon:'üéê',cat:'objects',kw:'wind chime japanese bell'},
  {icon:'üßß',cat:'objects',kw:'red envelope money gift'},
  {icon:'‚úâÔ∏è',cat:'objects',kw:'envelope mail letter'},
  {icon:'üì¶',cat:'objects',kw:'package box parcel delivery'},
  {icon:'üì´',cat:'objects',kw:'closed mailbox flag up'},
  {icon:'üó≥Ô∏è',cat:'objects',kw:'ballot box voting election'},
  {icon:'‚úèÔ∏è',cat:'objects',kw:'pencil write draw'},
  {icon:'‚úíÔ∏è',cat:'objects',kw:'pen black nib write'},
  {icon:'üñäÔ∏è',cat:'objects',kw:'pen write'},
  {icon:'üñãÔ∏è',cat:'objects',kw:'fountain pen write'},
  {icon:'üñçÔ∏è',cat:'objects',kw:'crayon draw color'},
  {icon:'üìù',cat:'objects',kw:'memo note write'},
  {icon:'üîç',cat:'objects',kw:'magnifying glass search zoom'},
];

// Font Awesome icon library
// Comprehensive Font Awesome icon library (1000+ icons)
const faIconLibrary = [
  // Communication (50+ icons)
  {icon:'fa-solid fa-phone', cat:'communication', kw:'phone call contact telephone'},
  {icon:'fa-solid fa-phone-flip', cat:'communication', kw:'phone call flip'},
  {icon:'fa-solid fa-phone-volume', cat:'communication', kw:'phone volume sound'},
  {icon:'fa-solid fa-phone-slash', cat:'communication', kw:'phone mute silent'},
  {icon:'fa-solid fa-mobile', cat:'communication', kw:'mobile phone smartphone'},
  {icon:'fa-solid fa-mobile-screen', cat:'communication', kw:'mobile screen phone'},
  {icon:'fa-solid fa-envelope', cat:'communication', kw:'email message mail letter'},
  {icon:'fa-solid fa-envelope-open', cat:'communication', kw:'email open mail'},
  {icon:'fa-solid fa-envelope-circle-check', cat:'communication', kw:'email verified confirmed'},
  {icon:'fa-solid fa-comment', cat:'communication', kw:'comment chat message bubble'},
  {icon:'fa-solid fa-comment-dots', cat:'communication', kw:'comment typing chat'},
  {icon:'fa-solid fa-comment-medical', cat:'communication', kw:'comment medical health'},
  {icon:'fa-solid fa-comment-slash', cat:'communication', kw:'comment mute silent'},
  {icon:'fa-solid fa-comments', cat:'communication', kw:'comments chat messages conversation'},
  {icon:'fa-solid fa-message', cat:'communication', kw:'message text sms'},
  {icon:'fa-solid fa-inbox', cat:'communication', kw:'inbox mail email messages'},
  {icon:'fa-solid fa-paper-plane', cat:'communication', kw:'send message email plane'},
  {icon:'fa-solid fa-bell', cat:'communication', kw:'notification alert bell alarm'},
  {icon:'fa-solid fa-bell-slash', cat:'communication', kw:'bell mute notification off'},
  {icon:'fa-solid fa-microphone', cat:'communication', kw:'microphone voice audio record'},
  {icon:'fa-solid fa-microphone-slash', cat:'communication', kw:'microphone mute off'},
  {icon:'fa-solid fa-microphone-lines', cat:'communication', kw:'microphone audio podcast'},
  {icon:'fa-solid fa-video', cat:'communication', kw:'video camera recording'},
  {icon:'fa-solid fa-video-slash', cat:'communication', kw:'video off camera mute'},
  {icon:'fa-solid fa-fax', cat:'communication', kw:'fax machine document'},
  {icon:'fa-solid fa-voicemail', cat:'communication', kw:'voicemail voice message'},
  {icon:'fa-solid fa-square-phone', cat:'communication', kw:'phone call square'},
  {icon:'fa-solid fa-square-phone-flip', cat:'communication', kw:'phone flip square'},
  {icon:'fa-solid fa-walkie-talkie', cat:'communication', kw:'walkie talkie radio communication'},
  {icon:'fa-solid fa-tower-broadcast', cat:'communication', kw:'broadcast tower signal'},
  {icon:'fa-solid fa-tower-cell', cat:'communication', kw:'cell tower mobile signal'},
  {icon:'fa-solid fa-satellite', cat:'communication', kw:'satellite space communication'},
  {icon:'fa-solid fa-satellite-dish', cat:'communication', kw:'satellite dish antenna'},
  {icon:'fa-solid fa-rss', cat:'communication', kw:'rss feed subscribe'},
  {icon:'fa-solid fa-podcast', cat:'communication', kw:'podcast audio broadcast'},
  {icon:'fa-solid fa-at', cat:'communication', kw:'at email address'},
  {icon:'fa-solid fa-hashtag', cat:'communication', kw:'hashtag tag social'},
  {icon:'fa-solid fa-circle-nodes', cat:'communication', kw:'network nodes connection'},
  {icon:'fa-solid fa-square-share-nodes', cat:'communication', kw:'share network nodes'},
  {icon:'fa-solid fa-bullhorn', cat:'communication', kw:'announcement megaphone broadcast'},
  {icon:'fa-solid fa-tower-observation', cat:'communication', kw:'observation tower lookout'},
  {icon:'fa-solid fa-headphones', cat:'communication', kw:'headphones audio music'},
  {icon:'fa-solid fa-headset', cat:'communication', kw:'headset support audio'},
  {icon:'fa-solid fa-volume-high', cat:'communication', kw:'volume sound audio loud'},
  {icon:'fa-solid fa-volume-low', cat:'communication', kw:'volume sound audio quiet'},
  {icon:'fa-solid fa-volume-off', cat:'communication', kw:'volume mute silent'},
  {icon:'fa-solid fa-volume-xmark', cat:'communication', kw:'volume mute off'},

  // Social Media & Brands (100+ icons)
  {icon:'fa-brands fa-facebook', cat:'social', kw:'facebook social media'},
  {icon:'fa-brands fa-facebook-f', cat:'social', kw:'facebook f social'},
  {icon:'fa-brands fa-facebook-messenger', cat:'social', kw:'facebook messenger chat'},
  {icon:'fa-brands fa-x-twitter', cat:'social', kw:'twitter x social media'},
  {icon:'fa-brands fa-instagram', cat:'social', kw:'instagram social media photo'},
  {icon:'fa-brands fa-linkedin', cat:'social', kw:'linkedin professional network'},
  {icon:'fa-brands fa-linkedin-in', cat:'social', kw:'linkedin in professional'},
  {icon:'fa-brands fa-youtube', cat:'social', kw:'youtube video social media'},
  {icon:'fa-brands fa-whatsapp', cat:'social', kw:'whatsapp chat messaging'},
  {icon:'fa-brands fa-telegram', cat:'social', kw:'telegram messaging chat'},
  {icon:'fa-brands fa-tiktok', cat:'social', kw:'tiktok social media video'},
  {icon:'fa-brands fa-snapchat', cat:'social', kw:'snapchat social media'},
  {icon:'fa-brands fa-pinterest', cat:'social', kw:'pinterest social media images'},
  {icon:'fa-brands fa-pinterest-p', cat:'social', kw:'pinterest p social'},
  {icon:'fa-brands fa-reddit', cat:'social', kw:'reddit social media forum'},
  {icon:'fa-brands fa-reddit-alien', cat:'social', kw:'reddit alien mascot'},
  {icon:'fa-brands fa-discord', cat:'social', kw:'discord chat gaming'},
  {icon:'fa-brands fa-slack', cat:'social', kw:'slack chat work communication'},
  {icon:'fa-brands fa-skype', cat:'social', kw:'skype video call'},
  {icon:'fa-brands fa-viber', cat:'social', kw:'viber chat messaging'},
  {icon:'fa-brands fa-wechat', cat:'social', kw:'wechat chat messaging'},
  {icon:'fa-brands fa-weibo', cat:'social', kw:'weibo social media china'},
  {icon:'fa-brands fa-tumblr', cat:'social', kw:'tumblr blog social'},
  {icon:'fa-brands fa-flickr', cat:'social', kw:'flickr photos images'},
  {icon:'fa-brands fa-vimeo', cat:'social', kw:'vimeo video'},
  {icon:'fa-brands fa-vimeo-v', cat:'social', kw:'vimeo v video'},
  {icon:'fa-brands fa-twitch', cat:'social', kw:'twitch streaming gaming'},
  {icon:'fa-brands fa-steam', cat:'social', kw:'steam gaming platform'},
  {icon:'fa-brands fa-google', cat:'social', kw:'google search'},
  {icon:'fa-brands fa-google-plus', cat:'social', kw:'google plus social'},
  {icon:'fa-brands fa-apple', cat:'social', kw:'apple brand tech'},
  {icon:'fa-brands fa-microsoft', cat:'social', kw:'microsoft windows brand'},
  {icon:'fa-brands fa-android', cat:'social', kw:'android mobile os'},
  {icon:'fa-brands fa-github', cat:'social', kw:'github code development'},
  {icon:'fa-brands fa-github-alt', cat:'social', kw:'github alt code'},
  {icon:'fa-brands fa-gitlab', cat:'social', kw:'gitlab code repository'},
  {icon:'fa-brands fa-bitbucket', cat:'social', kw:'bitbucket code repository'},
  {icon:'fa-brands fa-stack-overflow', cat:'social', kw:'stackoverflow coding help'},
  {icon:'fa-brands fa-medium', cat:'social', kw:'medium blog writing'},
  {icon:'fa-brands fa-dev', cat:'social', kw:'dev community coding'},
  {icon:'fa-brands fa-codepen', cat:'social', kw:'codepen code playground'},
  {icon:'fa-brands fa-dribbble', cat:'social', kw:'dribbble design portfolio'},
  {icon:'fa-brands fa-behance', cat:'social', kw:'behance design portfolio'},
  {icon:'fa-brands fa-spotify', cat:'social', kw:'spotify music streaming'},
  {icon:'fa-brands fa-soundcloud', cat:'social', kw:'soundcloud music audio'},
  {icon:'fa-brands fa-amazon', cat:'social', kw:'amazon shopping ecommerce'},
  {icon:'fa-brands fa-paypal', cat:'social', kw:'paypal payment money'},
  {icon:'fa-brands fa-stripe', cat:'social', kw:'stripe payment'},
  {icon:'fa-brands fa-cc-visa', cat:'social', kw:'visa credit card'},
  {icon:'fa-brands fa-cc-mastercard', cat:'social', kw:'mastercard credit card'},
  {icon:'fa-brands fa-cc-amex', cat:'social', kw:'american express credit card'},
  {icon:'fa-brands fa-cc-paypal', cat:'social', kw:'paypal credit card'},
  {icon:'fa-solid fa-share-nodes', cat:'social', kw:'share network social'},
  {icon:'fa-solid fa-share', cat:'social', kw:'share forward send'},
  {icon:'fa-solid fa-share-from-square', cat:'social', kw:'share export external'},
  {icon:'fa-solid fa-heart', cat:'social', kw:'heart love like favorite'},
  {icon:'fa-solid fa-thumbs-up', cat:'social', kw:'like thumbs up approve'},
  {icon:'fa-solid fa-thumbs-down', cat:'social', kw:'dislike thumbs down disapprove'},
  {icon:'fa-solid fa-star', cat:'social', kw:'star favorite rating'},
  {icon:'fa-solid fa-star-half', cat:'social', kw:'star half rating'},
  {icon:'fa-solid fa-star-half-stroke', cat:'social', kw:'star half stroke rating'},
  {icon:'fa-solid fa-bookmark', cat:'social', kw:'bookmark save favorite'},
  {icon:'fa-solid fa-face-smile', cat:'social', kw:'smile happy emoji'},
  {icon:'fa-solid fa-face-laugh', cat:'social', kw:'laugh happy emoji'},
  {icon:'fa-solid fa-face-grin', cat:'social', kw:'grin happy emoji'},
  {icon:'fa-solid fa-face-meh', cat:'social', kw:'meh neutral emoji'},
  {icon:'fa-solid fa-face-frown', cat:'social', kw:'frown sad emoji'},
  {icon:'fa-solid fa-face-angry', cat:'social', kw:'angry mad emoji'},
  {icon:'fa-solid fa-face-surprise', cat:'social', kw:'surprise shocked emoji'},
  {icon:'fa-solid fa-users', cat:'social', kw:'users people group'},
  {icon:'fa-solid fa-user', cat:'social', kw:'user person profile'},
  {icon:'fa-solid fa-user-plus', cat:'social', kw:'add user person'},
  {icon:'fa-solid fa-user-minus', cat:'social', kw:'remove user person'},
  {icon:'fa-solid fa-user-group', cat:'social', kw:'group users team'},
  {icon:'fa-solid fa-people-group', cat:'social', kw:'people group community'},

  // Technology (150+ icons)
  {icon:'fa-solid fa-wifi', cat:'technology', kw:'wifi network signal internet'},
  {icon:'fa-solid fa-wifi-slash', cat:'technology', kw:'wifi off no network'},
  {icon:'fa-solid fa-signal', cat:'technology', kw:'signal strength network'},
  {icon:'fa-solid fa-laptop', cat:'technology', kw:'laptop computer notebook'},
  {icon:'fa-solid fa-laptop-code', cat:'technology', kw:'laptop code programming'},
  {icon:'fa-solid fa-laptop-file', cat:'technology', kw:'laptop file document'},
  {icon:'fa-solid fa-laptop-medical', cat:'technology', kw:'laptop medical health'},
  {icon:'fa-solid fa-mobile', cat:'technology', kw:'mobile phone smartphone'},
  {icon:'fa-solid fa-mobile-button', cat:'technology', kw:'mobile button phone'},
  {icon:'fa-solid fa-mobile-screen', cat:'technology', kw:'mobile screen phone'},
  {icon:'fa-solid fa-mobile-screen-button', cat:'technology', kw:'mobile screen button'},
  {icon:'fa-solid fa-tablet', cat:'technology', kw:'tablet ipad device'},
  {icon:'fa-solid fa-tablet-button', cat:'technology', kw:'tablet button ipad'},
  {icon:'fa-solid fa-tablet-screen-button', cat:'technology', kw:'tablet screen button'},
  {icon:'fa-solid fa-desktop', cat:'technology', kw:'desktop computer monitor'},
  {icon:'fa-solid fa-computer', cat:'technology', kw:'computer pc desktop'},
  {icon:'fa-solid fa-computer-mouse', cat:'technology', kw:'mouse computer peripheral'},
  {icon:'fa-solid fa-keyboard', cat:'technology', kw:'keyboard typing input'},
  {icon:'fa-solid fa-tv', cat:'technology', kw:'tv television screen'},
  {icon:'fa-solid fa-display', cat:'technology', kw:'display monitor screen'},
  {icon:'fa-solid fa-qrcode', cat:'technology', kw:'qr code scan barcode'},
  {icon:'fa-solid fa-barcode', cat:'technology', kw:'barcode scan code'},
  {icon:'fa-solid fa-link', cat:'technology', kw:'link url chain connection'},
  {icon:'fa-solid fa-link-slash', cat:'technology', kw:'unlink broken chain'},
  {icon:'fa-solid fa-cloud', cat:'technology', kw:'cloud storage online'},
  {icon:'fa-solid fa-cloud-arrow-up', cat:'technology', kw:'upload cloud data'},
  {icon:'fa-solid fa-cloud-arrow-down', cat:'technology', kw:'download cloud data'},
  {icon:'fa-solid fa-database', cat:'technology', kw:'database data storage'},
  {icon:'fa-solid fa-server', cat:'technology', kw:'server hosting network'},
  {icon:'fa-solid fa-hard-drive', cat:'technology', kw:'hard drive storage disk'},
  {icon:'fa-solid fa-floppy-disk', cat:'technology', kw:'save floppy disk'},
  {icon:'fa-solid fa-code', cat:'technology', kw:'code programming development'},
  {icon:'fa-solid fa-code-branch', cat:'technology', kw:'code branch git version'},
  {icon:'fa-solid fa-code-commit', cat:'technology', kw:'code commit git'},
  {icon:'fa-solid fa-code-merge', cat:'technology', kw:'code merge git'},
  {icon:'fa-solid fa-code-pull-request', cat:'technology', kw:'pull request git'},
  {icon:'fa-solid fa-code-compare', cat:'technology', kw:'code compare diff'},
  {icon:'fa-solid fa-file-code', cat:'technology', kw:'file code document'},
  {icon:'fa-solid fa-bug', cat:'technology', kw:'bug error debugging'},
  {icon:'fa-solid fa-bug-slash', cat:'technology', kw:'debug fixed'},
  {icon:'fa-solid fa-terminal', cat:'technology', kw:'terminal console command'},
  {icon:'fa-solid fa-window-maximize', cat:'technology', kw:'window maximize full'},
  {icon:'fa-solid fa-window-minimize', cat:'technology', kw:'window minimize small'},
  {icon:'fa-solid fa-window-restore', cat:'technology', kw:'window restore normal'},
  {icon:'fa-solid fa-gear', cat:'technology', kw:'settings gear configuration'},
  {icon:'fa-solid fa-gears', cat:'technology', kw:'settings gears configuration'},
  {icon:'fa-solid fa-sliders', cat:'technology', kw:'sliders settings adjust'},
  {icon:'fa-solid fa-wrench', cat:'technology', kw:'wrench tools fix'},
  {icon:'fa-solid fa-screwdriver', cat:'technology', kw:'screwdriver tool repair'},
  {icon:'fa-solid fa-screwdriver-wrench', cat:'technology', kw:'tools repair fix'},
  {icon:'fa-solid fa-hammer', cat:'technology', kw:'hammer tool build'},
  {icon:'fa-solid fa-globe', cat:'technology', kw:'globe world internet web'},
  {icon:'fa-solid fa-earth-americas', cat:'technology', kw:'earth globe world americas'},
  {icon:'fa-solid fa-earth-europe', cat:'technology', kw:'earth globe world europe'},
  {icon:'fa-solid fa-earth-asia', cat:'technology', kw:'earth globe world asia'},
  {icon:'fa-solid fa-browser', cat:'technology', kw:'browser web internet'},
  {icon:'fa-solid fa-window', cat:'technology', kw:'window application'},
  {icon:'fa-solid fa-ethernet', cat:'technology', kw:'ethernet cable network'},
  {icon:'fa-solid fa-router', cat:'technology', kw:'router network internet'},
  {icon:'fa-solid fa-network-wired', cat:'technology', kw:'network wired ethernet'},
  {icon:'fa-solid fa-bluetooth', cat:'technology', kw:'bluetooth wireless connection'},
  {icon:'fa-solid fa-bluetooth-b', cat:'technology', kw:'bluetooth b wireless'},
  {icon:'fa-solid fa-usb', cat:'technology', kw:'usb drive storage'},
  {icon:'fa-solid fa-sd-card', cat:'technology', kw:'sd card memory storage'},
  {icon:'fa-solid fa-sim-card', cat:'technology', kw:'sim card mobile phone'},
  {icon:'fa-solid fa-memory', cat:'technology', kw:'memory ram chip'},
  {icon:'fa-solid fa-microchip', cat:'technology', kw:'microchip processor cpu'},
  {icon:'fa-solid fa-battery-full', cat:'technology', kw:'battery power charge full'},
  {icon:'fa-solid fa-battery-three-quarters', cat:'technology', kw:'battery charge 75'},
  {icon:'fa-solid fa-battery-half', cat:'technology', kw:'battery charge 50'},
  {icon:'fa-solid fa-battery-quarter', cat:'technology', kw:'battery charge 25'},
  {icon:'fa-solid fa-battery-empty', cat:'technology', kw:'battery empty dead'},
  {icon:'fa-solid fa-plug', cat:'technology', kw:'plug power electric'},
  {icon:'fa-solid fa-power-off', cat:'technology', kw:'power off shutdown'},
  {icon:'fa-solid fa-fingerprint', cat:'technology', kw:'fingerprint biometric security'},
  {icon:'fa-solid fa-shield', cat:'technology', kw:'shield security protection'},
  {icon:'fa-solid fa-shield-halved', cat:'technology', kw:'shield half security'},
  {icon:'fa-solid fa-lock', cat:'technology', kw:'lock secure locked password'},
  {icon:'fa-solid fa-lock-open', cat:'technology', kw:'lock open unlocked'},
  {icon:'fa-solid fa-unlock', cat:'technology', kw:'unlock open unlocked'},
  {icon:'fa-solid fa-key', cat:'technology', kw:'key lock security access'},
  {icon:'fa-solid fa-unlock-keyhole', cat:'technology', kw:'unlock keyhole open'},
  {icon:'fa-solid fa-user-lock', cat:'technology', kw:'user lock secure'},
  {icon:'fa-solid fa-user-shield', cat:'technology', kw:'user shield protected'},
  {icon:'fa-solid fa-eye', cat:'technology', kw:'eye view visible show'},
  {icon:'fa-solid fa-eye-slash', cat:'technology', kw:'eye hide invisible hidden'},
  {icon:'fa-solid fa-circle-play', cat:'technology', kw:'play media video'},
  {icon:'fa-solid fa-circle-pause', cat:'technology', kw:'pause media stop'},
  {icon:'fa-solid fa-circle-stop', cat:'technology', kw:'stop media end'},
  {icon:'fa-solid fa-play', cat:'technology', kw:'play media start'},
  {icon:'fa-solid fa-pause', cat:'technology', kw:'pause media stop'},
  {icon:'fa-solid fa-stop', cat:'technology', kw:'stop media end'},
  {icon:'fa-solid fa-forward', cat:'technology', kw:'forward next skip'},
  {icon:'fa-solid fa-backward', cat:'technology', kw:'backward previous back'},
  {icon:'fa-solid fa-forward-fast', cat:'technology', kw:'fast forward skip'},
  {icon:'fa-solid fa-backward-fast', cat:'technology', kw:'fast backward rewind'},
  {icon:'fa-solid fa-rotate-right', cat:'technology', kw:'rotate refresh reload'},
  {icon:'fa-solid fa-rotate-left', cat:'technology', kw:'rotate undo back'},
  {icon:'fa-solid fa-arrows-rotate', cat:'technology', kw:'refresh reload sync'},
  {icon:'fa-solid fa-download', cat:'technology', kw:'download save arrow'},
  {icon:'fa-solid fa-upload', cat:'technology', kw:'upload save arrow'},
  {icon:'fa-solid fa-circle-up', cat:'technology', kw:'up arrow circle'},
  {icon:'fa-solid fa-circle-down', cat:'technology', kw:'down arrow circle'},
  {icon:'fa-solid fa-arrow-up-from-bracket', cat:'technology', kw:'upload share export'},
  {icon:'fa-solid fa-arrow-down-to-bracket', cat:'technology', kw:'download save import'},

  // Business & Finance (100+ icons)
  {icon:'fa-solid fa-briefcase', cat:'business', kw:'briefcase work business job'},
  {icon:'fa-solid fa-building', cat:'business', kw:'building office business work'},
  {icon:'fa-solid fa-city', cat:'business', kw:'city buildings urban'},
  {icon:'fa-solid fa-landmark', cat:'business', kw:'landmark bank government'},
  {icon:'fa-solid fa-industry', cat:'business', kw:'industry factory manufacturing'},
  {icon:'fa-solid fa-warehouse', cat:'business', kw:'warehouse storage inventory'},
  {icon:'fa-solid fa-store', cat:'business', kw:'store shop retail'},
  {icon:'fa-solid fa-shop', cat:'business', kw:'shop store market'},
  {icon:'fa-solid fa-cart-shopping', cat:'business', kw:'shopping cart buy'},
  {icon:'fa-solid fa-basket-shopping', cat:'business', kw:'basket shopping groceries'},
  {icon:'fa-solid fa-bag-shopping', cat:'business', kw:'shopping bag retail'},
  {icon:'fa-solid fa-cash-register', cat:'business', kw:'cash register pos sale'},
  {icon:'fa-solid fa-chart-line', cat:'business', kw:'chart graph analytics stats'},
  {icon:'fa-solid fa-chart-area', cat:'business', kw:'chart area graph'},
  {icon:'fa-solid fa-chart-bar', cat:'business', kw:'chart bar graph'},
  {icon:'fa-solid fa-chart-column', cat:'business', kw:'chart column graph'},
  {icon:'fa-solid fa-chart-pie', cat:'business', kw:'pie chart analytics data'},
  {icon:'fa-solid fa-chart-simple', cat:'business', kw:'chart simple graph'},
  {icon:'fa-solid fa-diagram-project', cat:'business', kw:'project diagram flow'},
  {icon:'fa-solid fa-clipboard', cat:'business', kw:'clipboard notes list'},
  {icon:'fa-solid fa-clipboard-list', cat:'business', kw:'clipboard list tasks'},
  {icon:'fa-solid fa-clipboard-check', cat:'business', kw:'clipboard check done'},
  {icon:'fa-solid fa-list-check', cat:'business', kw:'list check tasks done'},
  {icon:'fa-solid fa-square-check', cat:'business', kw:'check done complete'},
  {icon:'fa-solid fa-circle-check', cat:'business', kw:'check done complete'},
  {icon:'fa-solid fa-dollar-sign', cat:'business', kw:'money dollar cash currency'},
  {icon:'fa-solid fa-euro-sign', cat:'business', kw:'money euro currency'},
  {icon:'fa-solid fa-pound-sign', cat:'business', kw:'money pound sterling currency'},
  {icon:'fa-solid fa-rupee-sign', cat:'business', kw:'money rupee currency india'},
  {icon:'fa-solid fa-yen-sign', cat:'business', kw:'money yen currency japan'},
  {icon:'fa-solid fa-won-sign', cat:'business', kw:'money won currency korea'},
  {icon:'fa-solid fa-indian-rupee-sign', cat:'business', kw:'rupee currency india'},
  {icon:'fa-solid fa-bitcoin-sign', cat:'business', kw:'bitcoin crypto currency'},
  {icon:'fa-solid fa-money-bill', cat:'business', kw:'money cash bill'},
  {icon:'fa-solid fa-money-bill-wave', cat:'business', kw:'money cash bill wave'},
  {icon:'fa-solid fa-money-bills', cat:'business', kw:'money cash bills'},
  {icon:'fa-solid fa-money-check', cat:'business', kw:'check money payment'},
  {icon:'fa-solid fa-money-check-dollar', cat:'business', kw:'check money dollar'},
  {icon:'fa-solid fa-coins', cat:'business', kw:'coins money cash'},
  {icon:'fa-solid fa-piggy-bank', cat:'business', kw:'piggy bank savings money'},
  {icon:'fa-solid fa-credit-card', cat:'business', kw:'credit card payment money'},
  {icon:'fa-solid fa-wallet', cat:'business', kw:'wallet money payment'},
  {icon:'fa-solid fa-sack-dollar', cat:'business', kw:'money sack dollar cash'},
  {icon:'fa-solid fa-hand-holding-dollar', cat:'business', kw:'donate money give'},
  {icon:'fa-solid fa-handshake', cat:'business', kw:'handshake deal agreement partnership'},
  {icon:'fa-solid fa-handshake-simple', cat:'business', kw:'handshake simple deal'},
  {icon:'fa-solid fa-handshake-angle', cat:'business', kw:'handshake angle agreement'},
  {icon:'fa-solid fa-scale-balanced', cat:'business', kw:'law legal justice balance'},
  {icon:'fa-solid fa-scale-unbalanced', cat:'business', kw:'law imbalance unfair'},
  {icon:'fa-solid fa-gavel', cat:'business', kw:'gavel judge law court'},
  {icon:'fa-solid fa-stamp', cat:'business', kw:'stamp approval official'},
  {icon:'fa-solid fa-signature', cat:'business', kw:'signature sign document'},
  {icon:'fa-solid fa-file-signature', cat:'business', kw:'file signature contract'},
  {icon:'fa-solid fa-file-contract', cat:'business', kw:'contract document legal'},
  {icon:'fa-solid fa-calculator', cat:'business', kw:'calculator math finance'},
  {icon:'fa-solid fa-file-invoice', cat:'business', kw:'invoice bill document payment'},
  {icon:'fa-solid fa-file-invoice-dollar', cat:'business', kw:'invoice dollar bill'},
  {icon:'fa-solid fa-receipt', cat:'business', kw:'receipt bill payment'},
  {icon:'fa-solid fa-percent', cat:'business', kw:'percent discount sale'},
  {icon:'fa-solid fa-tag', cat:'business', kw:'tag label price'},
  {icon:'fa-solid fa-tags', cat:'business', kw:'tags labels prices'},
  {icon:'fa-solid fa-barcode', cat:'business', kw:'barcode scan product'},
  {icon:'fa-solid fa-magnifying-glass-dollar', cat:'business', kw:'search money audit'},
  {icon:'fa-solid fa-magnifying-glass-chart', cat:'business', kw:'search analytics research'},
  {icon:'fa-solid fa-trophy', cat:'business', kw:'trophy award winner'},
  {icon:'fa-solid fa-medal', cat:'business', kw:'medal award achievement'},
  {icon:'fa-solid fa-award', cat:'business', kw:'award prize achievement'},
  {icon:'fa-solid fa-certificate', cat:'business', kw:'certificate diploma award'},
  {icon:'fa-solid fa-ranking-star', cat:'business', kw:'ranking star rating'},
  {icon:'fa-solid fa-bullseye', cat:'business', kw:'target goal bullseye'},
  {icon:'fa-solid fa-arrow-trend-up', cat:'business', kw:'trend up growth increase'},
  {icon:'fa-solid fa-arrow-trend-down', cat:'business', kw:'trend down decline decrease'},

  // Transport & Travel (80+ icons)
  {icon:'fa-solid fa-car', cat:'transport', kw:'car vehicle automobile'},
  {icon:'fa-solid fa-car-side', cat:'transport', kw:'car side vehicle'},
  {icon:'fa-solid fa-car-rear', cat:'transport', kw:'car rear vehicle'},
  {icon:'fa-solid fa-taxi', cat:'transport', kw:'taxi cab transport'},
  {icon:'fa-solid fa-van-shuttle', cat:'transport', kw:'van shuttle transport'},
  {icon:'fa-solid fa-truck', cat:'transport', kw:'truck vehicle delivery'},
  {icon:'fa-solid fa-truck-fast', cat:'transport', kw:'truck fast delivery'},
  {icon:'fa-solid fa-truck-pickup', cat:'transport', kw:'pickup truck vehicle'},
  {icon:'fa-solid fa-truck-monster', cat:'transport', kw:'monster truck big'},
  {icon:'fa-solid fa-truck-moving', cat:'transport', kw:'moving truck relocation'},
  {icon:'fa-solid fa-bus', cat:'transport', kw:'bus transport public'},
  {icon:'fa-solid fa-bus-simple', cat:'transport', kw:'bus simple transport'},
  {icon:'fa-solid fa-train', cat:'transport', kw:'train railway transportation'},
  {icon:'fa-solid fa-train-subway', cat:'transport', kw:'subway metro underground'},
  {icon:'fa-solid fa-train-tram', cat:'transport', kw:'tram train streetcar'},
  {icon:'fa-solid fa-motorcycle', cat:'transport', kw:'motorcycle bike motorbike'},
  {icon:'fa-solid fa-bicycle', cat:'transport', kw:'bicycle bike cycling'},
  {icon:'fa-solid fa-person-biking', cat:'transport', kw:'biking cycling person'},
  {icon:'fa-solid fa-plane', cat:'transport', kw:'plane airplane flight travel'},
  {icon:'fa-solid fa-plane-departure', cat:'transport', kw:'plane departure takeoff'},
  {icon:'fa-solid fa-plane-arrival', cat:'transport', kw:'plane arrival landing'},
  {icon:'fa-solid fa-plane-up', cat:'transport', kw:'plane up ascending'},
  {icon:'fa-solid fa-jet-fighter', cat:'transport', kw:'jet fighter military plane'},
  {icon:'fa-solid fa-helicopter', cat:'transport', kw:'helicopter aircraft'},
  {icon:'fa-solid fa-ship', cat:'transport', kw:'ship boat sea vessel'},
  {icon:'fa-solid fa-ferry', cat:'transport', kw:'ferry boat water transport'},
  {icon:'fa-solid fa-sailboat', cat:'transport', kw:'sailboat boat sailing'},
  {icon:'fa-solid fa-anchor', cat:'transport', kw:'anchor ship boat sea'},
  {icon:'fa-solid fa-rocket', cat:'transport', kw:'rocket space launch'},
  {icon:'fa-solid fa-satellite', cat:'transport', kw:'satellite space orbit'},
  {icon:'fa-solid fa-shuttle-space', cat:'transport', kw:'space shuttle rocket'},
  {icon:'fa-solid fa-location-dot', cat:'transport', kw:'location map pin marker'},
  {icon:'fa-solid fa-location-pin', cat:'transport', kw:'pin location marker'},
  {icon:'fa-solid fa-location-crosshairs', cat:'transport', kw:'location gps crosshairs'},
  {icon:'fa-solid fa-map', cat:'transport', kw:'map location navigation'},
  {icon:'fa-solid fa-map-pin', cat:'transport', kw:'map pin location'},
  {icon:'fa-solid fa-map-location', cat:'transport', kw:'map location address'},
  {icon:'fa-solid fa-map-location-dot', cat:'transport', kw:'map location dot'},
  {icon:'fa-solid fa-compass', cat:'transport', kw:'compass direction navigation'},
  {icon:'fa-solid fa-road', cat:'transport', kw:'road street path highway'},
  {icon:'fa-solid fa-route', cat:'transport', kw:'route path directions'},
  {icon:'fa-solid fa-signs-post', cat:'transport', kw:'signs post direction'},
  {icon:'fa-solid fa-traffic-light', cat:'transport', kw:'traffic light signal'},
  {icon:'fa-solid fa-gas-pump', cat:'transport', kw:'gas pump fuel station'},
  {icon:'fa-solid fa-charging-station', cat:'transport', kw:'charging station electric car'},
  {icon:'fa-solid fa-person-walking', cat:'transport', kw:'walking person pedestrian'},
  {icon:'fa-solid fa-person-running', cat:'transport', kw:'running person jogging'},
  {icon:'fa-solid fa-wheelchair', cat:'transport', kw:'wheelchair accessible disability'},
  {icon:'fa-solid fa-globe', cat:'transport', kw:'globe world travel'},
  {icon:'fa-solid fa-earth-americas', cat:'transport', kw:'earth americas travel'},
  {icon:'fa-solid fa-earth-europe', cat:'transport', kw:'earth europe travel'},
  {icon:'fa-solid fa-earth-asia', cat:'transport', kw:'earth asia travel'},
  {icon:'fa-solid fa-hotel', cat:'transport', kw:'hotel accommodation lodging'},
  {icon:'fa-solid fa-bed', cat:'transport', kw:'bed sleep hotel'},
  {icon:'fa-solid fa-suitcase', cat:'transport', kw:'suitcase luggage travel'},
  {icon:'fa-solid fa-suitcase-rolling', cat:'transport', kw:'suitcase rolling luggage'},
  {icon:'fa-solid fa-briefcase', cat:'transport', kw:'briefcase business travel'},
  {icon:'fa-solid fa-passport', cat:'transport', kw:'passport travel document'},
  {icon:'fa-solid fa-ticket', cat:'transport', kw:'ticket event travel'},
  {icon:'fa-solid fa-ticket-simple', cat:'transport', kw:'ticket simple entry'},
  {icon:'fa-solid fa-umbrella-beach', cat:'transport', kw:'beach umbrella vacation'},
  {icon:'fa-solid fa-mountain-sun', cat:'transport', kw:'mountain sun travel hiking'},
  {icon:'fa-solid fa-person-hiking', cat:'transport', kw:'hiking person trekking'},

  // Food & Drink (60+ icons)
  {icon:'fa-solid fa-utensils', cat:'food', kw:'utensils fork knife restaurant'},
  {icon:'fa-solid fa-fork-knife', cat:'food', kw:'fork knife dining'},
  {icon:'fa-solid fa-spoon', cat:'food', kw:'spoon eating utensil'},
  {icon:'fa-solid fa-pizza-slice', cat:'food', kw:'pizza food slice'},
  {icon:'fa-solid fa-burger', cat:'food', kw:'burger hamburger food'},
  {icon:'fa-solid fa-hotdog', cat:'food', kw:'hotdog food fast'},
  {icon:'fa-solid fa-bacon', cat:'food', kw:'bacon food breakfast'},
  {icon:'fa-solid fa-drumstick-bite', cat:'food', kw:'chicken drumstick food'},
  {icon:'fa-solid fa-fish', cat:'food', kw:'fish seafood food'},
  {icon:'fa-solid fa-shrimp', cat:'food', kw:'shrimp seafood food'},
  {icon:'fa-solid fa-egg', cat:'food', kw:'egg food breakfast'},
  {icon:'fa-solid fa-bread-slice', cat:'food', kw:'bread food slice'},
  {icon:'fa-solid fa-cheese', cat:'food', kw:'cheese food dairy'},
  {icon:'fa-solid fa-bowl-rice', cat:'food', kw:'rice bowl food'},
  {icon:'fa-solid fa-bowl-food', cat:'food', kw:'bowl food dish'},
  {icon:'fa-solid fa-pepper-hot', cat:'food', kw:'pepper hot spicy'},
  {icon:'fa-solid fa-carrot', cat:'food', kw:'carrot vegetable healthy'},
  {icon:'fa-solid fa-apple-whole', cat:'food', kw:'apple fruit healthy'},
  {icon:'fa-solid fa-lemon', cat:'food', kw:'lemon fruit citrus'},
  {icon:'fa-solid fa-seedling', cat:'food', kw:'seedling plant grow'},
  {icon:'fa-solid fa-wheat-awn', cat:'food', kw:'wheat grain food'},
  {icon:'fa-solid fa-cookie', cat:'food', kw:'cookie snack sweet'},
  {icon:'fa-solid fa-cookie-bite', cat:'food', kw:'cookie bite snack'},
  {icon:'fa-solid fa-cake-candles', cat:'food', kw:'cake birthday celebration'},
  {icon:'fa-solid fa-birthday-cake', cat:'food', kw:'birthday cake celebration'},
  {icon:'fa-solid fa-ice-cream', cat:'food', kw:'ice cream dessert sweet'},
  {icon:'fa-solid fa-candy-cane', cat:'food', kw:'candy cane sweet christmas'},
  {icon:'fa-solid fa-mug-hot', cat:'food', kw:'mug hot drink coffee tea'},
  {icon:'fa-solid fa-mug-saucer', cat:'food', kw:'mug saucer coffee tea'},
  {icon:'fa-solid fa-coffee', cat:'food', kw:'coffee drink cafe'},
  {icon:'fa-solid fa-wine-glass', cat:'food', kw:'wine glass alcohol drink'},
  {icon:'fa-solid fa-wine-glass-empty', cat:'food', kw:'wine glass empty'},
  {icon:'fa-solid fa-wine-bottle', cat:'food', kw:'wine bottle alcohol'},
  {icon:'fa-solid fa-champagne-glasses', cat:'food', kw:'champagne toast celebration'},
  {icon:'fa-solid fa-martini-glass', cat:'food', kw:'martini cocktail drink'},
  {icon:'fa-solid fa-martini-glass-citrus', cat:'food', kw:'martini citrus cocktail'},
  {icon:'fa-solid fa-martini-glass-empty', cat:'food', kw:'martini empty glass'},
  {icon:'fa-solid fa-glass-water', cat:'food', kw:'water glass drink'},
  {icon:'fa-solid fa-glass-water-droplet', cat:'food', kw:'water droplet glass'},
  {icon:'fa-solid fa-beer', cat:'food', kw:'beer alcohol drink'},
  {icon:'fa-solid fa-beer-mug-empty', cat:'food', kw:'beer mug empty'},
  {icon:'fa-solid fa-bottle-water', cat:'food', kw:'water bottle drink'},
  {icon:'fa-solid fa-bottle-droplet', cat:'food', kw:'bottle droplet drink'},
  {icon:'fa-solid fa-blender', cat:'food', kw:'blender kitchen smoothie'},
  {icon:'fa-solid fa-jar', cat:'food', kw:'jar container food'},

  // Weather & Nature (50+ icons)
  {icon:'fa-solid fa-sun', cat:'weather', kw:'sun sunny day bright'},
  {icon:'fa-solid fa-moon', cat:'weather', kw:'moon night dark'},
  {icon:'fa-solid fa-cloud', cat:'weather', kw:'cloud cloudy weather'},
  {icon:'fa-solid fa-cloud-sun', cat:'weather', kw:'partly cloudy sun weather'},
  {icon:'fa-solid fa-cloud-moon', cat:'weather', kw:'partly cloudy moon night'},
  {icon:'fa-solid fa-cloud-rain', cat:'weather', kw:'rain rainy weather storm'},
  {icon:'fa-solid fa-cloud-showers-heavy', cat:'weather', kw:'heavy rain storm'},
  {icon:'fa-solid fa-cloud-sun-rain', cat:'weather', kw:'sun rain shower'},
  {icon:'fa-solid fa-cloud-bolt', cat:'weather', kw:'storm lightning thunder'},
  {icon:'fa-solid fa-bolt', cat:'weather', kw:'lightning thunder storm'},
  {icon:'fa-solid fa-bolt-lightning', cat:'weather', kw:'lightning bolt electric'},
  {icon:'fa-solid fa-poo-storm', cat:'weather', kw:'storm cloud poo'},
  {icon:'fa-solid fa-rainbow', cat:'weather', kw:'rainbow colors weather'},
  {icon:'fa-solid fa-snowflake', cat:'weather', kw:'snow winter cold ice'},
  {icon:'fa-solid fa-icicles', cat:'weather', kw:'icicles winter cold'},
  {icon:'fa-solid fa-wind', cat:'weather', kw:'wind breeze air'},
  {icon:'fa-solid fa-tornado', cat:'weather', kw:'tornado cyclone storm'},
  {icon:'fa-solid fa-hurricane', cat:'weather', kw:'hurricane storm tropical'},
  {icon:'fa-solid fa-smog', cat:'weather', kw:'smog pollution fog'},
  {icon:'fa-solid fa-water', cat:'weather', kw:'water wave ocean'},
  {icon:'fa-solid fa-droplet', cat:'weather', kw:'droplet water rain'},
  {icon:'fa-solid fa-droplet-slash', cat:'weather', kw:'no water dry'},
  {icon:'fa-solid fa-fire', cat:'weather', kw:'fire flame hot burn'},
  {icon:'fa-solid fa-fire-flame-curved', cat:'weather', kw:'fire flame curved'},
  {icon:'fa-solid fa-fire-flame-simple', cat:'weather', kw:'fire flame simple'},
  {icon:'fa-solid fa-temperature-high', cat:'weather', kw:'hot temperature heat'},
  {icon:'fa-solid fa-temperature-low', cat:'weather', kw:'cold temperature freeze'},
  {icon:'fa-solid fa-temperature-half', cat:'weather', kw:'temperature medium warm'},
  {icon:'fa-solid fa-temperature-full', cat:'weather', kw:'temperature full hot'},
  {icon:'fa-solid fa-temperature-empty', cat:'weather', kw:'temperature empty cold'},
  {icon:'fa-solid fa-tree', cat:'weather', kw:'tree nature plant'},
  {icon:'fa-solid fa-seedling', cat:'weather', kw:'seedling plant grow'},
  {icon:'fa-solid fa-leaf', cat:'weather', kw:'leaf nature plant'},
  {icon:'fa-solid fa-clover', cat:'weather', kw:'clover luck nature'},
  {icon:'fa-solid fa-mountain', cat:'weather', kw:'mountain peak nature'},
  {icon:'fa-solid fa-volcano', cat:'weather', kw:'volcano mountain lava'},
  {icon:'fa-solid fa-hill-rockslide', cat:'weather', kw:'rockslide mountain disaster'},
  {icon:'fa-solid fa-hill-avalanche', cat:'weather', kw:'avalanche snow mountain'},

  // Symbols & Shapes (100+ icons)
  {icon:'fa-solid fa-check', cat:'symbols', kw:'check tick correct yes'},
  {icon:'fa-solid fa-xmark', cat:'symbols', kw:'x cross close cancel no'},
  {icon:'fa-solid fa-circle-check', cat:'symbols', kw:'check circle correct approved'},
  {icon:'fa-solid fa-circle-xmark', cat:'symbols', kw:'x circle cancel rejected'},
  {icon:'fa-solid fa-square-check', cat:'symbols', kw:'check square correct'},
  {icon:'fa-solid fa-triangle-exclamation', cat:'symbols', kw:'warning alert caution'},
  {icon:'fa-solid fa-circle-exclamation', cat:'symbols', kw:'exclamation alert warning'},
  {icon:'fa-solid fa-circle-info', cat:'symbols', kw:'info information help'},
  {icon:'fa-solid fa-question', cat:'symbols', kw:'question help unknown'},
  {icon:'fa-solid fa-circle-question', cat:'symbols', kw:'question circle help'},
  {icon:'fa-solid fa-exclamation', cat:'symbols', kw:'exclamation alert important'},
  {icon:'fa-solid fa-ban', cat:'symbols', kw:'ban prohibit forbidden no'},
  {icon:'fa-solid fa-circle-radiation', cat:'symbols', kw:'radiation hazard danger'},
  {icon:'fa-solid fa-biohazard', cat:'symbols', kw:'biohazard danger hazard'},
  {icon:'fa-solid fa-skull', cat:'symbols', kw:'skull death danger'},
  {icon:'fa-solid fa-skull-crossbones', cat:'symbols', kw:'skull crossbones poison'},
  {icon:'fa-solid fa-plus', cat:'symbols', kw:'plus add new create'},
  {icon:'fa-solid fa-minus', cat:'symbols', kw:'minus subtract remove'},
  {icon:'fa-solid fa-xmark', cat:'symbols', kw:'x multiply close'},
  {icon:'fa-solid fa-equals', cat:'symbols', kw:'equals equal math'},
  {icon:'fa-solid fa-divide', cat:'symbols', kw:'divide division math'},
  {icon:'fa-solid fa-circle-plus', cat:'symbols', kw:'plus circle add'},
  {icon:'fa-solid fa-circle-minus', cat:'symbols', kw:'minus circle remove'},
  {icon:'fa-solid fa-square-plus', cat:'symbols', kw:'plus square add'},
  {icon:'fa-solid fa-square-minus', cat:'symbols', kw:'minus square remove'},
  {icon:'fa-solid fa-infinity', cat:'symbols', kw:'infinity unlimited endless'},
  {icon:'fa-solid fa-percent', cat:'symbols', kw:'percent percentage discount'},
  {icon:'fa-solid fa-crown', cat:'symbols', kw:'crown king queen royalty'},
  {icon:'fa-solid fa-award', cat:'symbols', kw:'award prize trophy medal'},
  {icon:'fa-solid fa-medal', cat:'symbols', kw:'medal award achievement'},
  {icon:'fa-solid fa-trophy', cat:'symbols', kw:'trophy winner award'},
  {icon:'fa-solid fa-ribbon', cat:'symbols', kw:'ribbon award badge'},
  {icon:'fa-solid fa-gift', cat:'symbols', kw:'gift present box'},
  {icon:'fa-solid fa-gem', cat:'symbols', kw:'gem diamond jewel precious'},
  {icon:'fa-solid fa-ring', cat:'symbols', kw:'ring jewelry diamond'},
  {icon:'fa-solid fa-heart', cat:'symbols', kw:'heart love like'},
  {icon:'fa-solid fa-heart-pulse', cat:'symbols', kw:'heart pulse health'},
  {icon:'fa-solid fa-heart-crack', cat:'symbols', kw:'heart broken sad'},
  {icon:'fa-solid fa-circle-heart', cat:'symbols', kw:'heart circle love'},
  {icon:'fa-solid fa-star', cat:'symbols', kw:'star favorite rating'},
  {icon:'fa-solid fa-star-half', cat:'symbols', kw:'star half rating'},
  {icon:'fa-solid fa-star-half-stroke', cat:'symbols', kw:'star half stroke'},
  {icon:'fa-solid fa-circle', cat:'symbols', kw:'circle round shape'},
  {icon:'fa-solid fa-circle-dot', cat:'symbols', kw:'circle dot point'},
  {icon:'fa-solid fa-square', cat:'symbols', kw:'square shape box'},
  {icon:'fa-solid fa-square-full', cat:'symbols', kw:'square full filled'},
  {icon:'fa-solid fa-shapes', cat:'symbols', kw:'shapes geometry forms'},
  {icon:'fa-solid fa-diamond', cat:'symbols', kw:'diamond shape gem'},
  {icon:'fa-solid fa-flag', cat:'symbols', kw:'flag banner marker'},
  {icon:'fa-solid fa-flag-checkered', cat:'symbols', kw:'flag checkered racing'},
  {icon:'fa-solid fa-hourglass', cat:'symbols', kw:'hourglass time wait'},
  {icon:'fa-solid fa-hourglass-half', cat:'symbols', kw:'hourglass half time'},
  {icon:'fa-solid fa-hourglass-end', cat:'symbols', kw:'hourglass end time'},
  {icon:'fa-solid fa-stopwatch', cat:'symbols', kw:'stopwatch timer clock'},
  {icon:'fa-solid fa-shield', cat:'symbols', kw:'shield protection security'},
  {icon:'fa-solid fa-shield-halved', cat:'symbols', kw:'shield half protection'},
  {icon:'fa-solid fa-lock', cat:'symbols', kw:'lock secure password'},
  {icon:'fa-solid fa-unlock', cat:'symbols', kw:'unlock open access'},
  {icon:'fa-solid fa-key', cat:'symbols', kw:'key access unlock'},
  {icon:'fa-solid fa-arrows-up-down', cat:'symbols', kw:'arrows up down vertical'},
  {icon:'fa-solid fa-arrows-left-right', cat:'symbols', kw:'arrows left right horizontal'},
  {icon:'fa-solid fa-maximize', cat:'symbols', kw:'maximize expand fullscreen'},
  {icon:'fa-solid fa-minimize', cat:'symbols', kw:'minimize shrink reduce'},
  {icon:'fa-solid fa-compress', cat:'symbols', kw:'compress smaller shrink'},
  {icon:'fa-solid fa-expand', cat:'symbols', kw:'expand enlarge bigger'},

  // Activities & Sports (80+ icons)
  {icon:'fa-solid fa-futbol', cat:'activities', kw:'soccer football ball sport'},
  {icon:'fa-solid fa-basketball', cat:'activities', kw:'basketball ball sport'},
  {icon:'fa-solid fa-baseball', cat:'activities', kw:'baseball ball sport'},
  {icon:'fa-solid fa-baseball-bat-ball', cat:'activities', kw:'baseball bat ball'},
  {icon:'fa-solid fa-football', cat:'activities', kw:'american football ball sport'},
  {icon:'fa-solid fa-volleyball', cat:'activities', kw:'volleyball ball sport'},
  {icon:'fa-solid fa-table-tennis-paddle-ball', cat:'activities', kw:'ping pong table tennis'},
  {icon:'fa-solid fa-bowling-ball', cat:'activities', kw:'bowling ball sport'},
  {icon:'fa-solid fa-golf-ball-tee', cat:'activities', kw:'golf ball tee sport'},
  {icon:'fa-solid fa-hockey-puck', cat:'activities', kw:'hockey puck sport'},
  {icon:'fa-solid fa-dumbbell', cat:'activities', kw:'dumbbell gym fitness workout'},
  {icon:'fa-solid fa-weight-hanging', cat:'activities', kw:'weight gym fitness'},
  {icon:'fa-solid fa-person-running', cat:'activities', kw:'running exercise fitness sport'},
  {icon:'fa-solid fa-person-walking', cat:'activities', kw:'walking exercise person'},
  {icon:'fa-solid fa-person-swimming', cat:'activities', kw:'swimming pool sport'},
  {icon:'fa-solid fa-person-biking', cat:'activities', kw:'biking cycling person'},
  {icon:'fa-solid fa-person-skiing', cat:'activities', kw:'skiing snow sport'},
  {icon:'fa-solid fa-person-snowboarding', cat:'activities', kw:'snowboarding snow sport'},
  {icon:'fa-solid fa-person-skating', cat:'activities', kw:'skating ice sport'},
  {icon:'fa-solid fa-heart-pulse', cat:'activities', kw:'heart pulse health fitness'},
  {icon:'fa-solid fa-music', cat:'activities', kw:'music note sound audio'},
  {icon:'fa-solid fa-music-note', cat:'activities', kw:'note music sound'},
  {icon:'fa-solid fa-guitar', cat:'activities', kw:'guitar music instrument'},
  {icon:'fa-solid fa-drum', cat:'activities', kw:'drum music instrument'},
  {icon:'fa-solid fa-microphone', cat:'activities', kw:'microphone audio singing'},
  {icon:'fa-solid fa-microphone-lines', cat:'activities', kw:'microphone audio podcast'},
  {icon:'fa-solid fa-headphones', cat:'activities', kw:'headphones audio music'},
  {icon:'fa-solid fa-gamepad', cat:'activities', kw:'game gaming controller play'},
  {icon:'fa-solid fa-chess', cat:'activities', kw:'chess game strategy board'},
  {icon:'fa-solid fa-chess-king', cat:'activities', kw:'chess king piece'},
  {icon:'fa-solid fa-chess-queen', cat:'activities', kw:'chess queen piece'},
  {icon:'fa-solid fa-chess-rook', cat:'activities', kw:'chess rook piece'},
  {icon:'fa-solid fa-chess-bishop', cat:'activities', kw:'chess bishop piece'},
  {icon:'fa-solid fa-chess-knight', cat:'activities', kw:'chess knight piece'},
  {icon:'fa-solid fa-chess-pawn', cat:'activities', kw:'chess pawn piece'},
  {icon:'fa-solid fa-chess-board', cat:'activities', kw:'chess board game'},
  {icon:'fa-solid fa-dice', cat:'activities', kw:'dice game random chance'},
  {icon:'fa-solid fa-dice-one', cat:'activities', kw:'dice one game'},
  {icon:'fa-solid fa-dice-two', cat:'activities', kw:'dice two game'},
  {icon:'fa-solid fa-dice-three', cat:'activities', kw:'dice three game'},
  {icon:'fa-solid fa-dice-four', cat:'activities', kw:'dice four game'},
  {icon:'fa-solid fa-dice-five', cat:'activities', kw:'dice five game'},
  {icon:'fa-solid fa-dice-six', cat:'activities', kw:'dice six game'},
  {icon:'fa-solid fa-puzzle-piece', cat:'activities', kw:'puzzle piece game'},
  {icon:'fa-solid fa-camera', cat:'activities', kw:'camera photo picture'},
  {icon:'fa-solid fa-camera-retro', cat:'activities', kw:'camera retro vintage'},
  {icon:'fa-solid fa-image', cat:'activities', kw:'image photo picture'},
  {icon:'fa-solid fa-images', cat:'activities', kw:'images photos gallery'},
  {icon:'fa-solid fa-film', cat:'activities', kw:'film movie video cinema'},
  {icon:'fa-solid fa-clapperboard', cat:'activities', kw:'clapperboard movie film'},
  {icon:'fa-solid fa-video', cat:'activities', kw:'video camera recording'},
  {icon:'fa-solid fa-masks-theater', cat:'activities', kw:'theater drama masks'},
  {icon:'fa-solid fa-ticket', cat:'activities', kw:'ticket event movie'},
  {icon:'fa-solid fa-book', cat:'activities', kw:'book read library learning'},
  {icon:'fa-solid fa-book-open', cat:'activities', kw:'book open reading'},
  {icon:'fa-solid fa-newspaper', cat:'activities', kw:'newspaper news reading'},
  {icon:'fa-solid fa-graduation-cap', cat:'activities', kw:'graduation education school university'},
  {icon:'fa-solid fa-school', cat:'activities', kw:'school education building'},
  {icon:'fa-solid fa-user-graduate', cat:'activities', kw:'student graduate education'},
  {icon:'fa-solid fa-chalkboard', cat:'activities', kw:'chalkboard teaching education'},
  {icon:'fa-solid fa-chalkboard-user', cat:'activities', kw:'teacher teaching education'},
  {icon:'fa-solid fa-palette', cat:'activities', kw:'palette art paint color'},
  {icon:'fa-solid fa-paintbrush', cat:'activities', kw:'paintbrush art painting'},
  {icon:'fa-solid fa-pen-nib', cat:'activities', kw:'pen writing calligraphy'},
  {icon:'fa-solid fa-pencil', cat:'activities', kw:'pencil draw write'},

  // Objects & Home (100+ icons)
  {icon:'fa-solid fa-house', cat:'objects', kw:'house home building'},
  {icon:'fa-solid fa-home', cat:'objects', kw:'home house building'},
  {icon:'fa-solid fa-door-open', cat:'objects', kw:'door open entry'},
  {icon:'fa-solid fa-door-closed', cat:'objects', kw:'door closed'},
  {icon:'fa-solid fa-key', cat:'objects', kw:'key lock security access'},
  {icon:'fa-solid fa-lock', cat:'objects', kw:'lock secure locked password'},
  {icon:'fa-solid fa-lock-open', cat:'objects', kw:'lock open unlocked'},
  {icon:'fa-solid fa-unlock', cat:'objects', kw:'unlock open unlocked'},
  {icon:'fa-solid fa-shield', cat:'objects', kw:'shield security protection'},
  {icon:'fa-solid fa-lightbulb', cat:'objects', kw:'lightbulb idea light bulb'},
  {icon:'fa-solid fa-lamp', cat:'objects', kw:'lamp light fixture'},
  {icon:'fa-solid fa-fan', cat:'objects', kw:'fan air cool'},
  {icon:'fa-solid fa-couch', cat:'objects', kw:'couch sofa furniture'},
  {icon:'fa-solid fa-bed', cat:'objects', kw:'bed sleep hotel'},
  {icon:'fa-solid fa-bath', cat:'objects', kw:'bath bathroom tub'},
  {icon:'fa-solid fa-shower', cat:'objects', kw:'shower bathroom water'},
  {icon:'fa-solid fa-toilet', cat:'objects', kw:'toilet bathroom restroom'},
  {icon:'fa-solid fa-sink', cat:'objects', kw:'sink bathroom kitchen'},
  {icon:'fa-solid fa-tv', cat:'objects', kw:'tv television screen'},
  {icon:'fa-solid fa-blender', cat:'objects', kw:'blender kitchen appliance'},
  {icon:'fa-solid fa-mug-saucer', cat:'objects', kw:'mug coffee tea'},
  {icon:'fa-solid fa-kitchen-set', cat:'objects', kw:'kitchen cooking'},
  {icon:'fa-solid fa-utensils', cat:'objects', kw:'utensils fork knife'},
  {icon:'fa-solid fa-wine-glass', cat:'objects', kw:'wine glass drink'},
  {icon:'fa-solid fa-fire', cat:'objects', kw:'fire flame heat'},
  {icon:'fa-solid fa-fire-burner', cat:'objects', kw:'fire burner stove'},
  {icon:'fa-solid fa-temperature-three-quarters', cat:'objects', kw:'temperature warm'},
  {icon:'fa-solid fa-snowflake', cat:'objects', kw:'snowflake cold winter'},
  {icon:'fa-solid fa-sun', cat:'objects', kw:'sun light day'},
  {icon:'fa-solid fa-moon', cat:'objects', kw:'moon night dark'},
  {icon:'fa-solid fa-clock', cat:'objects', kw:'clock time watch hour'},
  {icon:'fa-solid fa-alarm-clock', cat:'objects', kw:'alarm clock time'},
  {icon:'fa-solid fa-stopwatch', cat:'objects', kw:'stopwatch timer'},
  {icon:'fa-solid fa-hourglass', cat:'objects', kw:'hourglass time sand'},
  {icon:'fa-solid fa-calendar', cat:'objects', kw:'calendar date day schedule'},
  {icon:'fa-solid fa-calendar-days', cat:'objects', kw:'calendar days month'},
  {icon:'fa-solid fa-calendar-week', cat:'objects', kw:'calendar week schedule'},
  {icon:'fa-solid fa-calendar-check', cat:'objects', kw:'calendar check event'},
  {icon:'fa-solid fa-calendar-plus', cat:'objects', kw:'calendar add event'},
  {icon:'fa-solid fa-bell', cat:'objects', kw:'bell notification alarm'},
  {icon:'fa-solid fa-trash', cat:'objects', kw:'trash delete remove bin'},
  {icon:'fa-solid fa-trash-can', cat:'objects', kw:'trash can delete'},
  {icon:'fa-solid fa-trash-arrow-up', cat:'objects', kw:'trash restore recover'},
  {icon:'fa-solid fa-recycle', cat:'objects', kw:'recycle reuse environment'},
  {icon:'fa-solid fa-pen', cat:'objects', kw:'pen write edit'},
  {icon:'fa-solid fa-pencil', cat:'objects', kw:'pencil write edit draw'},
  {icon:'fa-solid fa-pen-to-square', cat:'objects', kw:'edit pen write'},
  {icon:'fa-solid fa-highlighter', cat:'objects', kw:'highlighter marker pen'},
  {icon:'fa-solid fa-marker', cat:'objects', kw:'marker pen highlight'},
  {icon:'fa-solid fa-eraser', cat:'objects', kw:'eraser delete remove'},
  {icon:'fa-solid fa-paperclip', cat:'objects', kw:'paperclip attach file'},
  {icon:'fa-solid fa-folder', cat:'objects', kw:'folder directory files'},
  {icon:'fa-solid fa-folder-open', cat:'objects', kw:'folder open directory'},
  {icon:'fa-solid fa-folder-closed', cat:'objects', kw:'folder closed directory'},
  {icon:'fa-solid fa-folder-plus', cat:'objects', kw:'folder add new'},
  {icon:'fa-solid fa-folder-minus', cat:'objects', kw:'folder remove delete'},
  {icon:'fa-solid fa-file', cat:'objects', kw:'file document paper'},
  {icon:'fa-solid fa-file-lines', cat:'objects', kw:'file text document'},
  {icon:'fa-solid fa-file-pdf', cat:'objects', kw:'pdf file document'},
  {icon:'fa-solid fa-file-word', cat:'objects', kw:'word document file'},
  {icon:'fa-solid fa-file-excel', cat:'objects', kw:'excel spreadsheet file'},
  {icon:'fa-solid fa-file-powerpoint', cat:'objects', kw:'powerpoint presentation file'},
  {icon:'fa-solid fa-file-image', cat:'objects', kw:'image file photo'},
  {icon:'fa-solid fa-file-video', cat:'objects', kw:'video file movie'},
  {icon:'fa-solid fa-file-audio', cat:'objects', kw:'audio file music'},
  {icon:'fa-solid fa-file-zipper', cat:'objects', kw:'zip archive file'},
  {icon:'fa-solid fa-file-code', cat:'objects', kw:'code file programming'},
  {icon:'fa-solid fa-copy', cat:'objects', kw:'copy duplicate files'},
  {icon:'fa-solid fa-clone', cat:'objects', kw:'clone duplicate copy'},
  {icon:'fa-solid fa-scissors', cat:'objects', kw:'scissors cut trim'},
  {icon:'fa-solid fa-paste', cat:'objects', kw:'paste clipboard'},
  {icon:'fa-solid fa-print', cat:'objects', kw:'print printer paper'},
  {icon:'fa-solid fa-bookmark', cat:'objects', kw:'bookmark save favorite'},
  {icon:'fa-solid fa-tag', cat:'objects', kw:'tag label price'},
  {icon:'fa-solid fa-tags', cat:'objects', kw:'tags labels prices'},
  {icon:'fa-solid fa-thumbtack', cat:'objects', kw:'thumbtack pin attach'},
  {icon:'fa-solid fa-magnifying-glass', cat:'objects', kw:'search magnifying glass find'},
  {icon:'fa-solid fa-magnifying-glass-plus', cat:'objects', kw:'zoom in magnify'},
  {icon:'fa-solid fa-magnifying-glass-minus', cat:'objects', kw:'zoom out reduce'},
  {icon:'fa-solid fa-box', cat:'objects', kw:'box package container'},
  {icon:'fa-solid fa-boxes-stacked', cat:'objects', kw:'boxes stacked storage'},
  {icon:'fa-solid fa-box-archive', cat:'objects', kw:'archive box storage'},
  {icon:'fa-solid fa-basket-shopping', cat:'objects', kw:'basket shopping groceries'},
  {icon:'fa-solid fa-gift', cat:'objects', kw:'gift present box'},
  {icon:'fa-solid fa-wrench', cat:'objects', kw:'wrench tool fix'},
  {icon:'fa-solid fa-screwdriver', cat:'objects', kw:'screwdriver tool repair'},
  {icon:'fa-solid fa-hammer', cat:'objects', kw:'hammer tool build'},
  {icon:'fa-solid fa-toolbox', cat:'objects', kw:'toolbox tools repair'},
  {icon:'fa-solid fa-wand-magic-sparkles', cat:'objects', kw:'magic wand sparkles'},
  {icon:'fa-solid fa-broom', cat:'objects', kw:'broom clean sweep'},
  {icon:'fa-solid fa-spray-can', cat:'objects', kw:'spray can paint'},
  {icon:'fa-solid fa-brush', cat:'objects', kw:'brush paint clean'},
];



let currentIconMode = 'emoji';
let faLoaded = false;
let selectedFaIcon = null;
let filteredIcons = [...iconLibrary];
let selectedIconElement = null;


function renderIcons(){
  const grid = $('iconGrid');
  grid.innerHTML = '';
  const isFaMode = (currentIconMode === 'fa');

  filteredIcons.forEach((item, idx) => {
    const div = document.createElement('div');
    div.className = 'icon-item';
    div.title = item.kw.split(' ').slice(0, 3).join(', ');

    if (isFaMode) {
      const i = document.createElement('i');
      i.className = item.icon;
      div.appendChild(i);
    } else {
      div.textContent = item.icon;
    }

    div.onclick = () => selectIcon(item.icon, div);
    grid.appendChild(div);
  });
  $('iconCount').textContent = `${filteredIcons.length} icons`;
}


function selectIcon(icon, element){
  if(selectedIconElement) selectedIconElement.classList.remove('selected');
  selectedIconElement = element;
  element.classList.add('selected');

  if (currentIconMode === 'fa') {
    selectedFaIcon = icon;
    logoDataUrl = null;
  } else {
    selectedFaIcon = null;
    const svg = `data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">${icon}</text></svg>`;
    logoDataUrl = svg;
  }
  
  generate();
}


function convertFaIconToDataUrl(faClass, callback) {
  // Determine color: use foreground if checkbox is ticked, otherwise use FA color picker
  const useFg = $('faUseFgColor') && $('faUseFgColor').checked;
  const color = useFg ? $('fgColor').value : ($('faIconColor') ? $('faIconColor').value : '#000000');

  // Create offscreen div with the icon
  const container = document.createElement('div');
  container.style.position = 'fixed';
  container.style.left = '-9999px';
  container.style.top = '0';
  container.style.width = '400px';
  container.style.height = '400px';
  container.style.display = 'flex';
  container.style.alignItems = 'center';
  container.style.justifyContent = 'center';
  container.style.backgroundColor = 'white';
  
  const icon = document.createElement('i');
  icon.className = faClass;
  icon.style.fontSize = '300px';
  icon.style.color = color;
  
  container.appendChild(icon);
  document.body.appendChild(container);

  // Give browser time to render the icon
  setTimeout(() => {
    const canvas = document.createElement('canvas');
    canvas.width = 400;
    canvas.height = 400;
    const ctx = canvas.getContext('2d');
    
    // Fill white background
    ctx.fillStyle = 'white';
    ctx.fillRect(0, 0, 400, 400);
    
    // Get the computed style to extract the actual icon character
    const beforeStyle = window.getComputedStyle(icon, '::before');
    const iconContent = beforeStyle.content;
    const iconChar = iconContent.replace(/['"]/g, '');
    const fontFamily = beforeStyle.fontFamily;
    const fontWeight = beforeStyle.fontWeight || '900';
    
    // Draw the icon character
    ctx.fillStyle = color;
    ctx.font = `${fontWeight} 300px ${fontFamily}`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(iconChar, 200, 200);
    
    // Convert to data URL
    logoDataUrl = canvas.toDataURL('image/png');
    
    // Cleanup
    document.body.removeChild(container);
    
    if (callback) callback();
  }, 300);
}


function filterIcons(){
  const search = $('iconSearch').value.toLowerCase().trim();
  const category = $('iconCategory').value;

  const source = (currentIconMode === 'fa') ? faIconLibrary : iconLibrary;
  
  filteredIcons = source.filter(item => {
    const matchCategory = category === 'all' || item.cat === category;
    const matchSearch = !search || item.kw.includes(search) || item.icon.includes(search);
    return matchCategory && matchSearch;
  });
  
  renderIcons();
}


function selectTemplate(t) {
currentTemplate=t;
document.querySelectorAll('.template-btn').forEach(b=>b.classList.remove('active'));
document.querySelectorAll('#watermarkTypeButtons .template-btn')
  .forEach(b => b.classList.remove('active'));
event.target.classList.add('active');


// Hide all template input sections
const urlEl=document.getElementById('urlInputs');
const wifiEl=document.getElementById('wifiInputs');
const vcardEl=document.getElementById('vcardInputs');
const emailEl=document.getElementById('emailInputs');
const smsEl=document.getElementById('smsInputs');
const phoneEl=document.getElementById('phoneInputs');
const locEl=document.getElementById('locationInputs');
const eventEl=document.getElementById('eventInputs');
const textEl=document.getElementById('textInputs');
const passwordEl=document.getElementById('passwordInputs');

if(urlEl)urlEl.style.display='none';
if(wifiEl)wifiEl.style.display='none';
if(vcardEl)vcardEl.style.display='none';
if(emailEl)emailEl.style.display='none';
if(smsEl)smsEl.style.display='none';
if(phoneEl)phoneEl.style.display='none';
if(locEl)locEl.style.display='none';
if(eventEl)eventEl.style.display='none';
if(textEl)textEl.style.display='none';
if(passwordEl)passwordEl.style.display='none';

// Show selected template inputs
if(t==='url'&&urlEl)urlEl.style.display='block';
if(t==='wifi'&&wifiEl)wifiEl.style.display='block';
if(t==='vcard'&&vcardEl)vcardEl.style.display='block';
if(t==='email'&&emailEl)emailEl.style.display='block';
if(t==='sms'&&smsEl)smsEl.style.display='block';
if(t==='phone'&&phoneEl)phoneEl.style.display='block';
if(t==='location'&&locEl)locEl.style.display='block';
if(t==='event'&&eventEl)eventEl.style.display='block';
if(t=='text')textEl.style.display='block';
if(t=='password')passwordEl.style.display='block';

// Initialize vCard if needed
if(t==='vcard'&&vcardPhoneCount===0){
addVcardPhone();
addVcardEmail();
}

// Generate initial QR for the template
if(t==='url'){
generateFromInput();
generate();
}
}

function generateFromInput(){
const val=$('urlInput').value.trim();
$('data').value=val||'https://example.com';
}

$('urlInput').addEventListener('input',()=>{generateFromInput();debGen();});
['wifiSSID','wifiPassword','wifiSecurity'].forEach(id=>$(id).addEventListener('input',()=>{generateWifi();debGen();}));
['emailTo','emailSubject','emailBody'].forEach(id=>$(id).addEventListener('input',()=>{generateEmail();debGen();}));
['smsNumbers','smsBody'].forEach(id=>$(id).addEventListener('input',()=>{generateSMS();debGen();}));
$('phoneNumber').addEventListener('input',()=>{generatePhone();debGen();});
['vcardFirstName','vcardMiddleName','vcardLastName','vcardCompany','vcardTitle','vcardWebsite','vcardAddress'].forEach(id=>$(id).addEventListener('input',()=>{generateVcard();debGen();}));
['locationLat','locationLng','locationAddress'].forEach(id=>$(id).addEventListener('input',()=>{generateLocation();debGen();}));
['eventTitle','eventLocation','eventStart','eventEnd','eventDescription'].forEach(id=>$(id).addEventListener('input',()=>{generateEvent();debGen();}));

function generateWifi(){
const ssid=$('wifiSSID').value.trim();
if(!ssid)return;
const pass=$('wifiPassword').value.trim();
const sec=$('wifiSecurity').value;
const wifi=`WIFI:T:${sec};S:${ssid};P:${pass};;`;
$('data').value=wifi;
}

function generateEmail(){
const to=$('emailTo').value.trim();
if(!to)return;
const subj=$('emailSubject').value.trim();
const body=$('emailBody').value.trim();
let email=`mailto:${to}`;
const params=[];
if(subj)params.push(`subject=${encodeURIComponent(subj)}`);
if(body)params.push(`body=${encodeURIComponent(body)}`);
if(params.length>0)email+='?'+params.join('&');
$('data').value=email;
}

function generateSMS(){
const nums=$('smsNumbers').value.trim();
if(!nums)return;
const body=$('smsBody').value.trim();
const sms=`sms:${nums}${body?'?body='+encodeURIComponent(body):''}`;
$('data').value=sms;
}

function generatePhone(){
const num=$('phoneNumber').value.trim();
if(!num)return;
$('data').value=`tel:${num}`;
}

function generateLocation(){
const lat=$('locationLat').value.trim();
const lng=$('locationLng').value.trim();
const addr=$('locationAddress').value.trim();
if(lat&&lng){
$('data').value=`geo:${lat},${lng}`;
}else if(addr){
$('data').value=`geo:0,0?q=${encodeURIComponent(addr)}`;
}
}

function generateEvent(){
const title=$('eventTitle').value.trim();
const start=$('eventStart').value;
const end=$('eventEnd').value;
if(!title||!start||!end)return;
const loc=$('eventLocation').value.trim();
const desc=$('eventDescription').value.trim();

const formatDate=(dt)=>{
const d=new Date(dt);
return d.toISOString().replace(/[-:]/g,'').split('.')[0]+'Z';
};

let ical='BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\n';
ical+=`SUMMARY:${title}\n`;
ical+=`DTSTART:${formatDate(start)}\n`;
ical+=`DTEND:${formatDate(end)}\n`;
if(loc)ical+=`LOCATION:${loc}\n`;
if(desc)ical+=`DESCRIPTION:${desc}\n`;
ical+='END:VEVENT\nEND:VCALENDAR';
$('data').value=ical;
}

function generateText() {
    const text=document.getElementById('textContent').value.trim();
    if(!text) return;
    data.value=text;
}

function generatePassword() {
    const pwd=document.getElementById('passwordField').value.trim();
    if(!pwd) return;
    data.value=pwd;
}

function updateTextCharCount() {
    const field = document.getElementById('textContent');
    const counter = document.getElementById('textCharCount');
    const count = field.value.length;
    counter.textContent = count + '/500';
    generateText();
    debGen();
}

function togglePasswordField() {
    const field = document.getElementById('passwordField');
    const icon = document.getElementById('passwordToggleIcon');
    if (field.type === 'password') {
        field.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        field.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
}

function removeLogo(){
logoDataUrl=null;
selectedFaIcon=null;
$('logo').value='';
if(selectedIconElement) selectedIconElement.classList.remove('selected');
selectedIconElement = null;
generate();
}

function addVcardPhone(){
const id=vcardPhoneCount++;
const div=document.createElement('div');
div.className='vcard-group';
div.id=`phoneGroup${id}`;
div.innerHTML=`
<button class="remove-btn" onclick="removeVcardField('phoneGroup${id}')">√ó</button>
<div class="inline-group">
<input type="tel" id="vcardPhone${id}" placeholder="+1234567890">
<select id="vcardPhoneType${id}" onchange="toggleCustomLabel('vcardPhoneType${id}','vcardPhoneCustom${id}')">
<option value="CELL">Mobile</option>
<option value="HOME">Home</option>
<option value="WORK">Work</option>
<option value="VOICE">Voice</option>
<option value="FAX">Fax</option>
<option value="CUSTOM">Custom</option>
</select>
</div>
<input type="text" id="vcardPhoneCustom${id}" class="custom-label" placeholder="Enter custom label" style="margin-top:8px;">
`;
$('vcardPhones').appendChild(div);
$(`vcardPhone${id}`).addEventListener('input',()=>{generateVcard();debGen();});
$(`vcardPhoneType${id}`).addEventListener('change',()=>{generateVcard();debGen();});
$(`vcardPhoneCustom${id}`).addEventListener('input',()=>{generateVcard();debGen();});
}


function addVcardEmail(){
const id=vcardEmailCount++;
const div=document.createElement('div');
div.className='vcard-group';
div.id=`emailGroup${id}`;
div.innerHTML=`
<button class="remove-btn" onclick="removeVcardField('emailGroup${id}')">√ó</button>
<div class="inline-group">
<input type="email" id="vcardEmail${id}" placeholder="email@example.com">
<select id="vcardEmailType${id}" onchange="toggleCustomLabel('vcardEmailType${id}','vcardEmailCustom${id}')">
<option value="WORK">Work</option>
<option value="HOME">Home</option>
<option value="INTERNET">Internet</option>
<option value="CUSTOM">Custom</option>
</select>
</div>
<input type="text" id="vcardEmailCustom${id}" class="custom-label" placeholder="Enter custom label" style="margin-top:8px;">
`;
$('vcardEmails').appendChild(div);
$(`vcardEmail${id}`).addEventListener('input',()=>{generateVcard();debGen();});
$(`vcardEmailType${id}`).addEventListener('change',()=>{generateVcard();debGen();});
$(`vcardEmailCustom${id}`).addEventListener('input',()=>{generateVcard();debGen();});
}


function toggleCustomLabel(selectId,inputId){
const sel=$(selectId);
const inp=$(inputId);
if(sel&&inp){
inp.style.display=sel.value==='CUSTOM'?'block':'none';
}
}

function removeVcardField(id){
const el=document.getElementById(id);
if(el)el.remove();
}

function generateVcard(){
const firstName=$('vcardFirstName').value.trim();
const middleName=$('vcardMiddleName').value.trim();
const lastName=$('vcardLastName').value.trim();

if(!firstName){alert('First Name is required');return;}

let vcard='BEGIN:VCARD\nVERSION:3.0\n';

const fullName=[firstName,middleName,lastName].filter(n=>n).join(' ');
vcard+=`FN:${fullName}\n`;
vcard+=`N:${lastName};${firstName};${middleName};;\n`;

const company=$('vcardCompany').value.trim();
if(company)vcard+=`ORG:${company}\n`;

const title=$('vcardTitle').value.trim();
if(title)vcard+=`TITLE:${title}\n`;

const address=$('vcardAddress').value.trim();
if(address)vcard+=`ADR:;;${address};;;;\\n`;

const website=$('vcardWebsite').value.trim();
if(website)vcard+=`URL:${website}\\n`;

for(let i=0;i<vcardPhoneCount;i++){
const phone=$(`vcardPhone${i}`);
const typeSel=$(`vcardPhoneType${i}`);
const customLabel=$(`vcardPhoneCustom${i}`);
if(phone&&phone.value.trim()){
let type=typeSel.value;
if(type==='CUSTOM'&&customLabel&&customLabel.value.trim()){
type=customLabel.value.trim().toUpperCase().replace(/\s+/g,'');
}
vcard+=`TEL;TYPE=${type}:${phone.value.trim()}\n`;
}
}

for(let i=0;i<vcardEmailCount;i++){
const email=$(`vcardEmail${i}`);
const typeSel=$(`vcardEmailType${i}`);
const customLabel=$(`vcardEmailCustom${i}`);
if(email&&email.value.trim()){
let type=typeSel.value;
if(type==='CUSTOM'&&customLabel&&customLabel.value.trim()){
type=customLabel.value.trim().toUpperCase().replace(/\s+/g,'');
}
vcard+=`EMAIL;TYPE=${type}:${email.value.trim()}\n`;
}
}

vcard+='END:VCARD';
$('data').value=vcard;
generate();
}

const presets={
corporate:{fg:'#003366',bg:'#ffffff',eo:'#003366',ei:'#003366'},
vibrant:{fg:'#ff006e',bg:'#ffbe0b',eo:'#8338ec',ei:'#3a86ff'},
pastel:{fg:'#ff99c8',bg:'#fcf6bd',eo:'#a9def9',ei:'#e4c1f9'},
mono:{fg:'#000000',bg:'#ffffff',eo:'#333',ei:'#666'}
};

function initTheme(){const t=localStorage.getItem('qrTheme')||'light';document.documentElement.setAttribute('data-theme',t);}
function toggleTheme(){const c=document.documentElement.getAttribute('data-theme');const n=c==='dark'?'light':'dark';document.documentElement.setAttribute('data-theme',n);localStorage.setItem('qrTheme',n);}
function toggleSection(e){e.classList.toggle('collapsed');e.nextElementSibling.classList.toggle('hidden');}

function applyPreset(n){const p=presets[n];$('fgColor').value=$('fgHex').value=p.fg;$('bgColor').value=$('bgHex').value=p.bg;$('eyeOuter').value=$('eyeOuterHex').value=p.eo;$('eyeInner').value=$('eyeInnerHex').value=p.ei;$('useFgForOuter').checked=$('useOuterForInner').checked=false;generate();}

function saveScheme(){const n=prompt('Name:');if(!n)return;const s={n,fg:$('fgColor').value,bg:$('bgColor').value,eo:$('eyeOuter').value,ei:$('eyeInner').value};const sv=JSON.parse(localStorage.getItem('qrSchemes')||'[]');sv.push(s);localStorage.setItem('qrSchemes',JSON.stringify(sv));loadSchemes();}

function loadSchemes(){const sv=JSON.parse(localStorage.getItem('qrSchemes')||'[]');const c=$('savedSchemes');c.innerHTML='';sv.forEach((s,i)=>{const ch=document.createElement('div');ch.className='scheme-chip';ch.innerHTML=`<span onclick="applyScheme(${i})">${s.n}</span><span class="delete" onclick="delScheme(${i})">√ó</span>`;c.appendChild(ch);});}

function applyScheme(i){const s=JSON.parse(localStorage.getItem('qrSchemes')||'[]')[i];$('fgColor').value=$('fgHex').value=s.fg;$('bgColor').value=$('bgHex').value=s.bg;$('eyeOuter').value=$('eyeOuterHex').value=s.eo;$('eyeInner').value=$('eyeInnerHex').value=s.ei;generate();}

function delScheme(i){const s=JSON.parse(localStorage.getItem('qrSchemes')||'[]');s.splice(i,1);localStorage.setItem('qrSchemes',JSON.stringify(s));loadSchemes();}

function $(id){return document.getElementById(id);}

function sync(c,h){$(c).addEventListener('input',()=>{$(h).value=$(c).value;updateEyes();generate();});$(h).addEventListener('input',()=>{if(/^#[0-9A-Fa-f]{6}$/.test($(h).value)){$(c).value=$(h).value;updateEyes();generate();}});}

sync('fgColor','fgHex');sync('bgColor','bgHex');sync('eyeOuter','eyeOuterHex');sync('eyeInner','eyeInnerHex');

function updateEyes(){if($('useFgForOuter').checked){const fg=$('fgColor').value;$('eyeOuter').value=$('eyeOuterHex').value=fg;}if($('useFgForInner').checked){const fg=$('fgColor').value;$('eyeInner').value=$('eyeInnerHex').value=fg;}else if($('useOuterForInner').checked){const o=$('eyeOuter').value;$('eyeInner').value=$('eyeInnerHex').value=o;}}

$('useFgForOuter').addEventListener('change',()=>{updateEyes();generate();});
$('useFgForInner').addEventListener('change',()=>{if($('useFgForInner').checked)$('useOuterForInner').checked=false;updateEyes();generate();});
$('useOuterForInner').addEventListener('change',()=>{if($('useOuterForInner').checked)$('useFgForInner').checked=false;updateEyes();generate();});

$('logo').addEventListener('change',e=>{const f=e.target.files[0];if(!f){logoDataUrl=null;generate();return;}const r=new FileReader();r.onload=ev=>{logoDataUrl=ev.target.result;if(selectedIconElement) selectedIconElement.classList.remove('selected');selectedIconElement = null;generate();};r.readAsDataURL(f);});

['bgOpacity','borderSize','logoSize','downloadSize'].forEach(id=>{$(id).addEventListener('input',function(){if(id==='bgOpacity')$('opacityValue').textContent=this.value+'%';if(id==='borderSize'){$('borderValue').textContent=this.value;generate();}if(id==='logoSize')$('logoValue').textContent=this.value+'%';if(id==='downloadSize')$('downloadValue').textContent=this.value;generate();});});


// Frame controls event listeners
$('enableFrame').addEventListener('change', function() {
  $('frameControls').style.display = this.checked ? 'block' : 'none';
  $('frameWarning').style.display = this.checked ? 'block' : 'none';
  generate();
});

$('frameThickness').addEventListener('input', function() {
  $('frameThicknessValue').textContent = this.value;
  if($('enableFrame').checked) generate();
});

$('frameColor').addEventListener('input', function() {
  $('frameColorHex').value = this.value;
  if($('enableFrame').checked) generate();
});

$('frameColorHex').addEventListener('input', function() {
  if(/^#[0-9A-F]{6}$/i.test(this.value)) {
    $('frameColor').value = this.value;
    if($('enableFrame').checked) generate();
  }
});

$('framePattern').addEventListener('change', function() {
  if($('enableFrame').checked) generate();
});

let genT;
function debGen(){clearTimeout(genT);genT=setTimeout(generate,300);}
['errorCorrection','dotsStyle'].forEach(id=>$(id).addEventListener('input',debGen));

function updateWarnings(){
  const fg=$('fgColor').value;
  const bg=$('bgColor').value;
  const eo=$('eyeOuter').value;
  const ei=$('eyeInner').value;
  const lbg = lum(bg);
  const lfg = lum(fg);
  const leo = lum(eo);
  const lei = lum(ei);
  const conFg = (Math.max(lfg, lbg) + 0.05) / (Math.min(lfg, lbg) + 0.05);
  const conEo = (Math.max(leo, lbg) + 0.05) / (Math.min(leo, lbg) + 0.05);
  const conEi = (Math.max(lei, lbg) + 0.05) / (Math.min(lei, lbg) + 0.05);
  const lowAreas = [];
  if (conFg < 4.0) lowAreas.push('pattern');
  if (conEo < 4.0) lowAreas.push('outer eye');
  if (conEi < 4.0) lowAreas.push('inner eye');
  if (lowAreas.length > 0) {
    let areasStr = lowAreas.join(', ').replace(/, ([^,]*)$/, ' and $1');
    $('contrastWarning').innerHTML = `Low contrast in ${areasStr}. QR may not scan well.`;
    $('contrastWarning').style.display = 'block';
  } else {
    $('contrastWarning').style.display = 'none';
  }
  $('logoWarning').style.display=logoDataUrl?'block':'none';
}

function generate(){
  updateEyes();
  const dv=$('data').value.trim();
  if(!dv){return;}

  // Handle Font Awesome icon conversion to data URL
  if(selectedFaIcon && currentIconMode === 'fa') {
    convertFaIconToDataUrl(selectedFaIcon, () => {
      generateQRCode();
    });
  } else {
    generateQRCode();
  }
}

function generateQRCode(){
  const dv=$('data').value.trim();
  if(!dv){return;}
  const st=$('dotsStyle').value;
  const ds=parseInt($('downloadSize').value)||400;
  const lp=parseInt($('logoSize').value);
  const el=$('errorCorrection').value;
  let lr=lp/100;
  if(logoDataUrl){const ec={L:1,M:0.95,Q:0.88,H:0.8};lr*=ec[el];}
  const opts={width:ds,height:ds,data:dv,image:logoDataUrl,
margin:parseInt($('borderSize').value),qrOptions:{errorCorrectionLevel:el},imageOptions:{hideBackgroundDots:true,imageSize:lr,margin:0,...(logoDataUrl&&logoDataUrl.startsWith('data:')?{}:{crossOrigin:"anonymous"})},dotsOptions:{type:st,color:$('fgColor').value},backgroundOptions:{color:(()=>{const h=$('bgColor').value;const o=parseInt($('bgOpacity').value);if(o<=0)return undefined;const a=Math.round((o/100)*255).toString(16).padStart(2,'0');return h+a;})()},cornersSquareOptions:{type:st==='dots'?'extra-rounded':st,color:$('eyeOuter').value},cornersDotOptions:{type:st,color:$('eyeInner').value}};try{if(qrCode)qrCode.update(opts);else{qrCode=new QRCodeStyling(opts);qrCode.append($('qr-output'));}}catch(e){console.error(e);alert('Failed to generate QR');return;}

// Apply watermarks after QR is rendered
setTimeout(() => {
  applyWatermarksToCanvas();
}, 300);
setTimeout(()=>{const cv=document.querySelector('#qr-output canvas');if(cv){cv.style.width=cv.style.height='320px';if($('enableFrame').checked){const framedCanvas=drawFrameOnCanvas(cv);$('qr-output').innerHTML='';$('qr-output').appendChild(framedCanvas);framedCanvas.style.width=framedCanvas.style.height='320px';}}updateWarnings();},100);}

function lum(h){const v=parseInt(h.slice(1),16);const r=(v>>16)&255,g=(v>>8)&255,b=v&255;const a=[r,g,b].map(v=>v/255<=0.03928?v/12.92:Math.pow((v/255+0.055)/1.055,2.4));return a[0]*0.2126+a[1]*0.7152+a[2]*0.0722;}

function drawFrameOnCanvas(canvas) {
  if (!$('enableFrame').checked) return canvas;
  
  const frameThickness = parseInt($('frameThickness').value);
  const frameColor = $('frameColor').value;
  const framePattern = $('framePattern').value;
  
  const newCanvas = document.createElement('canvas');
  newCanvas.width = canvas.width;
  newCanvas.height = canvas.height;
  const ctx = newCanvas.getContext('2d');
  
  // Draw original QR
  ctx.drawImage(canvas, 0, 0);
  
  // Draw frame
  ctx.strokeStyle = frameColor;
  ctx.lineWidth = frameThickness;
  
  switch(framePattern) {
    case 'dashed':
      ctx.setLineDash([15, 10]);
      break;
    case 'dotted':
      ctx.setLineDash([5, 5]);
      break;
    case 'double':
      ctx.setLineDash([]);
      ctx.strokeRect(frameThickness/2, frameThickness/2, canvas.width - frameThickness, canvas.height - frameThickness);
      ctx.strokeRect(frameThickness*1.5, frameThickness*1.5, canvas.width - frameThickness*3, canvas.height - frameThickness*3);
      return newCanvas;
    default:
      ctx.setLineDash([]);
  }
  
  ctx.strokeRect(frameThickness/2, frameThickness/2, canvas.width - frameThickness, canvas.height - frameThickness);
  ctx.setLineDash([]);
  
  return newCanvas;
}

function downloadPNG(){qrCode?.download({name:"qr-code",extension:"png"});}
function downloadSVG(){qrCode?.download({name:"qr-code",extension:"svg"});}

function downloadJPG(){
if(!qrCode){alert('Generate QR first');return;}
qrCode.getRawData('png').then(blob=>{
const img=new Image();
img.onload=()=>{
const canvas=document.createElement('canvas');
canvas.width=img.width;
canvas.height=img.height;
const ctx=canvas.getContext('2d');
ctx.fillStyle='white';
ctx.fillRect(0,0,canvas.width,canvas.height);
ctx.drawImage(img,0,0);
const framedCanvas = drawFrameOnCanvas(canvas);
framedCanvas.toBlob(b=>{
const url=URL.createObjectURL(b);
const a=document.createElement('a');
a.href=url;
a.download='qr-code.jpg';
a.click();
URL.revokeObjectURL(url);
},'image/jpeg',0.95);
};
img.src=URL.createObjectURL(blob);
}).catch(e=>{console.error(e);alert('JPG download failed');});
}

function downloadWEBP(){
if(!qrCode){alert('Generate QR first');return;}
qrCode.getRawData('png').then(blob=>{
const img=new Image();
img.onload=()=>{
const canvas=document.createElement('canvas');
canvas.width=img.width;
canvas.height=img.height;
const ctx=canvas.getContext('2d');
ctx.drawImage(img,0,0);
const framedCanvas=drawFrameOnCanvas(canvas);
framedCanvas.toBlob(b=>{
if(!b){alert('WebP not supported in this browser');return;}
const url=URL.createObjectURL(b);
const a=document.createElement('a');
a.href=url;
a.download='qr-code.webp';
a.click();
URL.revokeObjectURL(url);
},'image/webp',0.95);
};
img.src=URL.createObjectURL(blob);
}).catch(e=>{console.error(e);alert('WebP download failed');});
}

function downloadPDF() {
  if (!qrCode) {alert('Generate QR first'); return;}
  qrCode.getRawData('png').then(blob => {
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      const size = parseInt(downloadSize.value)||400;
      canvas.width = canvas.height = size;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = 'white';
      ctx.fillRect(0,0,size,size);
      ctx.drawImage(img,0,0,size,size);
      const framedCanvas = drawFrameOnCanvas(canvas);

      // Use jsPDF library
      const { jsPDF } = window.jspdf;
      const imgData = framedCanvas.toDataURL('image/png');
      const mmSize = size * 0.264583;
      const pdf = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: [mmSize + 20, mmSize + 20]
      });
      pdf.addImage(imgData, 'PNG', 10, 10, mmSize, mmSize);
      pdf.save('qr-code.pdf');
    };
    img.src = URL.createObjectURL(blob);
  }).catch(e => {console.error(e); alert('PDF download failed');});
}


function copyToClipboard(){if(!qrCode){alert('Generate QR first');return;}qrCode.getRawData('png').then(b=>{navigator.clipboard.write([new ClipboardItem({'image/png':b})]).then(()=>alert('Copied!')).catch(e=>{console.error(e);alert('Copy failed');});}).catch(e=>{console.error(e);alert('Failed');});}
// Text and Password event listeners
const textContent = document.getElementById('textContent');
const passwordField = document.getElementById('passwordField');
if(textContent) textContent.addEventListener('input', updateTextCharCount);
if(passwordField) passwordField.addEventListener('input', function() { generatePassword(); debGen(); });


initTheme();loadSchemes();renderIcons();
$('urlInput').value='https://example.com';
$('data').value='https://example.com';
generate();

// Keyboard shortcut for Generate QR Code (Ctrl+Enter or Cmd+Enter)
document.addEventListener('keydown', function(e) {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    e.preventDefault();
    generate();
  }
});

// Keyboard shortcuts for switching tabs (Alt+Letter)
document.addEventListener('keydown', function(e) {
  if (e.altKey && !e.ctrlKey && !e.metaKey) {
    let tabName = null;
    switch(e.key.toLowerCase()) {
      case 't': tabName = 'templates'; break;
      case 'f': tabName = 'foreground'; break;
      case 'b': tabName = 'background'; break;
      case 'r': tabName = 'frame'; break;
      case 'c': tabName = 'corners'; break;
      case 'i': tabName = 'image'; break;
      case 'w': tabName = 'watermark'; break;
    }
    if (tabName) {
      e.preventDefault();
      switchTab(tabName);
    }
  }
});

function switchTab(tabName) {
  // Remove active class from all buttons
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  
  // Add active class to clicked button
  const activeBtn = document.querySelector(`.tab-btn[onclick*="${tabName}"]`);
  if (activeBtn) activeBtn.classList.add('active');
  
  // Hide all tab contents
  document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
  
  // Show selected tab content
  const selectedTab = document.getElementById(`tab-${tabName}`);
  if (selectedTab) selectedTab.classList.add('active');
}


function toggleDownloadMenu() {
  const menu = document.getElementById('download-menu');
  const button = document.getElementById('download-btn');
  
  if (menu.style.display === 'none' || menu.style.display === '') {
    menu.style.display = 'block';
    
    // Check if dropdown goes off-screen
    const menuRect = menu.getBoundingClientRect();
    const viewportHeight = window.innerHeight;
    
    // If dropdown bottom is below viewport, open upward
    if (menuRect.bottom > viewportHeight) {
      menu.style.top = 'auto';
      menu.style.bottom = '100%';
    } else {
      menu.style.top = '100%';
      menu.style.bottom = 'auto';
    }
  } else {
    menu.style.display = 'none';
  }
}


// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
  const dropdown = document.querySelector('.download-dropdown');
  const menu = document.getElementById('download-menu');
  if (dropdown && !dropdown.contains(event.target)) {
    menu.style.display = 'none';
  }
});

async function shareQR() {
  if (!qrCode) {
    alert('Please generate a QR code first!');
    return;
  }
  
  try {
    const canvas = document.querySelector('#qr-output canvas');
    if (!canvas) {
      alert('QR code not found!');
      return;
    }
    
    canvas.toBlob(async (blob) => {
      const file = new File([blob], 'qr-code.png', { type: 'image/png' });
      
      if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
        try {
          await navigator.share({
            title: 'QR Code',
            text: 'Check out this QR code',
            files: [file]
          });
        } catch (err) {
          if (err.name !== 'AbortError') {
            console.error('Share failed:', err);
            fallbackShare(blob);
          }
        }
      } else {
        fallbackShare(blob);
      }
    });
  } catch (err) {
    console.error('Error sharing:', err);
    alert('Unable to share QR code');
  }
}

function fallbackShare(blob) {
  const url = URL.createObjectURL(blob);
  const modal = document.createElement('div');
  modal.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--bg-2); padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 2000; max-width: 400px;';
  modal.innerHTML = `
    <h3 style="margin-top: 0; color: var(--txt-1);">Share QR Code</h3>
    <div style="display: flex; flex-direction: column; gap: 10px;">
      <button onclick="copyToClipboard(); this.parentElement.parentElement.remove();" style="padding: 12px;">üìã Copy Image</button>
      <button onclick="window.open('mailto:?subject=QR Code&body=Please find the QR code attached'); this.parentElement.parentElement.remove();" style="padding: 12px;">üìß Email</button>
      <button onclick="window.print(); this.parentElement.parentElement.remove();" style="padding: 12px;">üñ®Ô∏è Print</button>
      <button onclick="this.parentElement.parentElement.remove();" style="padding: 12px; background: #666;">‚úñ Cancel</button>
    </div>
  `;
  
  const overlay = document.createElement('div');
  overlay.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1999;';
  overlay.onclick = () => { modal.remove(); overlay.remove(); };
  
  document.body.appendChild(overlay);
  document.body.appendChild(modal);
}

// Icon mode switching and Font Awesome lazy loading
function setIconMode(mode) {
  currentIconMode = mode;

  const emojiBtn = $('emojiModeBtn');
  const faBtn = $('faModeBtn');
  const faControls = $('faColorControls');

  if (mode === 'emoji') {
    emojiBtn.classList.add('active');
    faBtn.classList.remove('active');
    faControls.style.display = 'none';
  } else if (mode === 'fa') {
    faBtn.classList.add('active');
    emojiBtn.classList.remove('active');
    faControls.style.display = 'block';

    if (!faLoaded) {
      loadFontAwesomeCSS();
      faLoaded = true;
    }
  }

  filterIcons();
}

function loadFontAwesomeCSS() {
  const link = document.createElement('link');
  link.rel = 'stylesheet';
  link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css';
  link.crossOrigin = 'anonymous';
  document.head.appendChild(link);
}

// Color sync for FA
document.addEventListener('DOMContentLoaded', () => {
  setIconMode('emoji');

  const faColor = $('faIconColor');
  const faColorHex = $('faIconColorHex');

  if (faColor && faColorHex) {
    faColor.addEventListener('input', () => {
      faColorHex.value = faColor.value;
      // Regenerate icon if FA icon is selected
      if (selectedFaIcon && currentIconMode === 'fa') {
        convertFaIconToDataUrl(selectedFaIcon, () => {
          generate();
        });
      }
    });
    faColorHex.addEventListener('input', () => {
      const v = faColorHex.value.trim();
      if (v.startsWith('#') && (v.length === 4 || v.length === 7)) {
        faColor.value = v;
        // Regenerate icon if FA icon is selected
        if (selectedFaIcon && currentIconMode === 'fa') {
          convertFaIconToDataUrl(selectedFaIcon, () => {
            generate();
          });
        }
      }
    });
  }

  // Listen to "Use foreground colour" checkbox changes
  const faUseFg = $('faUseFgColor');
  if (faUseFg) {
    faUseFg.addEventListener('change', () => {
      // Regenerate icon if FA icon is selected
      if (selectedFaIcon && currentIconMode === 'fa') {
        convertFaIconToDataUrl(selectedFaIcon, () => {
          generate();
        });
      }
    });
  }
});


// ===== WATERMARK FUNCTIONS =====

// OLD initWatermarkControls removed - not needed with new box system
function syncColorInputs(colorId, hexId, callback) {
  const colorInput = $(colorId);
  const hexInput = $(hexId);
  
  colorInput.addEventListener('input', function() {
    hexInput.value = this.value;
    if (callback) callback();
  });
  
  hexInput.addEventListener('input', function() {
    const v = this.value.trim();
    if (v.startsWith('#') && (v.length === 4 || v.length === 7)) {
      colorInput.value = v;
      if (callback) callback();
    }
  });
}

// OLD initWatermarkDraggable removed
// OLD updateWatermarkPreview removed


// OLD emoji/FA rendering functions removed


function initWatermarkDraggable() {

// OLD watermark functions removed (addWatermark, discardWatermark, editWatermark, removeWatermark, renderWatermarkList)


function applyWatermarksToCanvas() {
    console.log('applyWatermarksToCanvas called');
    const canvas = document.querySelector('#qr-output canvas');
    console.log('Canvas found:', canvas);
    if (!canvas) {
        console.log('No canvas found!');
        return;
    }
    
    const ctx = canvas.getContext('2d');
    const w = canvas.width;
    const h = canvas.height;
    console.log('Canvas dimensions:', w, h);
    console.log('Watermarks array:', watermarks);
    
    // Draw all watermarks that are not hidden
    watermarks.forEach((wm, index) => {
        console.log(`Drawing watermark ${index}:`, wm);
        if (!wm.hidden) {
            drawWatermarkOnCanvas(ctx, wm, w, h);
        } else {
            console.log(`Watermark ${index} is hidden`);
        }
    });
    console.log('Finished drawing watermarks');
}


  // Draw live preview watermark (if editing or adding new)
  const liveWm = getCurrentWatermarkData();
  if (liveWm) {
    ctx.save();
    ctx.globalAlpha = liveWm.opacity / 100;
    
    const x = (liveWm.x / 100) * w;
    const y = (liveWm.y / 100) * h;
    const size = (liveWm.size / 100) * Math.min(w, h);
    
    if (liveWm.type === 'text') {
      const color = liveWm.autoColor ? getAutoWatermarkColor() : liveWm.color;
      const wmFont = liveWm.fontFamily || 'Arial';
      ctx.font = `${liveWm.fontSize * (size / 40)}px ${wmFont}`;
      ctx.fillStyle = color;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(liveWm.text, x, y);
    } else if (liveWm.type === 'emoji') {
      ctx.font = `${size}px Arial`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(liveWm.emoji, x, y);
    } else if (liveWm.type === 'image') {
      const img = new Image();
      img.onload = function() {
        ctx.drawImage(img, x - size/2, y - size/2, size, size);
      };
      img.src = liveWm.src;
    } else if (liveWm.type === 'fontawesome') {
      const color = liveWm.autoColor ? getAutoWatermarkColor() : liveWm.color;
      ctx.font = `900 ${size}px "Font Awesome 6 Free"`;
      ctx.fillStyle = color;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      
      // Get the FA icon's unicode character
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = `<i class="${liveWm.iconClass}"></i>`;
      tempDiv.style.position = 'absolute';
      tempDiv.style.left = '-9999px';
      document.body.appendChild(tempDiv);
      
      const iconElement = tempDiv.querySelector('i');
      const beforeStyle = window.getComputedStyle(iconElement, ':before');
      const iconContent = beforeStyle.content.replace(/['"]/g, '');
      
      ctx.fillText(iconContent, x, y);
      document.body.removeChild(tempDiv);
    }
    
    ctx.restore();
  }
}

function togglePasswordField() {
  const passwordInput = document.getElementById('passwordField');
  const toggleIcon = document.getElementById('passwordToggleIcon');
  
  if (passwordInput.type === 'password') {
    passwordInput.type = 'text';
    toggleIcon.className = 'fa-solid fa-eye-slash toggle-password';
  } else {
    passwordInput.type = 'password';
    toggleIcon.className = 'fa-solid fa-eye toggle-password';
  }
}

// Initialize watermark boxes on page load
if (watermarks.length === 0) {
    const defaultWm = {
        id: watermarkCounter++,
        type: 'text',
        text: '‡Æ§‡¥®‡¥ø‡∞∑‡±ç',
        fontSize: 30,
        fontFamily: 'Arial, sans-serif',
        color: '#D4AF37',
        autoColor: false,
        size: 30,
        opacity: 50,
        x: 50,
        y: 50,
        hidden: false,
        collapsed: false
    };
    watermarks.push(defaultWm);
}

// Render watermark boxes and generate initial QR
renderWatermarkBoxes();
setTimeout(() => {
  generate();
}, 500);

// Overlay Ad Logic
window.addEventListener('DOMContentLoaded', function() {
  const overlayAd = document.getElementById('overlayAd');
  const closeBtn = document.getElementById('overlayCloseBtn');
  const timerDiv = document.getElementById('overlayTimer');
  
  // Show overlay after 1 second
  setTimeout(() => {
    overlayAd.style.display = 'flex';
    
    let countdown = 5;
    timerDiv.textContent = `Please wait ${countdown} seconds...`;
    
    const timer = setInterval(() => {
      countdown--;
      if (countdown > 0) {
        timerDiv.textContent = `Please wait ${countdown} seconds...`;
      } else {
        timerDiv.textContent = 'You can close now';
        closeBtn.disabled = false;
        closeBtn.classList.add('enabled');
        clearInterval(timer);
      }
    }, 1000);
    
    // Initialize AdSense for overlay
    (adsbygoogle = window.adsbygoogle || []).push({});
  }, 1000);
  
  // Close button
  closeBtn.addEventListener('click', function() {
    if (!this.disabled) {
      overlayAd.style.display = 'none';
    }
  });
  
  // Initialize sidebar ads
  setTimeout(() => {
    (adsbygoogle = window.adsbygoogle || []).push({});
    (adsbygoogle = window.adsbygoogle || []).push({});
  }, 2000);
});


</script>
<!-- Left Sidebar Ad -->
<div class="ad-sidebar left" id="leftAd">
  <!-- Replace with your AdSense code -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-XXXXXXXXXX"
       data-ad-slot="YYYYYYYYYY"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
</div>

<!-- Right Sidebar Ad -->
<div class="ad-sidebar right" id="rightAd">
  <!-- Replace with your AdSense code -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-XXXXXXXXXX"
       data-ad-slot="ZZZZZZZZZZ"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
</div>

<!-- Page Overlay Ad (shows on load) -->
<div class="page-overlay-ad" id="overlayAd" style="display: none;">
  <div class="overlay-ad-content">
    <div class="overlay-timer" id="overlayTimer">Please wait 5 seconds...</div>
    <button class="overlay-close-btn" id="overlayCloseBtn" disabled>
      ‚úï
    </button>
    <!-- Replace with your AdSense code -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-XXXXXXXXXX"
         data-ad-slot="AAAAAAAAAA"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
  </div>
</div>

</body>

</body>
</html>
